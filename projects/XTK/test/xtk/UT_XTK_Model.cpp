/*
 * cl_XTK_Model.hpp
 *
 *  Created on: Jun 20, 2017
 *      Author: ktdoble
 */

#include "catch.hpp"

#include "paths.hpp"

#include "cl_XTK_Model.hpp"
#include "cl_XTK_Enums.hpp"
#include "cl_XTK_Cut_Mesh.hpp"
#include "cl_XTK_Cut_Integration_Mesh.hpp"
#include "cl_XTK_Enriched_Integration_Mesh.hpp"
#include "cl_XTK_Diagnostics.hpp"
#include "cl_MTK_Mesh_Checker.hpp"

#include "cl_GEN_Sphere.hpp"
#include "cl_GEN_Plane.hpp"
#include "fn_GEN_Triangle_Geometry.hpp"// For surface normals

// Linalg includes
#include "cl_Matrix.hpp"
#include "fn_all_true.hpp"
#include "op_equal_equal.hpp"
#include "fn_norm.hpp"
#include "op_minus.hpp"

#include "cl_Profiler.hpp"
#include "Child_Mesh_Verification_Utilities.hpp"


#include "fn_compute_interface_surface_area.hpp"

namespace xtk
{

TEST_CASE( "Regular Subdivision Method", "[XTK] [REGULAR_SUBDIVISION_MODEL]" )
{
    int tProcRank = 0;
    int tProcSize = 0;
    MPI_Comm_rank( MPI_COMM_WORLD, &tProcRank );
    MPI_Comm_size( MPI_COMM_WORLD, &tProcSize );

    if ( tProcSize == 1 )
    {
        // Geometry Engine Setup -----------------------
        // Using a Levelset Sphere as the Geometry

        real                                           tRadius  = 0.7;
        real                                           tXCenter = 1.0;
        real                                           tYCenter = 1.0;
        real                                           tZCenter = 0;
        Cell< std::shared_ptr< moris::ge::Geometry > > tGeometry( 1 );
        tGeometry( 0 ) = std::make_shared< moris::ge::Sphere >( tXCenter, tYCenter, tZCenter, tRadius );

        // Create Mesh ---------------------------------
        std::string                     tMeshFileName = "generated:1x1x1";
        moris::mtk::Interpolation_Mesh* tMeshData     = moris::mtk::create_interpolation_mesh( MeshType::STK, tMeshFileName, NULL );

        moris::ge::Geometry_Engine_Parameters tGeometryEngineParameters;
        tGeometryEngineParameters.mGeometries = tGeometry;
        moris::ge::Geometry_Engine tGeometryEngine( tMeshData, tGeometryEngineParameters );

        // Setup XTK Model -----------------------------
        size_t tModelDimension = 3;
        Model  tXTKModel( tModelDimension, tMeshData, &tGeometryEngine );

        //Specify your decomposition methods and start cutting
        Cell< enum Subdivision_Method > tDecompositionMethods = { Subdivision_Method::NC_REGULAR_SUBDIVISION_HEX8 };
        tXTKModel.decompose( tDecompositionMethods );

        Cut_Integration_Mesh* tCutMesh = tXTKModel.get_cut_integration_mesh();

        // Do some testing
        size_t tNumNodesAfterDecompositionXTK    = tCutMesh->get_num_entities( EntityRank::NODE, 0 );
        size_t tNumElementsAfterDecompositionXTK = tCutMesh->get_num_entities( EntityRank::ELEMENT, 0 );

        // 1 element was subdivided
        CHECK( tNumNodesAfterDecompositionXTK == 15 );
        CHECK( tNumElementsAfterDecompositionXTK == 25 );// 24 from template plus the original background cell

        moris::Cell< std::shared_ptr< Matrix< DDRMat > > >* tCoords = tCutMesh->get_all_vertex_coordinates_loc_inds();

        moris::Matrix< moris::DDRMat > tExpectedNodeCoordinates(
            { { 0, 0, 0 },
                { 1, 0, 0 },
                { 0, 1, 0 },
                { 1, 1, 0 },
                { 0, 0, 1 },
                { 1, 0, 1 },
                { 0, 1, 1 },
                { 1, 1, 1 },
                { 0.5, 0, 0.5 },
                { 1, 0.5, 0.5 },
                { 0.5, 1, 0.5 },
                { 0, 0.5, 0.5 },
                { 0.5, 0.5, 0 },
                { 0.5, 0.5, 1 },
                { 0.5, 0.5, 0.5 } } );

        CHECK( tCoords->size() == 15 );
        for ( moris::uint iNode = 0; iNode < tCoords->size(); iNode++ )
        {
            Matrix< DDRMat > tNodeCoords          = *( ( *tCoords )( iNode ) );
            Matrix< DDRMat > tGoldNodeCoordinates = tExpectedNodeCoordinates.get_row( iNode );
            CHECK( equal_to( tNodeCoords, tGoldNodeCoordinates ) );
        }

        CHECK( interpolated_coordinate_check( tCutMesh ) );
    }
}

TEST_CASE( "Regular Subdivision and Nodal Hierarchy Subdivision", "[XTK] [CONFORMAL_MODEL]" )
{
    int tProcSize = moris::par_size();

    if ( tProcSize <= 2 )
    {
        // Geometry Engine Setup ---------------------------------------------------------
        // Using a Levelset Sphere as the Geometry

        real tXCenter = 0.51;
        real tYCenter = 0.51;
        real tZCenter = 0.51;
        real tXNormal = 1.0;
        real tYNormal = 0.0;
        real tZNormal = 0.0;

        Cell< std::shared_ptr< moris::ge::Geometry > > tGeometry( 1 );
        tGeometry( 0 ) = std::make_shared< moris::ge::Plane >( tXCenter, tYCenter, tZCenter, tXNormal, tYNormal, tZNormal );

        // Create Mesh --------------------------------------------------------------------
        std::string                     tMeshFileName = "generated:1x1x4";
        moris::mtk::Interpolation_Mesh* tMeshData     = moris::mtk::create_interpolation_mesh( MeshType::STK, tMeshFileName, NULL );

        moris::ge::Geometry_Engine_Parameters tGeometryEngineParameters;
        tGeometryEngineParameters.mGeometries = tGeometry;
        moris::ge::Geometry_Engine tGeometryEngine( tMeshData, tGeometryEngineParameters );


        // Setup XTK Model ----------------------------------------------------------------
        size_t tModelDimension = 3;
        Model  tXTKModel( tModelDimension, tMeshData, &tGeometryEngine );
        tXTKModel.mVerbose = false;

        //Specify decomposition Method and Cut Mesh ---------------------------------------
        Cell< enum Subdivision_Method > tDecompositionMethods = { Subdivision_Method::NC_REGULAR_SUBDIVISION_HEX8, Subdivision_Method::C_HIERARCHY_TET4 };
        tXTKModel.decompose( tDecompositionMethods );

        // Access the Cut Mesh-------------------------------------------------------------
        Cut_Integration_Mesh* tCutMesh = tXTKModel.get_cut_integration_mesh();

        // Do some testing
        size_t tNumNodesAfterDecompositionXTK    = tCutMesh->get_num_entities( EntityRank::NODE, 0 );
        size_t tNumElementsAfterDecompositionXTK = tCutMesh->get_num_entities( EntityRank::ELEMENT, 0 );

        if ( par_size() == 1 )
        {
            CHECK( tNumNodesAfterDecompositionXTK == 34 );
            CHECK( tNumElementsAfterDecompositionXTK == 46 );
        }

        CHECK( interpolated_coordinate_check( tCutMesh ) );

        moris::Matrix< moris::DDRMat > tIsoContourThreshold = { { 0.0 } };
        moris::Matrix< moris::DDRMat > tIsoContourTolerance = { { 1e-12 } };
        CHECK( verify_interface_vertices( &tXTKModel, tIsoContourThreshold, tIsoContourTolerance ) );

        // perform enrichment
        tXTKModel.perform_basis_enrichment( EntityRank::NODE, 0 );
    }
}
TEST_CASE( "Geometry with a coincident bounrady to background cell", "[XTK_CONFORMAL_COIN]" )
{
    // Geometry Engine Setup ---------------------------------------------------------
    // Using a Levelset Sphere as the Geometry

    real tXCenter = 0.0;
    real tYCenter = 0.0;
    real tZCenter = 0.0;
    real tXNormal = 1.0;
    real tYNormal = 0.0;
    real tZNormal = 0.0;

    Cell< std::shared_ptr< moris::ge::Geometry > > tGeometry( 1 );
    tGeometry( 0 ) = std::make_shared< moris::ge::Plane >( tXCenter, tYCenter, tZCenter, tXNormal, tYNormal, tZNormal );

    // Create Mesh --------------------------------------------------------------------
    std::string                     tMeshFileName = "generated:1x1x4";
    moris::mtk::Interpolation_Mesh* tMeshData     = moris::mtk::create_interpolation_mesh( MeshType::STK, tMeshFileName, NULL );

    moris::ge::Geometry_Engine_Parameters tGeometryEngineParameters;
    tGeometryEngineParameters.mGeometries = tGeometry;
    moris::ge::Geometry_Engine tGeometryEngine( tMeshData, tGeometryEngineParameters );


    // Setup XTK Model ----------------------------------------------------------------
    size_t tModelDimension = 3;
    Model  tXTKModel( tModelDimension, tMeshData, &tGeometryEngine );
    // tXTKModel.setup_diagnostics( true, "./xtk_diag/", "nhcoin1" );

    //Specify decomposition Method and Cut Mesh ---------------------------------------
    Cell< enum Subdivision_Method >
        tDecompositionMethods = { Subdivision_Method::NC_REGULAR_SUBDIVISION_HEX8, Subdivision_Method::C_HIERARCHY_TET4 };
    tXTKModel.decompose( tDecompositionMethods );

    // Access the Cut Mesh-------------------------------------------------------------
    Cut_Integration_Mesh* tCutMesh = tXTKModel.get_cut_integration_mesh();

    // set gold values
    moris::Matrix< moris::DDRMat >                 tGoldCoords( 0, 0 );
    Cell< moris_index >                            tGoldNumVertex( 0 );
    std::unordered_map< moris_index, moris_index > tGoldVertexMap;
    moris::Matrix< moris::IndexMat >               tGoldCellConn( 0, 0 );
    Cell< moris_index >                            tGoldNumCells( 0 );
    std::unordered_map< moris_index, moris_index > tGoldCellMap;

    if ( par_size() == 1 )
    {
        tGoldNumVertex = { 45 };

        tGoldCoords = { { 0.000000000, 0.000000000, 0.000000000 },
            { 1.000000000, 0.000000000, 0.000000000 },
            { 0.000000000, 1.000000000, 0.000000000 },
            { 1.000000000, 1.000000000, 0.000000000 },
            { 0.000000000, 0.000000000, 1.000000000 },
            { 1.000000000, 0.000000000, 1.000000000 },
            { 0.000000000, 1.000000000, 1.000000000 },
            { 1.000000000, 1.000000000, 1.000000000 },
            { 0.000000000, 0.000000000, 2.000000000 },
            { 1.000000000, 0.000000000, 2.000000000 },
            { 0.000000000, 1.000000000, 2.000000000 },
            { 1.000000000, 1.000000000, 2.000000000 },
            { 0.000000000, 0.000000000, 3.000000000 },
            { 1.000000000, 0.000000000, 3.000000000 },
            { 0.000000000, 1.000000000, 3.000000000 },
            { 1.000000000, 1.000000000, 3.000000000 },
            { 0.000000000, 0.000000000, 4.000000000 },
            { 1.000000000, 0.000000000, 4.000000000 },
            { 0.000000000, 1.000000000, 4.000000000 },
            { 1.000000000, 1.000000000, 4.000000000 },
            { 0.500000000, 0.000000000, 3.500000000 },
            { 1.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 1.000000000, 3.500000000 },
            { 0.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.500000000, 3.000000000 },
            { 0.500000000, 0.500000000, 4.000000000 },
            { 0.500000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.000000000, 2.500000000 },
            { 1.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 1.000000000, 2.500000000 },
            { 0.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.500000000, 2.000000000 },
            { 0.500000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.000000000, 1.500000000 },
            { 1.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 1.000000000, 1.500000000 },
            { 0.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 1.000000000 },
            { 0.500000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.000000000, 0.500000000 },
            { 1.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 1.000000000, 0.500000000 },
            { 0.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 0.000000000 },
            { 0.500000000, 0.500000000, 0.500000000 } };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 29, 28 }, { 30, 29 }, { 31, 30 }, { 32, 31 }, { 33, 32 }, { 34, 33 }, { 35, 34 }, { 36, 35 }, { 37, 36 }, { 38, 37 }, { 39, 38 }, { 40, 39 }, { 41, 40 }, { 42, 41 }, { 43, 42 }, { 44, 43 }, { 45, 44 } };

        tGoldNumCells = { 100 };

        tGoldCellConn = { { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 1, 40, 2, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 40, 6, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 40, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 5, 40, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 41, 4, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 41, 8, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 41, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 6, 41, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 42, 3, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 8, 42, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 42, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 42, 7, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 3, 43, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 7, 43, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 43, 7, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 43, 5, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 2, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 4, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 3, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 44, 3, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 38, 6, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 38, 8, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 38, 7, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 38, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 34, 6, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 34, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 35, 8, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 35, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 10, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 36, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 12, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 36, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 37, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 37, 9, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 38, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 32, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 32, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 32, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 32, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 28, 10, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 28, 14, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 29, 12, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 29, 16, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 30, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 30, 15, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 31, 15, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 31, 13, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 32, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 25, 14, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 25, 16, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 25, 15, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 25, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 21, 14, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 21, 18, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 18, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 17, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 22, 16, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 22, 20, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 20, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 18, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 23, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 20, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 19, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 23, 19, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 19, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 24, 19, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 24, 17, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 25, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 26, 18, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 26, 20, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 26, 19, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 19, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 } };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 29, 28 }, { 30, 29 }, { 31, 30 }, { 32, 31 }, { 33, 32 }, { 34, 33 }, { 35, 34 }, { 36, 35 }, { 37, 36 }, { 38, 37 }, { 39, 38 }, { 40, 39 }, { 41, 40 }, { 42, 41 }, { 43, 42 }, { 44, 43 }, { 45, 44 }, { 46, 45 }, { 47, 46 }, { 48, 47 }, { 49, 48 }, { 50, 49 }, { 51, 50 }, { 52, 51 }, { 53, 52 }, { 54, 53 }, { 55, 54 }, { 56, 55 }, { 57, 56 }, { 58, 57 }, { 59, 58 }, { 60, 59 }, { 61, 60 }, { 62, 61 }, { 63, 62 }, { 64, 63 }, { 65, 64 }, { 66, 65 }, { 67, 66 }, { 68, 67 }, { 69, 68 }, { 70, 69 }, { 71, 70 }, { 72, 71 }, { 73, 72 }, { 74, 73 }, { 75, 74 }, { 76, 75 }, { 77, 76 }, { 78, 77 }, { 79, 78 }, { 80, 79 }, { 81, 80 }, { 82, 81 }, { 83, 82 }, { 84, 83 }, { 85, 84 }, { 86, 85 }, { 87, 86 }, { 88, 87 }, { 89, 88 }, { 90, 89 }, { 91, 90 }, { 92, 91 }, { 93, 92 }, { 94, 93 }, { 95, 94 }, { 96, 95 }, { 97, 96 }, { 98, 97 }, { 99, 98 }, { 100, 99 } };
    }
    if ( par_size() == 2 )
    {
        tGoldNumVertex = { 35, 35 };

        tGoldCoords = {
            { 0.000000000, 0.000000000, 0.000000000 },
            { 1.000000000, 0.000000000, 0.000000000 },
            { 0.000000000, 1.000000000, 0.000000000 },
            { 1.000000000, 1.000000000, 0.000000000 },
            { 0.000000000, 0.000000000, 1.000000000 },
            { 1.000000000, 0.000000000, 1.000000000 },
            { 0.000000000, 1.000000000, 1.000000000 },
            { 1.000000000, 1.000000000, 1.000000000 },
            { 0.000000000, 0.000000000, 2.000000000 },
            { 1.000000000, 0.000000000, 2.000000000 },
            { 0.000000000, 1.000000000, 2.000000000 },
            { 1.000000000, 1.000000000, 2.000000000 },
            { 0.000000000, 0.000000000, 3.000000000 },
            { 1.000000000, 0.000000000, 3.000000000 },
            { 0.000000000, 1.000000000, 3.000000000 },
            { 1.000000000, 1.000000000, 3.000000000 },
            { 0.000000000, 0.000000000, 4.000000000 },
            { 1.000000000, 0.000000000, 4.000000000 },
            { 0.000000000, 1.000000000, 4.000000000 },
            { 1.000000000, 1.000000000, 4.000000000 },
            { 0.500000000, 0.500000000, 2.000000000 },
            { 0.500000000, 0.000000000, 1.500000000 },
            { 1.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 1.000000000, 1.500000000 },
            { 0.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 1.000000000 },
            { 0.500000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.000000000, 0.500000000 },
            { 1.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 1.000000000, 0.500000000 },
            { 0.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 0.000000000 },
            { 0.500000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.000000000, 3.500000000 },
            { 1.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 1.000000000, 3.500000000 },
            { 0.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.500000000, 3.000000000 },
            { 0.500000000, 0.500000000, 4.000000000 },
            { 0.500000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.000000000, 2.500000000 },
            { 1.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 1.000000000, 2.500000000 },
            { 0.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.500000000, 2.500000000 },
        };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 29, 28 }, { 30, 29 }, { 31, 30 }, { 32, 31 }, { 33, 32 }, { 40, 33 }, { 41, 34 }, { 42, 35 }, { 43, 36 }, { 44, 37 }, { 45, 38 }, { 46, 39 }, { 47, 40 }, { 48, 41 }, { 49, 42 }, { 50, 43 }, { 51, 44 } };

        tGoldNumCells = { 75, 75 };

        tGoldCellConn = {
            { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 1, 28, 2, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 28, 6, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 5, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 29, 4, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 29, 8, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 6, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 30, 3, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 8, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 30, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 3, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 7, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 31, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 31, 5, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 2, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 4, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 3, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 32, 3, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 26, 6, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 26, 8, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 26, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 26, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 22, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 22, 10, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 23, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 23, 12, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 10, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 24, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 12, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 24, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 25, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 25, 9, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 26, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 10, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 21, 12, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 21, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 47, 10, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 47, 14, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 47, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 47, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 48, 12, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 48, 16, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 48, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 48, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 49, 11, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 49, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 49, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 49, 15, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 50, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 50, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 50, 15, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 50, 13, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 11, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 44, 14, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 44, 16, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 44, 15, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 44, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 13, 40, 14, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 40, 18, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 18, 40, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 17, 40, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 41, 16, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 41, 20, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 20, 41, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 18, 41, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 42, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 20, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 19, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 42, 19, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 43, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 19, 43, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 43, 19, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 43, 17, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 44, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 45, 18, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 45, 20, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 45, 19, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 19, 45, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
        };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 5, 3 }, { 6, 4 }, { 7, 5 }, { 8, 6 }, { 9, 7 }, { 10, 8 }, { 11, 9 }, { 12, 10 }, { 13, 11 }, { 14, 12 }, { 15, 13 }, { 16, 14 }, { 17, 15 }, { 18, 16 }, { 19, 17 }, { 20, 18 }, { 21, 19 }, { 22, 20 }, { 23, 21 }, { 24, 22 }, { 25, 23 }, { 26, 24 }, { 27, 25 }, { 28, 26 }, { 29, 27 }, { 30, 28 }, { 31, 29 }, { 32, 30 }, { 33, 31 }, { 34, 32 }, { 35, 33 }, { 36, 34 }, { 37, 35 }, { 38, 36 }, { 39, 37 }, { 40, 38 }, { 41, 39 }, { 42, 40 }, { 43, 41 }, { 44, 42 }, { 45, 43 }, { 46, 44 }, { 47, 45 }, { 48, 46 }, { 49, 47 }, { 50, 48 }, { 51, 49 }, { 52, 50 }, { 77, 51 }, { 78, 52 }, { 79, 53 }, { 80, 54 }, { 81, 55 }, { 82, 56 }, { 83, 57 }, { 84, 58 }, { 85, 59 }, { 86, 60 }, { 87, 61 }, { 88, 62 }, { 89, 63 }, { 90, 64 }, { 91, 65 }, { 92, 66 }, { 93, 67 }, { 94, 68 }, { 95, 69 }, { 96, 70 }, { 97, 71 }, { 98, 72 }, { 99, 73 }, { 100, 74 }, { 4, 75 }, { 101, 76 }, { 102, 77 }, { 103, 78 }, { 104, 79 }, { 105, 80 }, { 106, 81 }, { 107, 82 }, { 108, 83 }, { 109, 84 }, { 110, 85 }, { 111, 86 }, { 112, 87 }, { 113, 88 }, { 114, 89 }, { 115, 90 }, { 116, 91 }, { 117, 92 }, { 118, 93 }, { 119, 94 }, { 120, 95 }, { 121, 96 }, { 122, 97 }, { 123, 98 }, { 124, 99 } };
    }
    if ( par_size() == 4 )
    {
        tGoldNumVertex = { 25, 35, 35, 25 };

        tGoldCoords = {
            { 0.000000000, 0.000000000, 0.000000000 },
            { 1.000000000, 0.000000000, 0.000000000 },
            { 0.000000000, 1.000000000, 0.000000000 },
            { 1.000000000, 1.000000000, 0.000000000 },
            { 0.000000000, 0.000000000, 1.000000000 },
            { 1.000000000, 0.000000000, 1.000000000 },
            { 0.000000000, 1.000000000, 1.000000000 },
            { 1.000000000, 1.000000000, 1.000000000 },
            { 0.000000000, 0.000000000, 2.000000000 },
            { 1.000000000, 0.000000000, 2.000000000 },
            { 0.000000000, 1.000000000, 2.000000000 },
            { 1.000000000, 1.000000000, 2.000000000 },
            { 0.000000000, 0.000000000, 3.000000000 },
            { 1.000000000, 0.000000000, 3.000000000 },
            { 0.000000000, 1.000000000, 3.000000000 },
            { 1.000000000, 1.000000000, 3.000000000 },
            { 0.000000000, 0.000000000, 4.000000000 },
            { 1.000000000, 0.000000000, 4.000000000 },
            { 0.000000000, 1.000000000, 4.000000000 },
            { 1.000000000, 1.000000000, 4.000000000 },
            { 0.500000000, 0.500000000, 1.000000000 },
            { 0.500000000, 0.000000000, 0.500000000 },
            { 1.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 1.000000000, 0.500000000 },
            { 0.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 0.000000000 },
            { 0.500000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 2.000000000 },
            { 0.500000000, 0.000000000, 1.500000000 },
            { 1.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 1.000000000, 1.500000000 },
            { 0.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 3.000000000 },
            { 0.500000000, 0.000000000, 2.500000000 },
            { 1.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 1.000000000, 2.500000000 },
            { 0.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.000000000, 3.500000000 },
            { 1.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 1.000000000, 3.500000000 },
            { 0.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.500000000, 4.000000000 },
            { 0.500000000, 0.500000000, 3.500000000 },
        };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 34, 27 }, { 35, 28 }, { 36, 29 }, { 37, 30 }, { 38, 31 }, { 39, 32 }, { 53, 33 }, { 54, 34 }, { 55, 35 }, { 56, 36 }, { 57, 37 }, { 58, 38 }, { 72, 39 }, { 73, 40 }, { 74, 41 }, { 75, 42 }, { 76, 43 }, { 77, 44 } };

        tGoldNumCells = { 50, 75, 75, 50 };

        tGoldCellConn = {
            { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 1, 22, 2, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 22, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 5, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 23, 4, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 23, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 6, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 24, 3, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 8, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 24, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 3, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 7, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 25, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 25, 5, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 2, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 4, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 3, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 26, 3, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 21, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 21, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 21, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 35, 6, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 35, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 36, 8, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 36, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 10, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 37, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 12, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 37, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 38, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 38, 9, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 21, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 34, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 34, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 34, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 9, 54, 10, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 54, 14, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 54, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 54, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 55, 12, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 55, 16, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 55, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 55, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 56, 11, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 56, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 56, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 56, 15, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 57, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 57, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 57, 15, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 57, 13, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 34, 11, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 53, 14, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 53, 16, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 53, 15, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 53, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 13, 72, 14, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 72, 18, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 18, 72, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 17, 72, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 73, 16, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 73, 20, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 20, 73, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 18, 73, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 74, 15, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 20, 74, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 19, 74, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 74, 19, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 19, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 75, 19, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 75, 17, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 53, 15, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 76, 18, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 76, 20, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 76, 19, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 19, 76, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
        };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 5, 2 }, { 6, 3 }, { 7, 4 }, { 8, 5 }, { 9, 6 }, { 10, 7 }, { 11, 8 }, { 12, 9 }, { 13, 10 }, { 14, 11 }, { 15, 12 }, { 16, 13 }, { 17, 14 }, { 18, 15 }, { 19, 16 }, { 20, 17 }, { 21, 18 }, { 22, 19 }, { 23, 20 }, { 24, 21 }, { 25, 22 }, { 26, 23 }, { 27, 24 }, { 28, 25 }, { 53, 26 }, { 54, 27 }, { 55, 28 }, { 56, 29 }, { 57, 30 }, { 58, 31 }, { 59, 32 }, { 60, 33 }, { 61, 34 }, { 62, 35 }, { 63, 36 }, { 64, 37 }, { 65, 38 }, { 66, 39 }, { 67, 40 }, { 68, 41 }, { 69, 42 }, { 70, 43 }, { 71, 44 }, { 72, 45 }, { 73, 46 }, { 74, 47 }, { 75, 48 }, { 76, 49 }, { 3, 50 }, { 125, 51 }, { 126, 52 }, { 127, 53 }, { 128, 54 }, { 129, 55 }, { 130, 56 }, { 131, 57 }, { 132, 58 }, { 133, 59 }, { 134, 60 }, { 135, 61 }, { 136, 62 }, { 137, 63 }, { 138, 64 }, { 139, 65 }, { 140, 66 }, { 141, 67 }, { 142, 68 }, { 143, 69 }, { 144, 70 }, { 145, 71 }, { 146, 72 }, { 147, 73 }, { 148, 74 }, { 4, 75 }, { 197, 76 }, { 198, 77 }, { 199, 78 }, { 200, 79 }, { 201, 80 }, { 202, 81 }, { 203, 82 }, { 204, 83 }, { 205, 84 }, { 206, 85 }, { 207, 86 }, { 208, 87 }, { 209, 88 }, { 210, 89 }, { 211, 90 }, { 212, 91 }, { 213, 92 }, { 214, 93 }, { 215, 94 }, { 216, 95 }, { 217, 96 }, { 218, 97 }, { 219, 98 }, { 220, 99 } };
    }

    CHECK( check_vertices( &tXTKModel, tGoldNumVertex, tGoldVertexMap, tGoldCoords ) );
    CHECK( check_cells( &tXTKModel, tGoldNumCells, tGoldCellMap, tGoldCellConn ) );
    CHECK( interpolated_coordinate_check( tCutMesh ) );

    moris::Matrix< moris::DDRMat > tIsoContourThreshold = { { 0.0 } };
    moris::Matrix< moris::DDRMat > tIsoContourTolerance = { { 1e-12 } };
    CHECK( verify_interface_vertices( &tXTKModel, tIsoContourThreshold, tIsoContourTolerance ) );
}
TEST_CASE( "Geometry with a center point of the regular subdivision", "[XTK_CONFORMAL_COIN2]" )
{
    // Geometry Engine Setup ---------------------------------------------------------
    // Using a Levelset Sphere as the Geometry

    real tXCenter = 0.5;
    real tYCenter = 0.5;
    real tZCenter = 0.5;
    real tXNormal = 1.0;
    real tYNormal = 0.0;
    real tZNormal = 0.0;

    Cell< std::shared_ptr< moris::ge::Geometry > > tGeometry( 1 );
    tGeometry( 0 ) = std::make_shared< moris::ge::Plane >( tXCenter, tYCenter, tZCenter, tXNormal, tYNormal, tZNormal );

    // Create Mesh --------------------------------------------------------------------
    std::string                     tMeshFileName = "generated:1x1x4";
    moris::mtk::Interpolation_Mesh* tMeshData     = moris::mtk::create_interpolation_mesh( MeshType::STK, tMeshFileName, NULL );

    moris::ge::Geometry_Engine_Parameters tGeometryEngineParameters;
    tGeometryEngineParameters.mGeometries = tGeometry;
    moris::ge::Geometry_Engine tGeometryEngine( tMeshData, tGeometryEngineParameters );


    // Setup XTK Model ----------------------------------------------------------------
    size_t tModelDimension = 3;
    Model  tXTKModel( tModelDimension, tMeshData, &tGeometryEngine );
    // tXTKModel.setup_diagnostics( true, "./xtk_diag/", "nhcoin2" );

    //Specify decomposition Method and Cut Mesh ---------------------------------------
    Cell< enum Subdivision_Method > tDecompositionMethods = { Subdivision_Method::NC_REGULAR_SUBDIVISION_HEX8, Subdivision_Method::C_HIERARCHY_TET4 };
    tXTKModel.decompose( tDecompositionMethods );

    // Access the Cut Mesh-------------------------------------------------------------
    Cut_Integration_Mesh* tCutMesh = tXTKModel.get_cut_integration_mesh();

    // Do some testing
    moris::Matrix< moris::DDRMat >                 tGoldCoords( 0, 0 );
    Cell< moris_index >                            tGoldNumVertex( 0 );
    std::unordered_map< moris_index, moris_index > tGoldVertexMap;
    moris::Matrix< moris::IndexMat >               tGoldCellConn( 0, 0 );
    Cell< moris_index >                            tGoldNumCells( 0 );
    std::unordered_map< moris_index, moris_index > tGoldCellMap;

    if ( par_size() == 1 )
    {
        tGoldNumVertex = { 55 };

        tGoldCoords = { { 0.000000000, 0.000000000, 0.000000000 },
            { 1.000000000, 0.000000000, 0.000000000 },
            { 0.000000000, 1.000000000, 0.000000000 },
            { 1.000000000, 1.000000000, 0.000000000 },
            { 0.000000000, 0.000000000, 1.000000000 },
            { 1.000000000, 0.000000000, 1.000000000 },
            { 0.000000000, 1.000000000, 1.000000000 },
            { 1.000000000, 1.000000000, 1.000000000 },
            { 0.000000000, 0.000000000, 2.000000000 },
            { 1.000000000, 0.000000000, 2.000000000 },
            { 0.000000000, 1.000000000, 2.000000000 },
            { 1.000000000, 1.000000000, 2.000000000 },
            { 0.000000000, 0.000000000, 3.000000000 },
            { 1.000000000, 0.000000000, 3.000000000 },
            { 0.000000000, 1.000000000, 3.000000000 },
            { 1.000000000, 1.000000000, 3.000000000 },
            { 0.000000000, 0.000000000, 4.000000000 },
            { 1.000000000, 0.000000000, 4.000000000 },
            { 0.000000000, 1.000000000, 4.000000000 },
            { 1.000000000, 1.000000000, 4.000000000 },
            { 0.500000000, 0.000000000, 3.500000000 },
            { 1.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 1.000000000, 3.500000000 },
            { 0.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.500000000, 3.000000000 },
            { 0.500000000, 0.500000000, 4.000000000 },
            { 0.500000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.000000000, 2.500000000 },
            { 1.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 1.000000000, 2.500000000 },
            { 0.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.500000000, 2.000000000 },
            { 0.500000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.000000000, 1.500000000 },
            { 1.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 1.000000000, 1.500000000 },
            { 0.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 1.000000000 },
            { 0.500000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.000000000, 0.500000000 },
            { 1.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 1.000000000, 0.500000000 },
            { 0.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 0.000000000 },
            { 0.500000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.000000000, 0.000000000 },
            { 0.500000000, 0.000000000, 1.000000000 },
            { 0.500000000, 1.000000000, 0.000000000 },
            { 0.500000000, 1.000000000, 1.000000000 },
            { 0.500000000, 0.000000000, 2.000000000 },
            { 0.500000000, 1.000000000, 2.000000000 },
            { 0.500000000, 0.000000000, 3.000000000 },
            { 0.500000000, 1.000000000, 3.000000000 },
            { 0.500000000, 0.000000000, 4.000000000 },
            { 0.500000000, 1.000000000, 4.000000000 } };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 29, 28 }, { 30, 29 }, { 31, 30 }, { 32, 31 }, { 33, 32 }, { 34, 33 }, { 35, 34 }, { 36, 35 }, { 37, 36 }, { 38, 37 }, { 39, 38 }, { 40, 39 }, { 41, 40 }, { 42, 41 }, { 43, 42 }, { 44, 43 }, { 45, 44 }, { 46, 45 }, { 47, 46 }, { 48, 47 }, { 49, 48 }, { 50, 49 }, { 51, 50 }, { 52, 51 }, { 53, 52 }, { 54, 53 }, { 55, 54 } };

        tGoldNumCells = { 132 };

        tGoldCellConn = { { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 1, 40, 46, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 40, 6, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 47, 40, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 5, 40, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 41, 4, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 41, 8, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 41, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 6, 41, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 42, 48, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 8, 42, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 49, 42, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 42, 7, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 3, 43, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 7, 43, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 43, 7, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 43, 5, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 46, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 4, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 48, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 44, 3, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 38, 47, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 38, 8, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 38, 49, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 38, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 34, 47, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 34, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 50, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 35, 8, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 35, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 10, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 36, 49, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 12, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 51, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 36, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 37, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 37, 9, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 47, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 49, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 38, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 32, 50, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 32, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 32, 51, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 32, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 28, 50, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 28, 14, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 52, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 29, 12, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 29, 16, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 30, 51, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 53, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 30, 15, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 31, 15, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 31, 13, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 50, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 51, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 32, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 25, 52, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 25, 16, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 25, 53, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 25, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 21, 52, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 21, 18, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 54, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 17, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 22, 16, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 22, 20, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 20, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 18, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 23, 53, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 20, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 55, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 23, 19, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 19, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 24, 19, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 24, 17, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 52, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 53, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 25, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 26, 54, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 26, 20, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 26, 55, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 19, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 46, 40, 2, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 47, 6, 40, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 48, 42, 3, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 49, 7, 42, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 46, 2, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 48, 3, 44, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 47, 38, 6, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 49, 38, 7, 45, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 47, 34, 6, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 50, 10, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 49, 36, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 51, 11, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 47, 6, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 49, 7, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 50, 32, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 51, 32, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 50, 28, 10, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 52, 14, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 51, 30, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 53, 15, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 50, 10, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 51, 11, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 52, 25, 14, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 53, 25, 15, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 52, 21, 14, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 54, 18, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 53, 23, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 55, 19, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 52, 14, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 53, 15, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 54, 26, 18, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 55, 26, 19, 27, 2147483647, 2147483647, 2147483647, 2147483647 } };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 37, 28 }, { 38, 29 }, { 39, 30 }, { 40, 31 }, { 41, 32 }, { 42, 33 }, { 43, 34 }, { 44, 35 }, { 45, 36 }, { 46, 37 }, { 47, 38 }, { 48, 39 }, { 49, 40 }, { 50, 41 }, { 51, 42 }, { 52, 43 }, { 53, 44 }, { 54, 45 }, { 55, 46 }, { 56, 47 }, { 57, 48 }, { 58, 49 }, { 59, 50 }, { 60, 51 }, { 69, 52 }, { 70, 53 }, { 71, 54 }, { 72, 55 }, { 73, 56 }, { 74, 57 }, { 75, 58 }, { 76, 59 }, { 77, 60 }, { 78, 61 }, { 79, 62 }, { 80, 63 }, { 81, 64 }, { 82, 65 }, { 83, 66 }, { 84, 67 }, { 85, 68 }, { 86, 69 }, { 87, 70 }, { 88, 71 }, { 89, 72 }, { 90, 73 }, { 91, 74 }, { 92, 75 }, { 101, 76 }, { 102, 77 }, { 103, 78 }, { 104, 79 }, { 105, 80 }, { 106, 81 }, { 107, 82 }, { 108, 83 }, { 109, 84 }, { 110, 85 }, { 111, 86 }, { 112, 87 }, { 113, 88 }, { 114, 89 }, { 115, 90 }, { 116, 91 }, { 117, 92 }, { 118, 93 }, { 119, 94 }, { 120, 95 }, { 121, 96 }, { 122, 97 }, { 123, 98 }, { 124, 99 }, { 29, 100 }, { 30, 101 }, { 31, 102 }, { 32, 103 }, { 33, 104 }, { 34, 105 }, { 35, 106 }, { 36, 107 }, { 61, 108 }, { 62, 109 }, { 63, 110 }, { 64, 111 }, { 65, 112 }, { 66, 113 }, { 67, 114 }, { 68, 115 }, { 93, 116 }, { 94, 117 }, { 95, 118 }, { 96, 119 }, { 97, 120 }, { 98, 121 }, { 99, 122 }, { 100, 123 }, { 125, 124 }, { 126, 125 }, { 127, 126 }, { 128, 127 }, { 129, 128 }, { 130, 129 }, { 131, 130 }, { 132, 131 } };
    }
    if ( par_size() == 2 )
    {
        tGoldNumVertex = { 43, 43 };

        tGoldCoords = {
            { 0.000000000, 0.000000000, 0.000000000 },
            { 1.000000000, 0.000000000, 0.000000000 },
            { 0.000000000, 1.000000000, 0.000000000 },
            { 1.000000000, 1.000000000, 0.000000000 },
            { 0.000000000, 0.000000000, 1.000000000 },
            { 1.000000000, 0.000000000, 1.000000000 },
            { 0.000000000, 1.000000000, 1.000000000 },
            { 1.000000000, 1.000000000, 1.000000000 },
            { 0.000000000, 0.000000000, 2.000000000 },
            { 1.000000000, 0.000000000, 2.000000000 },
            { 0.000000000, 1.000000000, 2.000000000 },
            { 1.000000000, 1.000000000, 2.000000000 },
            { 0.000000000, 0.000000000, 3.000000000 },
            { 1.000000000, 0.000000000, 3.000000000 },
            { 0.000000000, 1.000000000, 3.000000000 },
            { 1.000000000, 1.000000000, 3.000000000 },
            { 0.000000000, 0.000000000, 4.000000000 },
            { 1.000000000, 0.000000000, 4.000000000 },
            { 0.000000000, 1.000000000, 4.000000000 },
            { 1.000000000, 1.000000000, 4.000000000 },
            { 0.500000000, 0.500000000, 2.000000000 },
            { 0.500000000, 0.000000000, 1.500000000 },
            { 1.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 1.000000000, 1.500000000 },
            { 0.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 1.000000000 },
            { 0.500000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.000000000, 0.500000000 },
            { 1.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 1.000000000, 0.500000000 },
            { 0.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 0.000000000 },
            { 0.500000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.000000000, 3.500000000 },
            { 1.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 1.000000000, 3.500000000 },
            { 0.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.500000000, 3.000000000 },
            { 0.500000000, 0.500000000, 4.000000000 },
            { 0.500000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.000000000, 2.500000000 },
            { 1.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 1.000000000, 2.500000000 },
            { 0.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.000000000, 0.000000000 },
            { 0.500000000, 0.000000000, 1.000000000 },
            { 0.500000000, 1.000000000, 0.000000000 },
            { 0.500000000, 1.000000000, 1.000000000 },
            { 0.500000000, 0.000000000, 2.000000000 },
            { 0.500000000, 1.000000000, 2.000000000 },
            { 0.500000000, 0.000000000, 3.000000000 },
            { 0.500000000, 1.000000000, 3.000000000 },
            { 0.500000000, 0.000000000, 4.000000000 },
            { 0.500000000, 1.000000000, 4.000000000 },
        };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 29, 28 }, { 30, 29 }, { 31, 30 }, { 32, 31 }, { 33, 32 }, { 40, 33 }, { 41, 34 }, { 42, 35 }, { 43, 36 }, { 44, 37 }, { 45, 38 }, { 46, 39 }, { 47, 40 }, { 48, 41 }, { 49, 42 }, { 50, 43 }, { 51, 44 }, { 59, 45 }, { 60, 46 }, { 61, 47 }, { 62, 48 }, { 63, 49 }, { 64, 50 }, { 67, 51 }, { 68, 52 }, { 69, 53 }, { 70, 54 } };

        tGoldNumCells = { 99, 99 };

        tGoldCellConn = {
            { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 1, 28, 59, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 28, 6, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 60, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 5, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 29, 4, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 29, 8, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 6, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 30, 61, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 8, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 62, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 30, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 3, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 7, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 31, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 31, 5, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 59, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 4, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 61, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 32, 3, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 26, 60, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 26, 8, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 26, 62, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 26, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 22, 60, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 22, 10, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 63, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 23, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 23, 12, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 10, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 24, 62, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 12, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 64, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 24, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 25, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 25, 9, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 60, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 62, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 26, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 63, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 21, 12, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 21, 64, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 47, 63, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 47, 14, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 67, 47, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 47, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 48, 12, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 48, 16, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 48, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 48, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 49, 64, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 49, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 68, 49, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 49, 15, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 50, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 50, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 50, 15, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 50, 13, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 63, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 64, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 11, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 44, 67, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 44, 16, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 44, 68, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 44, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 59, 28, 2, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 60, 6, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 61, 30, 3, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 62, 7, 30, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 59, 2, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 61, 3, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 60, 26, 6, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 62, 26, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 60, 22, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 63, 10, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 62, 24, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 64, 11, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 60, 6, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 62, 7, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 63, 21, 10, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 64, 21, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 63, 47, 10, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 67, 14, 47, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 64, 49, 11, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 68, 15, 49, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 63, 10, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 64, 11, 21, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 67, 44, 14, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 68, 44, 15, 51, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 13, 40, 67, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 40, 18, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 69, 40, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 17, 40, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 41, 16, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 41, 20, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 20, 41, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 18, 41, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 42, 68, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 20, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 70, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 42, 19, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 43, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 19, 43, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 43, 19, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 43, 17, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 67, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 68, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 44, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 45, 69, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 45, 20, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 45, 70, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 19, 45, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 67, 40, 14, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 69, 18, 40, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 68, 42, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 70, 19, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 67, 14, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 68, 15, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 69, 45, 18, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 70, 45, 19, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
        };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 5, 3 }, { 6, 4 }, { 7, 5 }, { 8, 6 }, { 9, 7 }, { 10, 8 }, { 11, 9 }, { 12, 10 }, { 13, 11 }, { 14, 12 }, { 15, 13 }, { 16, 14 }, { 17, 15 }, { 18, 16 }, { 19, 17 }, { 20, 18 }, { 21, 19 }, { 22, 20 }, { 23, 21 }, { 24, 22 }, { 25, 23 }, { 26, 24 }, { 27, 25 }, { 28, 26 }, { 37, 27 }, { 38, 28 }, { 39, 29 }, { 40, 30 }, { 41, 31 }, { 42, 32 }, { 43, 33 }, { 44, 34 }, { 45, 35 }, { 46, 36 }, { 47, 37 }, { 48, 38 }, { 49, 39 }, { 50, 40 }, { 51, 41 }, { 52, 42 }, { 53, 43 }, { 54, 44 }, { 55, 45 }, { 56, 46 }, { 57, 47 }, { 58, 48 }, { 59, 49 }, { 60, 50 }, { 101, 51 }, { 102, 52 }, { 103, 53 }, { 104, 54 }, { 105, 55 }, { 106, 56 }, { 107, 57 }, { 108, 58 }, { 109, 59 }, { 110, 60 }, { 111, 61 }, { 112, 62 }, { 113, 63 }, { 114, 64 }, { 115, 65 }, { 116, 66 }, { 117, 67 }, { 118, 68 }, { 119, 69 }, { 120, 70 }, { 121, 71 }, { 122, 72 }, { 123, 73 }, { 124, 74 }, { 29, 75 }, { 30, 76 }, { 31, 77 }, { 32, 78 }, { 33, 79 }, { 34, 80 }, { 35, 81 }, { 36, 82 }, { 61, 83 }, { 62, 84 }, { 63, 85 }, { 64, 86 }, { 65, 87 }, { 66, 88 }, { 67, 89 }, { 68, 90 }, { 125, 91 }, { 126, 92 }, { 127, 93 }, { 128, 94 }, { 129, 95 }, { 130, 96 }, { 131, 97 }, { 132, 98 }, { 4, 99 }, { 133, 100 }, { 134, 101 }, { 135, 102 }, { 136, 103 }, { 137, 104 }, { 138, 105 }, { 139, 106 }, { 140, 107 }, { 141, 108 }, { 142, 109 }, { 143, 110 }, { 144, 111 }, { 145, 112 }, { 146, 113 }, { 147, 114 }, { 148, 115 }, { 149, 116 }, { 150, 117 }, { 151, 118 }, { 152, 119 }, { 153, 120 }, { 154, 121 }, { 155, 122 }, { 156, 123 }, { 157, 124 }, { 158, 125 }, { 159, 126 }, { 160, 127 }, { 161, 128 }, { 162, 129 }, { 163, 130 }, { 164, 131 } };
    }
    if ( par_size() == 4 )
    {
        tGoldNumVertex = { 31, 43, 43, 31 };

        tGoldCoords = {
            { 0.000000000, 0.000000000, 0.000000000 },
            { 1.000000000, 0.000000000, 0.000000000 },
            { 0.000000000, 1.000000000, 0.000000000 },
            { 1.000000000, 1.000000000, 0.000000000 },
            { 0.000000000, 0.000000000, 1.000000000 },
            { 1.000000000, 0.000000000, 1.000000000 },
            { 0.000000000, 1.000000000, 1.000000000 },
            { 1.000000000, 1.000000000, 1.000000000 },
            { 0.000000000, 0.000000000, 2.000000000 },
            { 1.000000000, 0.000000000, 2.000000000 },
            { 0.000000000, 1.000000000, 2.000000000 },
            { 1.000000000, 1.000000000, 2.000000000 },
            { 0.000000000, 0.000000000, 3.000000000 },
            { 1.000000000, 0.000000000, 3.000000000 },
            { 0.000000000, 1.000000000, 3.000000000 },
            { 1.000000000, 1.000000000, 3.000000000 },
            { 0.000000000, 0.000000000, 4.000000000 },
            { 1.000000000, 0.000000000, 4.000000000 },
            { 0.000000000, 1.000000000, 4.000000000 },
            { 1.000000000, 1.000000000, 4.000000000 },
            { 0.500000000, 0.500000000, 1.000000000 },
            { 0.500000000, 0.000000000, 0.500000000 },
            { 1.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 1.000000000, 0.500000000 },
            { 0.000000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 0.000000000 },
            { 0.500000000, 0.500000000, 0.500000000 },
            { 0.500000000, 0.500000000, 2.000000000 },
            { 0.500000000, 0.000000000, 1.500000000 },
            { 1.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 1.000000000, 1.500000000 },
            { 0.000000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 1.500000000 },
            { 0.500000000, 0.500000000, 3.000000000 },
            { 0.500000000, 0.000000000, 2.500000000 },
            { 1.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 1.000000000, 2.500000000 },
            { 0.000000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.500000000, 2.500000000 },
            { 0.500000000, 0.000000000, 3.500000000 },
            { 1.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 1.000000000, 3.500000000 },
            { 0.000000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.500000000, 4.000000000 },
            { 0.500000000, 0.500000000, 3.500000000 },
            { 0.500000000, 0.000000000, 0.000000000 },
            { 0.500000000, 0.000000000, 1.000000000 },
            { 0.500000000, 1.000000000, 0.000000000 },
            { 0.500000000, 1.000000000, 1.000000000 },
            { 0.500000000, 0.000000000, 2.000000000 },
            { 0.500000000, 1.000000000, 2.000000000 },
            { 0.500000000, 0.000000000, 3.000000000 },
            { 0.500000000, 1.000000000, 3.000000000 },
            { 0.500000000, 0.000000000, 4.000000000 },
            { 0.500000000, 1.000000000, 4.000000000 },
        };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 34, 27 }, { 35, 28 }, { 36, 29 }, { 37, 30 }, { 38, 31 }, { 39, 32 }, { 53, 33 }, { 54, 34 }, { 55, 35 }, { 56, 36 }, { 57, 37 }, { 58, 38 }, { 72, 39 }, { 73, 40 }, { 74, 41 }, { 75, 42 }, { 76, 43 }, { 77, 44 }, { 85, 45 }, { 86, 46 }, { 87, 47 }, { 88, 48 }, { 91, 49 }, { 92, 50 }, { 99, 51 }, { 100, 52 }, { 107, 53 }, { 108, 54 } };

        tGoldNumCells = { 66, 99, 99, 66 };

        tGoldCellConn = {
            { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 1, 22, 85, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 22, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 86, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 5, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 23, 4, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 23, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 6, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 24, 87, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 8, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 88, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 24, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 3, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 3, 7, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 25, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 25, 5, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 85, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 2, 4, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 4, 87, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 1, 26, 3, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 21, 86, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 21, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 21, 88, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 35, 86, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 35, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 91, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 36, 8, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 36, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 10, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 37, 88, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 12, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 92, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 37, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 38, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 38, 9, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 86, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 88, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 21, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 34, 91, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 34, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 34, 92, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 85, 22, 2, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 86, 6, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 87, 24, 3, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 88, 7, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 85, 2, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 87, 3, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 86, 21, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 88, 21, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 86, 35, 6, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 91, 10, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 88, 37, 7, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 92, 11, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 86, 6, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 88, 7, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 91, 34, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 92, 34, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 9, 54, 91, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 54, 14, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 99, 54, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 54, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 55, 12, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 55, 16, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 55, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 55, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 56, 92, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 56, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 100, 56, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 56, 15, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 57, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 57, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 57, 15, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 57, 13, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 91, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 92, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 34, 11, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 53, 99, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 53, 16, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 53, 100, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 53, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 91, 54, 10, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 99, 14, 54, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 92, 56, 11, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 100, 15, 56, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 91, 10, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 92, 11, 34, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 99, 53, 14, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 100, 53, 15, 58, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 13, 72, 99, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 72, 18, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 107, 72, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 17, 72, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 73, 16, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 73, 20, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 20, 73, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 18, 73, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 74, 100, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 20, 74, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 108, 74, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 74, 19, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 15, 19, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 75, 19, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 75, 17, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 99, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 100, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 53, 15, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 76, 107, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 18, 76, 20, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 20, 76, 108, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 17, 19, 76, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 99, 72, 14, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 107, 18, 72, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 100, 74, 15, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 108, 19, 74, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 99, 14, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 100, 15, 53, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 107, 76, 18, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 108, 76, 19, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
        };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 5, 2 }, { 6, 3 }, { 7, 4 }, { 8, 5 }, { 9, 6 }, { 10, 7 }, { 11, 8 }, { 12, 9 }, { 13, 10 }, { 14, 11 }, { 15, 12 }, { 16, 13 }, { 17, 14 }, { 18, 15 }, { 19, 16 }, { 20, 17 }, { 21, 18 }, { 22, 19 }, { 23, 20 }, { 24, 21 }, { 25, 22 }, { 26, 23 }, { 27, 24 }, { 28, 25 }, { 69, 26 }, { 70, 27 }, { 71, 28 }, { 72, 29 }, { 73, 30 }, { 74, 31 }, { 75, 32 }, { 76, 33 }, { 77, 34 }, { 78, 35 }, { 79, 36 }, { 80, 37 }, { 81, 38 }, { 82, 39 }, { 83, 40 }, { 84, 41 }, { 85, 42 }, { 86, 43 }, { 87, 44 }, { 88, 45 }, { 89, 46 }, { 90, 47 }, { 91, 48 }, { 92, 49 }, { 29, 50 }, { 30, 51 }, { 31, 52 }, { 32, 53 }, { 33, 54 }, { 34, 55 }, { 35, 56 }, { 36, 57 }, { 93, 58 }, { 94, 59 }, { 95, 60 }, { 96, 61 }, { 97, 62 }, { 98, 63 }, { 99, 64 }, { 100, 65 }, { 3, 66 }, { 165, 67 }, { 166, 68 }, { 167, 69 }, { 168, 70 }, { 169, 71 }, { 170, 72 }, { 171, 73 }, { 172, 74 }, { 173, 75 }, { 174, 76 }, { 175, 77 }, { 176, 78 }, { 177, 79 }, { 178, 80 }, { 179, 81 }, { 180, 82 }, { 181, 83 }, { 182, 84 }, { 183, 85 }, { 184, 86 }, { 185, 87 }, { 186, 88 }, { 187, 89 }, { 188, 90 }, { 189, 91 }, { 190, 92 }, { 191, 93 }, { 192, 94 }, { 193, 95 }, { 194, 96 }, { 195, 97 }, { 196, 98 }, { 4, 99 }, { 261, 100 }, { 262, 101 }, { 263, 102 }, { 264, 103 }, { 265, 104 }, { 266, 105 }, { 267, 106 }, { 268, 107 }, { 269, 108 }, { 270, 109 }, { 271, 110 }, { 272, 111 }, { 273, 112 }, { 274, 113 }, { 275, 114 }, { 276, 115 }, { 277, 116 }, { 278, 117 }, { 279, 118 }, { 280, 119 }, { 281, 120 }, { 282, 121 }, { 283, 122 }, { 284, 123 }, { 285, 124 }, { 286, 125 }, { 287, 126 }, { 288, 127 }, { 289, 128 }, { 290, 129 }, { 291, 130 }, { 292, 131 } };
    }

    CHECK( check_vertices( &tXTKModel, tGoldNumVertex, tGoldVertexMap, tGoldCoords ) );
    CHECK( check_cells( &tXTKModel, tGoldNumCells, tGoldCellMap, tGoldCellConn ) );
    CHECK( interpolated_coordinate_check( tCutMesh ) );

    moris::Matrix< moris::DDRMat > tIsoContourThreshold = { { 0.0 } };
    moris::Matrix< moris::DDRMat > tIsoContourTolerance = { { 1e-12 } };
    CHECK( verify_interface_vertices( &tXTKModel, tIsoContourThreshold, tIsoContourTolerance ) );
}

TEST_CASE( "Geometry with a plane to trigger 2 edge intersected tets", "[XTK_CONFORMAL_COIN3]" )
{
    // Geometry Engine Setup ---------------------------------------------------------
    // Using a Levelset Sphere as the Geometry

    real tXCenter = 0.0;
    real tYCenter = 0.0;
    real tZCenter = 2.0;
    real tXNormal = 0.2;
    real tYNormal = 0.0;
    real tZNormal = 1.0;

    Cell< std::shared_ptr< moris::ge::Geometry > > tGeometry( 1 );
    tGeometry( 0 ) = std::make_shared< moris::ge::Plane >( tXCenter, tYCenter, tZCenter, tXNormal, tYNormal, tZNormal );

    // Create Mesh --------------------------------------------------------------------
    std::string                     tMeshFileName = "generated:1x1x4";
    moris::mtk::Interpolation_Mesh* tMeshData     = moris::mtk::create_interpolation_mesh( MeshType::STK, tMeshFileName, NULL );

    moris::ge::Geometry_Engine_Parameters tGeometryEngineParameters;
    tGeometryEngineParameters.mGeometries = tGeometry;
    moris::ge::Geometry_Engine tGeometryEngine( tMeshData, tGeometryEngineParameters );


    // Setup XTK Model ----------------------------------------------------------------
    size_t tModelDimension = 3;
    Model  tXTKModel( tModelDimension, tMeshData, &tGeometryEngine );
    // tXTKModel.setup_diagnostics( true, "./xtk_diag/", "nhcoin3" );

    //Specify decomposition Method and Cut Mesh ---------------------------------------
    Cell< enum Subdivision_Method > tDecompositionMethods = { Subdivision_Method::NC_REGULAR_SUBDIVISION_HEX8, Subdivision_Method::C_HIERARCHY_TET4 };
    tXTKModel.decompose( tDecompositionMethods );

    // Access the Cut Mesh-------------------------------------------------------------
    Cut_Integration_Mesh* tCutMesh = tXTKModel.get_cut_integration_mesh();

    // Do some testing
    moris::Matrix< moris::DDRMat >                 tGoldCoords( 0, 0 );
    Cell< moris_index >                            tGoldNumVertex( 0 );
    std::unordered_map< moris_index, moris_index > tGoldVertexMap;
    moris::Matrix< moris::IndexMat >               tGoldCellConn( 0, 0 );
    Cell< moris_index >                            tGoldNumCells( 0 );
    std::unordered_map< moris_index, moris_index > tGoldCellMap;

    if ( par_size() == 1 )
    {
        tGoldNumVertex = { 42 };

        tGoldCoords = { { 0.0, 0.0, 0.0 },
            { 1.0, 0.0, 0.0 },
            { 0.0, 1.0, 0.0 },
            { 1.0, 1.0, 0.0 },
            { 0.0, 0.0, 1.0 },
            { 1.0, 0.0, 1.0 },
            { 0.0, 1.0, 1.0 },
            { 1.0, 1.0, 1.0 },
            { 0.0, 0.0, 2.0 },
            { 1.0, 0.0, 2.0 },
            { 0.0, 1.0, 2.0 },
            { 1.0, 1.0, 2.0 },
            { 0.0, 0.0, 3.0 },
            { 1.0, 0.0, 3.0 },
            { 0.0, 1.0, 3.0 },
            { 1.0, 1.0, 3.0 },
            { 0.0, 0.0, 4.0 },
            { 1.0, 0.0, 4.0 },
            { 0.0, 1.0, 4.0 },
            { 1.0, 1.0, 4.0 },
            { 0.5, 0.0, 2.5 },
            { 1.0, 0.5, 2.5 },
            { 0.5, 1.0, 2.5 },
            { 0.0, 0.5, 2.5 },
            { 0.5, 0.5, 2.0 },
            { 0.5, 0.5, 3.0 },
            { 0.5, 0.5, 2.5 },
            { 0.5, 0.0, 1.5 },
            { 1.0, 0.5, 1.5 },
            { 0.5, 1.0, 1.5 },
            { 0.0, 0.5, 1.5 },
            { 0.5, 0.5, 1.0 },
            { 0.5, 0.5, 1.5 },
            { 0.8333333333333331, 0.0, 1.833333333333333 },
            { 1.0, 0.0, 1.8 },
            { 0.8333333333333331, 0.1666666666666667, 1.833333333333333 },
            { 1.0, 0.8, 1.8 },
            { 1.0, 1.0, 1.8 },
            { 0.8333333333333331, 0.8333333333333331, 1.833333333333333 },
            { 1.0, 0.2, 1.8 },
            { 0.8333333333333331, 1.0, 1.833333333333333 },
            { 0.5, 0.5, 1.9 } };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 29, 28 }, { 30, 29 }, { 31, 30 }, { 32, 31 }, { 33, 32 }, { 34, 33 }, { 35, 34 }, { 36, 35 }, { 37, 36 }, { 38, 37 }, { 39, 38 }, { 40, 39 }, { 41, 40 }, { 42, 41 } };

        tGoldNumCells = { 81 };

        tGoldCellConn = { { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
            { 5, 28, 6, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 34, 10, 35, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 34, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 29, 8, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 37, 12, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 36, 39, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 35, 36, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 30, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 38, 39, 41, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 41, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 30, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 31, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 31, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 31, 9, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 32, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 25, 10, 42, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 36, 39, 42, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 42, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 42, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 10, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 21, 14, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 21, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 22, 12, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 22, 16, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 23, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 23, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 23, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 24, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 24, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 24, 13, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 25, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 26, 14, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 26, 16, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 26, 15, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 28, 34, 35, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 28, 35, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 28, 6, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 34, 28, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 36, 28, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 29, 37, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 29, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 29, 8, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 10, 39, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 37, 12, 39, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 29, 37, 39, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 29, 39, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 36, 33, 39, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 35, 6, 36, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 33, 36, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 29, 33, 40, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 38, 8, 39, 41, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 33, 39, 41, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 30, 33, 41, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 39, 11, 41, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 30, 41, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 42, 10, 36, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 42, 36, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 36, 10, 39, 42, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 39, 42, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 25, 12, 42, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 25, 11, 42, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 39, 42, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 25, 42, 2147483647, 2147483647, 2147483647, 2147483647 } };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 28, 27 }, { 58, 28 }, { 59, 29 }, { 60, 30 }, { 61, 31 }, { 62, 32 }, { 63, 33 }, { 64, 34 }, { 65, 35 }, { 66, 36 }, { 67, 37 }, { 68, 38 }, { 69, 39 }, { 70, 40 }, { 71, 41 }, { 72, 42 }, { 73, 43 }, { 74, 44 }, { 75, 45 }, { 76, 46 }, { 77, 47 }, { 78, 48 }, { 79, 49 }, { 80, 50 }, { 81, 51 }, { 29, 52 }, { 30, 53 }, { 31, 54 }, { 32, 55 }, { 33, 56 }, { 34, 57 }, { 35, 58 }, { 36, 59 }, { 37, 60 }, { 38, 61 }, { 39, 62 }, { 40, 63 }, { 41, 64 }, { 42, 65 }, { 43, 66 }, { 44, 67 }, { 45, 68 }, { 46, 69 }, { 47, 70 }, { 48, 71 }, { 49, 72 }, { 50, 73 }, { 51, 74 }, { 52, 75 }, { 53, 76 }, { 54, 77 }, { 55, 78 }, { 56, 79 }, { 57, 80 } };
    }
    if ( par_size() == 2 )
    {
        tGoldNumVertex = { 38, 38 };

        tGoldCoords = {
            { 0.0, 0.0, 0.0 },
            { 1.0, 0.0, 0.0 },
            { 0.0, 1.0, 0.0 },
            { 1.0, 1.0, 0.0 },
            { 0.0, 0.0, 1.0 },
            { 1.0, 0.0, 1.0 },
            { 0.0, 1.0, 1.0 },
            { 1.0, 1.0, 1.0 },
            { 0.0, 0.0, 2.0 },
            { 1.0, 0.0, 2.0 },
            { 0.0, 1.0, 2.0 },
            { 1.0, 1.0, 2.0 },
            { 0.0, 0.0, 3.0 },
            { 1.0, 0.0, 3.0 },
            { 0.0, 1.0, 3.0 },
            { 1.0, 1.0, 3.0 },
            { 0.0, 0.0, 4.0 },
            { 1.0, 0.0, 4.0 },
            { 0.0, 1.0, 4.0 },
            { 1.0, 1.0, 4.0 },
            { 0.5, 0.5, 2.0 },
            { 0.5, 0.0, 1.5 },
            { 1.0, 0.5, 1.5 },
            { 0.5, 1.0, 1.5 },
            { 0.0, 0.5, 1.5 },
            { 0.5, 0.5, 1.0 },
            { 0.5, 0.5, 1.5 },
            { 0.5, 0.0, 2.5 },
            { 1.0, 0.5, 2.5 },
            { 0.5, 1.0, 2.5 },
            { 0.0, 0.5, 2.5 },
            { 0.5, 0.5, 3.0 },
            { 0.5, 0.5, 2.5 },
            { 0.8333333333333331, 0.0, 1.833333333333333 },
            { 1.0, 0.0, 1.8 },
            { 0.8333333333333331, 0.1666666666666667, 1.833333333333333 },
            { 1.0, 0.8, 1.8 },
            { 1.0, 1.0, 1.8 },
            { 0.8333333333333331, 0.8333333333333331, 1.833333333333333 },
            { 1.0, 0.2, 1.8 },
            { 0.8333333333333331, 1.0, 1.833333333333333 },
            { 0.5, 0.5, 1.9 },
        };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 22, 21 }, { 23, 22 }, { 24, 23 }, { 25, 24 }, { 26, 25 }, { 27, 26 }, { 34, 27 }, { 35, 28 }, { 36, 29 }, { 37, 30 }, { 38, 31 }, { 39, 32 }, { 47, 33 }, { 48, 34 }, { 49, 35 }, { 50, 36 }, { 51, 37 }, { 52, 38 }, { 53, 39 }, { 54, 40 }, { 55, 41 } };

        tGoldNumCells = { 80, 80 };

        tGoldCellConn = {
            { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 5, 22, 6, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 47, 10, 48, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 47, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 23, 8, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 50, 12, 51, 52, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 49, 52, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 48, 49, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 24, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 51, 52, 54, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 54, 52, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 24, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 25, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 25, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 25, 9, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 26, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 26, 7, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 10, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 27, 49, 52, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 55, 11, 52, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 55, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 34, 10, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 34, 14, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 34, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 35, 12, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 35, 16, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 35, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 36, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 36, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 36, 15, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 37, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 37, 15, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 37, 13, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 21, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 21, 11, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 38, 14, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 38, 16, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 38, 15, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 38, 39, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 22, 47, 48, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 22, 48, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 27, 22, 6, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 47, 22, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 49, 22, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 23, 50, 51, 52, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 23, 51, 52, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 27, 23, 8, 52, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 10, 52, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 50, 12, 52, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 23, 50, 52, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 27, 23, 52, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 49, 27, 52, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 48, 6, 49, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 27, 49, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 23, 27, 53, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 51, 8, 52, 54, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 27, 52, 54, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 24, 27, 54, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 52, 11, 54, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 24, 54, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 55, 10, 49, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 55, 49, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 49, 10, 52, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 52, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 21, 12, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 21, 11, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 52, 55, 11, 27, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 21, 55, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
        };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 5, 3 }, { 6, 4 }, { 7, 5 }, { 8, 6 }, { 9, 7 }, { 10, 8 }, { 11, 9 }, { 12, 10 }, { 13, 11 }, { 14, 12 }, { 15, 13 }, { 16, 14 }, { 17, 15 }, { 18, 16 }, { 19, 17 }, { 20, 18 }, { 21, 19 }, { 22, 20 }, { 23, 21 }, { 24, 22 }, { 25, 23 }, { 26, 24 }, { 27, 25 }, { 28, 26 }, { 82, 27 }, { 83, 28 }, { 84, 29 }, { 85, 30 }, { 86, 31 }, { 87, 32 }, { 88, 33 }, { 89, 34 }, { 90, 35 }, { 91, 36 }, { 92, 37 }, { 93, 38 }, { 94, 39 }, { 95, 40 }, { 96, 41 }, { 97, 42 }, { 98, 43 }, { 99, 44 }, { 100, 45 }, { 101, 46 }, { 102, 47 }, { 103, 48 }, { 104, 49 }, { 105, 50 }, { 29, 51 }, { 30, 52 }, { 31, 53 }, { 32, 54 }, { 33, 55 }, { 34, 56 }, { 35, 57 }, { 36, 58 }, { 37, 59 }, { 38, 60 }, { 39, 61 }, { 40, 62 }, { 41, 63 }, { 42, 64 }, { 43, 65 }, { 44, 66 }, { 45, 67 }, { 46, 68 }, { 47, 69 }, { 48, 70 }, { 49, 71 }, { 50, 72 }, { 51, 73 }, { 52, 74 }, { 53, 75 }, { 54, 76 }, { 55, 77 }, { 56, 78 }, { 57, 79 }, { 4, 80 } };
    }
    if ( par_size() == 4 )
    {
        tGoldNumVertex = { 28, 38, 38, 19 };

        tGoldCoords = {
            { 0.0, 0.0, 0.0 },
            { 1.0, 0.0, 0.0 },
            { 0.0, 1.0, 0.0 },
            { 1.0, 1.0, 0.0 },
            { 0.0, 0.0, 1.0 },
            { 1.0, 0.0, 1.0 },
            { 0.0, 1.0, 1.0 },
            { 1.0, 1.0, 1.0 },
            { 0.0, 0.0, 2.0 },
            { 1.0, 0.0, 2.0 },
            { 0.0, 1.0, 2.0 },
            { 1.0, 1.0, 2.0 },
            { 0.0, 0.0, 3.0 },
            { 1.0, 0.0, 3.0 },
            { 0.0, 1.0, 3.0 },
            { 1.0, 1.0, 3.0 },
            { 0.0, 0.0, 4.0 },
            { 1.0, 0.0, 4.0 },
            { 0.0, 1.0, 4.0 },
            { 1.0, 1.0, 4.0 },
            { 0.5, 0.5, 1.0 },
            { 0.5, 0.5, 2.0 },
            { 0.5, 0.0, 1.5 },
            { 1.0, 0.5, 1.5 },
            { 0.5, 1.0, 1.5 },
            { 0.0, 0.5, 1.5 },
            { 0.5, 0.5, 1.5 },
            { 0.5, 0.0, 2.5 },
            { 1.0, 0.5, 2.5 },
            { 0.5, 1.0, 2.5 },
            { 0.0, 0.5, 2.5 },
            { 0.5, 0.5, 3.0 },
            { 0.5, 0.5, 2.5 },
            { 0.8333333333333331, 0.0, 1.833333333333333 },
            { 1.0, 0.0, 1.8 },
            { 0.8333333333333331, 0.1666666666666667, 1.833333333333333 },
            { 1.0, 0.8, 1.8 },
            { 1.0, 1.0, 1.8 },
            { 0.8333333333333331, 0.8333333333333331, 1.833333333333333 },
            { 1.0, 0.2, 1.8 },
            { 0.8333333333333331, 1.0, 1.833333333333333 },
            { 0.5, 0.5, 1.9 },
        };

        tGoldVertexMap = { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 }, { 5, 4 }, { 6, 5 }, { 7, 6 }, { 8, 7 }, { 9, 8 }, { 10, 9 }, { 11, 10 }, { 12, 11 }, { 13, 12 }, { 14, 13 }, { 15, 14 }, { 16, 15 }, { 17, 16 }, { 18, 17 }, { 19, 18 }, { 20, 19 }, { 21, 20 }, { 28, 21 }, { 29, 22 }, { 30, 23 }, { 31, 24 }, { 32, 25 }, { 33, 26 }, { 41, 27 }, { 42, 28 }, { 43, 29 }, { 44, 30 }, { 45, 31 }, { 46, 32 }, { 70, 33 }, { 71, 34 }, { 72, 35 }, { 73, 36 }, { 74, 37 }, { 75, 38 }, { 76, 39 }, { 77, 40 }, { 78, 41 } };

        tGoldNumCells = { 55, 80, 80, 26 };

        tGoldCellConn = {
            { 1, 2, 4, 3, 5, 6, 8, 7 },
            { 5, 6, 8, 7, 9, 10, 12, 11 },
            { 5, 29, 6, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 70, 10, 71, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 70, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 9, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 30, 8, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 73, 12, 74, 75, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 72, 75, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 71, 72, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 31, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 74, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 77, 75, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 31, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 7, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 7, 11, 32, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 32, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 32, 9, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 6, 21, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 8, 21, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 7, 21, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 5, 21, 7, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 28, 10, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 72, 75, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 78, 11, 75, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 78, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 29, 70, 71, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 29, 71, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 29, 6, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 70, 29, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 72, 29, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 30, 73, 74, 75, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 30, 74, 75, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 30, 8, 75, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 10, 75, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 73, 12, 75, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 30, 73, 75, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 33, 30, 75, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 72, 33, 75, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 71, 6, 72, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 33, 72, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 6, 30, 33, 76, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 74, 8, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 33, 75, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 8, 31, 33, 77, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 75, 11, 77, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 31, 77, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 78, 10, 72, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 78, 72, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 72, 10, 75, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 75, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 28, 12, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 28, 11, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 75, 78, 11, 33, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 28, 78, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 12, 11, 13, 14, 16, 15 },
            { 9, 41, 10, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 41, 14, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 41, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 13, 41, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 42, 12, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 42, 16, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 16, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 14, 42, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 43, 11, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 16, 43, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 15, 43, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 43, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 11, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 11, 15, 44, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 44, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 44, 13, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 10, 28, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 10, 12, 28, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 12, 11, 28, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 9, 28, 11, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 45, 14, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 14, 45, 16, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 16, 45, 15, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 15, 45, 46, 2147483647, 2147483647, 2147483647, 2147483647 },
            { 13, 14, 16, 15, 17, 18, 20, 19 },
        };

        tGoldCellMap = { { 1, 0 }, { 2, 1 }, { 58, 2 }, { 59, 3 }, { 60, 4 }, { 61, 5 }, { 62, 6 }, { 63, 7 }, { 64, 8 }, { 65, 9 }, { 66, 10 }, { 67, 11 }, { 68, 12 }, { 69, 13 }, { 70, 14 }, { 71, 15 }, { 72, 16 }, { 73, 17 }, { 74, 18 }, { 75, 19 }, { 76, 20 }, { 77, 21 }, { 78, 22 }, { 79, 23 }, { 80, 24 }, { 81, 25 }, { 82, 26 }, { 83, 27 }, { 84, 28 }, { 85, 29 }, { 86, 30 }, { 87, 31 }, { 88, 32 }, { 89, 33 }, { 90, 34 }, { 91, 35 }, { 92, 36 }, { 93, 37 }, { 94, 38 }, { 95, 39 }, { 96, 40 }, { 97, 41 }, { 98, 42 }, { 99, 43 }, { 100, 44 }, { 101, 45 }, { 102, 46 }, { 103, 47 }, { 104, 48 }, { 105, 49 }, { 106, 50 }, { 107, 51 }, { 108, 52 }, { 109, 53 }, { 110, 54 }, { 3, 55 }, { 135, 56 }, { 136, 57 }, { 137, 58 }, { 138, 59 }, { 139, 60 }, { 140, 61 }, { 141, 62 }, { 142, 63 }, { 143, 64 }, { 144, 65 }, { 145, 66 }, { 146, 67 }, { 147, 68 }, { 148, 69 }, { 149, 70 }, { 150, 71 }, { 151, 72 }, { 152, 73 }, { 153, 74 }, { 154, 75 }, { 155, 76 }, { 156, 77 }, { 157, 78 }, { 158, 79 }, { 4, 80 } };
    }

    CHECK( check_vertices( &tXTKModel, tGoldNumVertex, tGoldVertexMap, tGoldCoords ) );
    CHECK( check_cells( &tXTKModel, tGoldNumCells, tGoldCellMap, tGoldCellConn ) );
    CHECK( interpolated_coordinate_check( tCutMesh ) );

    moris::Matrix< moris::DDRMat > tIsoContourThreshold = { { 0.0 } };
    moris::Matrix< moris::DDRMat > tIsoContourTolerance = { { 1e-12 } };
    CHECK( verify_interface_vertices( &tXTKModel, tIsoContourThreshold, tIsoContourTolerance ) );
}
}// namespace xtk
