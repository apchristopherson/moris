#include "cl_Matrix.hpp"
#include "linalg_typedefs.hpp"
#include "fn_trans.hpp"

using namespace moris;

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_Y()
{
    // define reference value for unit test
    Matrix< DDRMat > tY = { 
            { 1.206142508191612e+02},
            { 7.992889626224392e-01},
            {-1.012471582404726e+01},
            { 9.890154404869988e+01} };

    // return value
    return tY;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_dYdt()
{
    // define reference value for unit test
    Matrix< DDRMat > tdYdt = { 
            { 2.859515995599841e+00},
            { 6.924847334187857e-02},
            {-7.665013118703592e-01},
            {-1.237603880985618e-01} };

    // return value
    return tdYdt;
}

//------------------------------------------------------------------------------

const Cell< Matrix< DDRMat > > get_reference_dYdx()
{
    // define reference value for unit test
    Matrix< DDRMat > tdYdx1 = { 
            { 1.398057507980141e+01},
            { 3.113500051963649e-01},
            {-5.490507213519273e+00},
            {-2.037398178099248e-01} };
    Matrix< DDRMat > tdYdx2 = { 
            {-1.001623920769983e+02},
            {-3.165771292235487e+01},
            {-1.845009993258474e+00},
            {-1.645892684136180e+00} };

    Cell< Matrix< DDRMat > > tdYdx = { tdYdx1, tdYdx2 };

    // return value
    return tdYdx;
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_C()
{
    // define reference value for unit test
    Matrix< DDRMat > tC = { 
            { 0.0, 0.0, 0.0,                    0.0 },
            { 0.0, 0.0, 0.0,                    0.0 },
            { 0.0, 0.0, 0.0,                    0.0 },
            { 0.0, 0.0, 0.0, -1.314438528239630e-02 } };

    // return value
    return tC;
}

//------------------------------------------------------------------------------

const Cell< Matrix< DDRMat > > get_reference_A()
{
    // define reference value for unit test
    Matrix< DDRMat > tA0 = { 
            {  4.212944000768045e-03,                   0.0,                    0.0, -5.137847839316894e-03 },
            {  3.367359639960320e-03, 5.081410843957174e-01,                    0.0, -4.106625069599541e-03 },
            { -4.265486079040122e-02,                   0.0,  5.081410843957174e-01,  5.201924932027881e-02 },
            {  2.592279918705255e+00, 4.061515602124942e-01, -5.144784078029855e+00, -2.649812484199231e-01 } };
    Matrix< DDRMat > tA1 = { 
            {  3.367359639960320e-03,  5.081410843957174e-01,                    0.0, -4.106625069599541e-03 },
            {  1.002691493393400e+00,  8.123031204249883e-01,                    0.0, -3.282380091759519e-03 },
            { -3.409355943196434e-02, -5.144784078029855e+00,  4.061515602124942e-01,  4.157841182560367e-02 },
            {  2.871269689671343e+00,  4.336047835865812e+02, -4.112169128644925e+00, -2.117965871639592e-01 } };
    Matrix< DDRMat > tA2 = { 
            { -4.265486079040122e-02,                    0.0,  5.081410843957174e-01,  5.201924932027881e-02 },
            { -3.409355943196434e-02, -5.144784078029855e+00,  4.061515602124942e-01,  4.157841182560367e-02 },
            {  1.431868344017108e+00,                    0.0, -1.028956815605971e+01, -5.266801167480867e-01 },
            { -3.637081333732231e+01, -4.112169128644925e+00,  4.853696278934868e+02,  2.682859838952995e+00 } };

    Cell< Matrix< DDRMat > > tA = { tA0, tA1, tA2 };

    // return value
    return tA;
}

//------------------------------------------------------------------------------

const Cell< Matrix< DDRMat > > get_reference_K()
{
    // define reference value for unit test
    Matrix< DDRMat > tK11 = { 
            { 0.0,                    0.0,                    0.0,                   0.0 },
            { 0.0,  1.600000000000000e+00,                    0.0,                   0.0 },
            { 0.0,                    0.0,  1.200000000000000e+00,                   0.0 },
            { 0.0,  1.278862340195903e+00, -1.214965898885672e+01, 8.000000000000000e-01 } };
    Matrix< DDRMat > tK12 = { 
            { 0.0,                    0.0,                    0.0,                   0.0 },
            { 0.0,                    0.0, -8.000000000000000e-01,                   0.0 },
            { 0.0,  1.200000000000000e+00,                    0.0,                   0.0 },
            { 0.0, -1.214965898885672e+01, -6.394311700979514e-01,                   0.0 } };
    Matrix< DDRMat > tK21 = { 
            { 0.0,                    0.0,                    0.0,                   0.0 },
            { 0.0,                    0.0,  1.200000000000000e+00,                   0.0 },
            { 0.0, -8.000000000000000e-01,                    0.0,                   0.0 },
            { 0.0,  8.099772659237811e+00,  9.591467551469270e-01,                   0.0 } };
    Matrix< DDRMat > tK22 = { 
            { 0.0,                    0.0,                    0.0,                   0.0 },
            { 0.0,  1.200000000000000e+00,                    0.0,                   0.0 },
            { 0.0,                    0.0,  1.600000000000000e+00,                   0.0 },
            { 0.0,  9.591467551469270e-01, -1.619954531847562e+01, 8.000000000000000e-01 } };


    Cell< Matrix< DDRMat > > tK = { tK11, tK12, tK21, tK22 };

    // return value
    return tK;
}

//------------------------------------------------------------------------------

const Cell< Matrix< DDRMat > > get_reference_Kiji()
{
    // define reference value for unit test
    Matrix< DDRMat > tKi1i = { 
            { 0.0,                   0.0,                    0.0, 0.0 },
            { 0.0,                   0.0,                    0.0, 0.0 },
            { 0.0,                   0.0,                    0.0, 0.0 },
            { 0.0, 1.974168002920963e+00, -4.457786416304896e+01, 0.0 } };

    Matrix< DDRMat > tKi2i = { 
            { 0.0,                    0.0,                    0.0, 0.0 },
            { 0.0,                    0.0,                    0.0, 0.0 },
            { 0.0,                    0.0,                    0.0, 0.0 },
            { 0.0, -4.457786416304896e+01, -3.201095993370650e+00, 0.0 } };

    Cell< Matrix< DDRMat > > tKiji = { tKi1i, tKi2i };

    // return value
    return tKiji;
}

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_LY()
{
    // define reference value for unit test
    Matrix< DDRMat > tLY = { 
            { 3.468076289271243e+00},
            { 3.648635834352593e+01},
            {-2.169036262134864e+02},
            { 2.195398195309295e+03} };

    // return value
    return tLY;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_LW()
{
    // define reference value for unit test
    Matrix< DDRMat > tLW = { 
            {  1.399511542362250e-03,  5.328349612743821e-03, -4.326105665889187e-02,  1.159044833478170e+00 },
            { -2.716892839718801e-04,  3.945127218004181e-04,  8.499376792654166e-03, -2.248880334998473e-01 },
            {  6.719520174337378e-04, -4.196322980855907e-04, -2.158543750962614e-02,  5.623609382085745e-01 },
            { -3.438959975524165e-03, -9.333180815852930e-03,  1.096249496253119e-01, -2.878694361368342e+00 },
            {  1.348423785043278e-03, -3.743626203290239e-03, -4.230960763394938e-02,  1.115995220008803e+00 },
            { -9.159663518470549e-05, -6.857199276290682e-03,  9.960904187398357e-03, -1.532447467959500e-01 },
            { -3.340397059671129e-03,  4.871231692976805e-03,  1.075105138257961e-01, -2.795452449580933e+00 },
            {  1.907080466307710e-04, -4.653736271163184e-02, -4.764592192035286e-02,  5.428784980907384e-01 },
            {  5.228018480475255e-04,  5.389165039194429e-02, -5.032596300091079e-02,  8.203715880978919e-01 },
            {  1.790918554319427e-02,  7.487004014068416e-02, -5.997940142649776e-01,  1.530503462833338e+01 },
            { -3.469018663874132e-03,  6.025903283737390e-03,  1.178142281600417e-01, -2.964727124057102e+00 },
            {  8.978931363568442e-03, -6.585232813342394e-03, -3.035441570311843e-01,  7.666724129387883e+00 },
            { -4.599229008584736e-02, -1.314760266055408e-01,  1.541720981502065e+00, -3.927018939298267e+01 },
            {  1.720747570956719e-02, -5.560033201010407e-02, -5.864436016085638e-01,  1.470619114559444e+01 },
            { -6.187902113321949e-03, -1.025309670222566e-01,  1.925943790158348e-01, -5.201138613078481e+00 },
            { -4.462637845735631e-02,  7.280751857980396e-02,  1.511830885851403e+00, -3.810470772901326e+01 },
            {  2.739003152353676e-02, -6.497221726980016e-01, -9.349097998732204e-01,  2.297458028676132e+01 },
            {  3.179921089536741e-02,  7.946165260307058e-01, -9.697366594588281e-01,  2.673986118241539e+01 },
            {  2.139139553793323e-03, -1.819962665467248e-01, -3.735882525142698e-02,  5.309819706919880e-01 },
            {  3.108151488417649e-04,  4.158398319760920e-02, -5.428205378412468e-03,  5.762141247878173e-01 },
            { -4.861467712653246e-04,  1.452401558309517e-01,  1.078827302304689e-02, -1.014586394695072e+00 },
            { -3.345833661061352e-03, -7.794923754486996e-01,  7.424870257038155e-02, -5.348722356149127e-01 },
            { -2.449954702635088e-03, -1.976518491557740e-01,  4.278703062983945e-02, -3.695455961728040e+00 },
            { -3.447222559881392e-03, -1.957783178211993e-01,  3.131726400841713e-02, -2.641264657887481e+00 },
            {  3.831980432326676e-03, -7.391225549262987e-01, -8.503697559342845e-02,  6.412432596703395e+00 },
            { -2.372500232388958e-02,  6.752883341227741e-01,  2.155364640579296e-01, -2.137075791328368e+01 },
            {  2.717222488377097e-02,  8.689709733218492e-01, -2.468537280663468e-01,  2.144720021373135e+01 },
            {  3.077069973533472e-02, -2.885981280823467e+00, -5.373923324628344e-01,  7.423734019371965e+00 },
            {  4.470956371800771e-03,  6.511346015161523e-01, -7.808264659716396e-02,  8.330952901809503e+00 },
            { -6.993034325124285e-03,  2.006381092323373e+00,  1.551851581007515e-01, -1.466065030806994e+01 },
            { -4.812853035526713e-02, -1.079346380858550e+01,  1.068039029281642e+00, -7.358842114433965e+00 },
            { -3.524165610713550e-02, -3.107180293110850e+00,  6.154749790599983e-01, -5.336875251222730e+01 },
            { -4.958697066906310e-02, -3.403625769878099e+00,  4.504867976595386e-01, -3.846310252192417e+01 },
            {  5.512156468039141e-02, -1.021901669420218e+01, -1.223224187382394e+00,  9.257046452568513e+01 },
            { -3.412750334282579e-01,  1.268651461314396e+01,  3.100409136833295e+00, -3.050340454753947e+02 },
            {  3.908620040973209e-01,  1.542819545704212e+01, -3.550895934492834e+00,  3.108503497424782e+02 },
            { -1.478253554258957e-02, -2.751616266005608e-02, -1.537060265956043e-01, -9.451153244190586e+00 },
            {  2.921099837757220e-03,  5.351253645689908e-05,  3.429538701979358e-02,  1.887927058546353e+00 },
            { -7.511399582804281e-03, -1.376036651748834e-04,  2.465955077650666e-01, -8.216792112097686e+00 },
            {  3.801223425237318e-02,  7.075584684014420e-02, -1.278969244838822e+00,  4.144293533287127e+01 },
            { -1.456190068374495e-02,  6.342768992549479e-03, -1.633696188307101e-01, -9.562076115777607e+00 },
            {  4.590299745047060e-03,  8.409112871798426e-05, -2.761275456492823e-01,  5.962840465568891e+00 },
            {  3.744488747248701e-02, -1.630997740941295e-02, -1.241177063577467e+00,  4.119158355476848e+01 },
            { -2.322969870978361e-02, -4.323968418008813e-02,  1.177224653692452e+00, -3.159260851219160e+01 },
            { -2.288298678874207e-02,  9.967208416863467e-03,  1.292276033589061e+00, -2.798781065747622e+01 },
            { -2.126410881895577e-01, -3.958094167254220e-01, -2.479037059988119e+00, -1.332374263035707e+02 },
            {  4.201889766620002e-02,  7.697572551877022e-04,  5.462909488044969e-01,  2.662084906756141e+01 },
            { -1.080485939988001e-01, -1.979375799054091e-03,  3.464338847067949e+00, -1.173566355567384e+02 },
            {  5.467913696302912e-01,  1.017795643008228e+00, -1.797824646827419e+01,  5.918960579583428e+02 },
            { -2.094673406046389e-01,  9.123829243128866e-02, -2.614043595358007e+00, -1.348735132987843e+02 },
            {  6.602969633260003e-02,  1.209618543866389e-03, -4.559418508635908e+00,  9.172072818321199e+01 },
            {  5.386303044119286e-01, -2.346127519661708e-01, -1.744087770326129e+01,  5.883438119490875e+02 },
            { -3.341502814407335e-01, -6.219862262828061e-01,  1.990667551772317e+01, -4.845457881474048e+02 },
            { -3.291629638072897e-01,  1.433744595348822e-01,  2.151727593934740e+01, -4.322429296217269e+02 },
            { -1.706758350624664e-03, -1.364193111517973e-03,  1.728044328039434e-02, -3.236077206079268e-01 },
            {  3.313355697028011e-04,  2.648328637876668e-04, -3.354678485639665e-03,  6.586473065757388e-02 },
            { -8.194714243216067e-04, -6.549944646447496e-04,  8.296915297183521e-03,  1.771661710814589e-03 },
            {  4.193944442775165e-03,  3.352173502961906e-03, -4.246249566494080e-02, -2.414957447356959e-02 },
            { -1.644454858456485e-03, -1.314394617895114e-03,  1.664963812734577e-02, -3.224217764385856e-01 },
            {  1.117056324714124e-04,  8.928507909715864e-05, -1.130987784718517e-03, -1.086002111165608e-01 },
            {  4.073743162112527e-03,  3.256097946035177e-03, -4.124549185654504e-02, -1.808950920703479e-02 },
            { -2.325758246830777e-04, -1.858952896419954e-04,  2.354764132459598e-03,  4.419152853201791e-01 },
            { -6.375770351782909e-04, -5.096082870395466e-04,  6.455286297118781e-03,  4.757350494116994e-01 },
            { -2.184094311015081e-02, -1.745722476120816e-02,  2.211333423194600e-01, -4.515199908975918e+00 },
            {  4.230602173559961e-03,  3.381473622572977e-03, -4.283364477189128e-02,  9.198190653083961e-01 },
            { -1.095015340751612e-02, -8.752336757650130e-03,  1.108671914808236e-01,  6.868479818216568e-02 },
            {  5.608937317935569e-02,  4.483161690267008e-02, -5.678889641899149e-01, -5.660011593539646e-01 },
            { -2.098518088025384e-02, -1.677322345622234e-02,  2.124689929288002e-01, -4.500226717746664e+00 },
            {  7.546385495995117e-03,  6.031742634642959e-03, -7.640500864566252e-02, -1.255844102265673e+00 },
            {  5.442359122073931e-02,  4.350017576901242e-02, -5.510233952340990e-01, -4.755664838436792e-01 },
            { -3.340320076800684e-02, -2.669880969012925e-02,  3.381979153896666e-01,  4.806575241889330e+00 },
            { -3.878036521752024e-02, -3.099671788483108e-02,  3.926401773801594e-01,  5.316196946267023e+00 } };

    // transpose
    tLW = trans( tLW );

    // return value
    return tLW;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_GLSTestFunc()
{
    // define reference value for unit test
    Matrix< DDRMat > tGLSTestFunc = { 
            {  1.399511542362250e-03,  2.139139553793323e-03, -1.478253554258957e-02, -1.706758350624664e-03 },
            { -2.716892839718801e-04,  3.108151488417649e-04,  2.921099837757220e-03,  3.313355697028011e-04 },
            {  6.719520174337378e-04, -4.861467712653246e-04, -7.511399582804281e-03, -8.194714243216067e-04 },
            { -3.438959975524165e-03, -3.345833661061352e-03,  3.801223425237318e-02,  4.193944442775165e-03 },
            {  1.348423785043278e-03, -2.449954702635088e-03, -1.456190068374495e-02, -1.644454858456485e-03 },
            { -9.159663518470549e-05, -3.447222559881392e-03,  4.590299745047060e-03,  1.117056324714124e-04 },
            { -3.340397059671129e-03,  3.831980432326676e-03,  3.744488747248701e-02,  4.073743162112527e-03 },
            {  1.907080466307710e-04, -2.372500232388958e-02, -2.322969870978361e-02, -2.325758246830777e-04 },
            {  5.228018480475255e-04,  2.717222488377097e-02, -2.288298678874207e-02, -6.375770351782909e-04 },
            {  1.790918554319427e-02,  3.077069973533472e-02, -2.126410881895577e-01, -2.184094311015081e-02 },
            { -3.469018663874132e-03,  4.470956371800771e-03,  4.201889766620002e-02,  4.230602173559961e-03 },
            {  8.978931363568442e-03, -6.993034325124285e-03, -1.080485939988001e-01, -1.095015340751612e-02 },
            { -4.599229008584736e-02, -4.812853035526713e-02,  5.467913696302912e-01,  5.608937317935569e-02 },
            {  1.720747570956719e-02, -3.524165610713550e-02, -2.094673406046389e-01, -2.098518088025384e-02 },
            { -6.187902113321949e-03, -4.958697066906310e-02,  6.602969633260003e-02,  7.546385495995117e-03 },
            { -4.462637845735631e-02,  5.512156468039141e-02,  5.386303044119286e-01,  5.442359122073931e-02 },
            {  2.739003152353676e-02, -3.412750334282579e-01, -3.341502814407335e-01, -3.340320076800684e-02 },
            {  3.179921089536741e-02,  3.908620040973209e-01, -3.291629638072897e-01, -3.878036521752024e-02 },
            {  5.328349612743821e-03, -1.819962665467248e-01, -2.751616266005608e-02, -1.364193111517973e-03 },
            {  3.945127218004181e-04,  4.158398319760920e-02,  5.351253645689908e-05,  2.648328637876668e-04 },
            { -4.196322980855907e-04,  1.452401558309517e-01, -1.376036651748834e-04, -6.549944646447496e-04 },
            { -9.333180815852930e-03, -7.794923754486996e-01,  7.075584684014420e-02,  3.352173502961906e-03 },
            { -3.743626203290239e-03, -1.976518491557740e-01,  6.342768992549479e-03, -1.314394617895114e-03 },
            { -6.857199276290682e-03, -1.957783178211993e-01,  8.409112871798426e-05,  8.928507909715864e-05 },
            {  4.871231692976805e-03, -7.391225549262987e-01, -1.630997740941295e-02,  3.256097946035177e-03 },
            { -4.653736271163184e-02,  6.752883341227741e-01, -4.323968418008813e-02, -1.858952896419954e-04 },
            {  5.389165039194429e-02,  8.689709733218492e-01,  9.967208416863467e-03, -5.096082870395466e-04 },
            {  7.487004014068416e-02, -2.885981280823467e+00, -3.958094167254220e-01, -1.745722476120816e-02 },
            {  6.025903283737390e-03,  6.511346015161523e-01,  7.697572551877022e-04,  3.381473622572977e-03 },
            { -6.585232813342394e-03,  2.006381092323373e+00, -1.979375799054091e-03, -8.752336757650130e-03 },
            { -1.314760266055408e-01, -1.079346380858550e+01,  1.017795643008228e+00,  4.483161690267008e-02 },
            { -5.560033201010407e-02, -3.107180293110850e+00,  9.123829243128866e-02, -1.677322345622234e-02 },
            { -1.025309670222566e-01, -3.403625769878099e+00,  1.209618543866389e-03,  6.031742634642959e-03 },
            {  7.280751857980396e-02, -1.021901669420218e+01, -2.346127519661708e-01,  4.350017576901242e-02 },
            { -6.497221726980016e-01,  1.268651461314396e+01, -6.219862262828061e-01, -2.669880969012925e-02 },
            {  7.946165260307058e-01,  1.542819545704212e+01,  1.433744595348822e-01, -3.099671788483108e-02 },
            { -4.326105665889187e-02, -3.735882525142698e-02, -1.537060265956043e-01,  1.728044328039434e-02 },
            {  8.499376792654166e-03, -5.428205378412468e-03,  3.429538701979358e-02, -3.354678485639665e-03 },
            { -2.158543750962614e-02,  1.078827302304689e-02,  2.465955077650666e-01,  8.296915297183521e-03 },
            {  1.096249496253119e-01,  7.424870257038155e-02, -1.278969244838822e+00, -4.246249566494080e-02 },
            { -4.230960763394938e-02,  4.278703062983945e-02, -1.633696188307101e-01,  1.664963812734577e-02 },
            {  9.960904187398357e-03,  3.131726400841713e-02, -2.761275456492823e-01, -1.130987784718517e-03 },
            {  1.075105138257961e-01, -8.503697559342845e-02, -1.241177063577467e+00, -4.124549185654504e-02 },
            { -4.764592192035286e-02,  2.155364640579296e-01,  1.177224653692452e+00,  2.354764132459598e-03 },
            { -5.032596300091079e-02, -2.468537280663468e-01,  1.292276033589061e+00,  6.455286297118781e-03 },
            { -5.997940142649776e-01, -5.373923324628344e-01, -2.479037059988119e+00,  2.211333423194600e-01 },
            {  1.178142281600417e-01, -7.808264659716396e-02,  5.462909488044969e-01, -4.283364477189128e-02 },
            { -3.035441570311843e-01,  1.551851581007515e-01,  3.464338847067949e+00,  1.108671914808236e-01 },
            {  1.541720981502065e+00,  1.068039029281642e+00, -1.797824646827419e+01, -5.678889641899149e-01 },
            { -5.864436016085638e-01,  6.154749790599983e-01, -2.614043595358007e+00,  2.124689929288002e-01 },
            {  1.925943790158348e-01,  4.504867976595386e-01, -4.559418508635908e+00, -7.640500864566252e-02 },
            {  1.511830885851403e+00, -1.223224187382394e+00, -1.744087770326129e+01, -5.510233952340990e-01 },
            { -9.349097998732204e-01,  3.100409136833295e+00,  1.990667551772317e+01,  3.381979153896666e-01 },
            { -9.697366594588281e-01, -3.550895934492834e+00,  2.151727593934740e+01,  3.926401773801594e-01 },
            {  1.159044833478170e+00,  5.309819706919880e-01, -9.451153244190586e+00, -3.236487317820597e-01 },
            { -2.248880334998473e-01,  5.762141247878173e-01,  1.887927058546353e+00,  6.587283466204327e-02 },
            {  5.623609382085745e-01, -1.014586394695072e+00, -8.216792112097686e+00,  1.758986216644521e-03 },
            { -2.878694361368342e+00, -5.348722356149127e-01,  4.144293533287127e+01, -2.408542879095136e-02 },
            {  1.115995220008803e+00, -3.695455961728040e+00, -9.562076115777607e+00, -3.224621755056419e-01 },
            { -1.532447467959500e-01, -2.641264657887481e+00,  5.962840465568891e+00, -1.086900918934031e-01 },
            { -2.795452449580933e+00,  6.412432596703395e+00,  4.119158355476848e+01, -1.802632092266460e-02 },
            {  5.428784980907384e-01, -2.137075791328368e+01, -3.159260851219160e+01,  4.423701365241992e-01 },
            {  8.203715880978919e-01,  2.144720021373135e+01, -2.798781065747622e+01,  4.761831117917789e-01 },
            {  1.530503462833338e+01,  7.423734019371965e+00, -1.332374263035707e+02, -4.515789838942293e+00 },
            { -2.964727124057102e+00,  8.330952901809503e+00,  2.662084906756141e+01,  9.199356382957634e-01 },
            {  7.666724129387883e+00, -1.466065030806994e+01, -1.173566355567384e+02,  6.850246607371932e-02 },
            { -3.927018939298267e+01, -7.358842114433965e+00,  5.918960579583428e+02, -5.650784483809178e-01 },
            {  1.470619114559444e+01, -5.336875251222730e+01, -1.348735132987843e+02, -4.500807842788167e+00 },
            { -5.201138613078481e+00, -3.846310252192417e+01,  9.172072818321199e+01, -1.257137002671020e+00 },
            { -3.810470772901326e+01,  9.257046452568513e+01,  5.883438119490875e+02, -4.746575446762003e-01 },
            {  2.297458028676132e+01, -3.050340454753947e+02, -4.845457881474048e+02,  4.813118101516389e+00 },
            {  2.673986118241539e+01,  3.108503497424782e+02, -4.322429296217269e+02,  5.322642151272782e+00 } };

    // return value
    return tGLSTestFunc;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_A0inv()
{
    // define reference value for unit test
    Matrix< DDRMat > tA0inv = { 
            {  2.171552281336487e+01, -3.365427211041849e-01, 4.263038241704111e+00, 4.210526315789473e-01 },
            { -1.572966617279049e+00,  1.967957385672136e+00,                   0.0,                   0.0 },
            {  1.992500928376536e+01,                    0.0, 1.967957385672136e+00,                   0.0 },
            { -1.768276809382282e+02, -2.759590556629911e-01, 3.495615663818484e+00, 3.452556816968660e-01 } };

    // return value
    return tA0inv;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_G()
{
    // define reference value for unit test
    Matrix< DDRMat > tG = { 
            { 4.162330905306972e-01,                   0.0 },
            {                   0.0, 8.163265306122449e+00 } };

    // return value
    return tG;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_M()
{
    // define reference value for unit test
    Matrix< DDRMat > tM = { 
            { -6.487320759027924e+02, -2.221986705839816e+00, -1.287267530820165e+02,  3.612420377538167e+00 },
            { -1.607292588703621e+03,  1.378248443743596e+03, -1.000533281552967e+02,  3.167528169920252e+00 },
            {  4.632933852523961e+04,  7.812799479950380e+01,  4.880307891233600e+03, -1.061753541139243e+02 },
            { -1.588155105119269e+06, -2.029621509033905e+03, -1.374285478873968e+05,  4.629356836281342e+03 } };

    // return value
    return tM;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_Tau()
{
    // define reference value for unit test
    Matrix< DDRMat > tTau = { 
            {  2.400844598669224e+00, -9.557624760782212e-03,  2.842202459576695e-01,  9.668675824854971e-03 },
            { -4.380725821983964e-02,  5.297575746739566e-02, -1.664085895278825e-04, -4.481197673591615e-06 },
            {  4.465480931811694e-01, -4.859327703857989e-04,  4.629687882929637e-02,  4.565245498412208e-04 },
            { -5.691197830243650e+00, -9.006887802501067e-03,  1.536285624466695e-01,  1.071413573046514e-02 } };

    // return value
    return tTau;
}

//------------------------------------------------------------------------------

const Cell< Matrix< DDRMat > > get_reference_dMdDof()
{
    // define reference value for unit test
    Matrix< DDRMat > tdMi1dDof = { 
            {                    0.0, -1.657094043287682e-02,  3.609225859463563e-01, -3.802541974218456e+00 },
            {                    0.0,  3.274497211287036e-03, -7.132003195347160e-02,  7.514005098755032e-01 },
            {                    0.0, -5.121649484320749e-03,  1.115518448503017e-01, -1.175267464164249e+00 },
            {                    0.0,  2.591865042065349e-02, -5.645199421212240e-01,  5.947565651982714e+00 },
            {                    0.0, -1.632361296372940e-02,  3.555356816785002e-01, -3.745787616394300e+00 },
            {                    0.0, -3.631715088881985e-02,  7.910039907566850e-01, -8.333714745891946e+00 },
            {                    0.0,  2.553180489198701e-02, -5.560942713432953e-01,  5.858796015385957e+00 },
            {                    0.0,  1.837867938919065e-01, -4.002959589586861e+00,  4.217364735042288e+01 },
            {                    0.0,  1.810437074159079e-01, -3.943213924070639e+00,  4.154418992728223e+01 },
            {                    0.0, -2.383666046883050e-01,  5.191732582459125e+00, -5.469810378298856e+01 },
            {                    0.0,  4.710238296235968e-02, -1.025911228869169e+00,  1.080860733436301e+01 },
            {                    0.0, -7.367295796676768e-02,  1.604630383615879e+00, -1.690577044605497e+01 },
            {                    0.0,  3.728298175894001e-01, -8.120402244359145e+00,  8.555344437852058e+01 },
            {                    0.0, -2.348088941705691e-01,  5.114244036452273e+00, -5.388171417428724e+01 },
            {                    0.0, -5.224082474007163e-01,  1.137828817473078e+01, -1.198772813447534e+02 },
            {                    0.0,  3.672651934462747e-01, -7.999202210861246e+00,  8.427652729824416e+01 },
            {                    0.0,  2.643702342906656e+00, -5.758103409636485e+01,  6.066516965022367e+02 },
            {                    0.0,  2.604244098982675e+00, -5.672161567701611e+01,  5.975971935693675e+02 },
            { -6.932715509820288e-03,  6.269542725350712e+00,  2.227443057207732e-01,  4.074071126814247e-01 },
            {  1.369937795353710e-03, -1.238891676266907e+00, -4.401534184901505e-02, -8.050559711668871e-02 },
            { -2.142723218373751e-03,  1.937753647494393e+00,  6.884450904589534e-02,  1.259190108748208e-01 },
            {  1.084347810510353e-02, -9.806207852471626e+00, -3.483949397171067e-01, -6.372265095786386e-01 },
            { -6.829242144002075e-03,  6.175967460793238e+00,  2.194197638443437e-01,  4.013264095070751e-01 },
            { -1.519385554846842e-02,  1.374043495496024e+01,  4.881701550527124e-01,  8.928802589305476e-01 },
            {  1.068163514831094e-02, -9.659846541240706e+00, -3.431950152437170e-01, -6.277156661520917e-01 },
            {  7.689011747255228e-02, -6.953492840843516e+01, -2.470436845266757e+00, -4.518515249739437e+00 },
            {  7.574250377893210e-02, -6.849709365607046e+01, -2.433564653546358e+00, -4.451074723623924e+00 },
            { -9.972444617972259e-02,  9.018496074158332e+01,  3.204091166906506e+00,  5.860394620878954e+00 },
            {  1.970602828701105e-02, -1.782098026630089e+01, -6.331437635204473e-01, -1.158042050832368e+00 },
            { -3.082224937199165e-02,  2.787384092934242e+01,  9.903017839678790e-01,  1.811296541045499e+00 },
            {  1.559792619734123e-01, -1.410585283393995e+02, -5.011527209776842e+00, -9.166258253169646e+00 },
            { -9.823602160987599e-02,  8.883891655141043e+01,  3.156268910684021e+00,  5.772926044447925e+00 },
            { -2.185577682741226e-01,  1.976508720444281e+02,  7.022139922681324e+00,  1.284373910923172e+01 },
            {  1.536512132872419e-01, -1.389531771701548e+02, -4.936728296198084e+00, -9.029448428495474e+00 },
            {  1.106034766720560e+00, -1.000233200952106e+03, -3.553628385114489e+01, -6.499710397702114e+01 },
            {  1.089526785127716e+00, -9.853043472065521e+02, -3.500589155485914e+01, -6.402699794751335e+01 },
            { -4.016342470794413e-01, -7.244043982725246e-01,  2.136653039178672e+01, -1.001902039978733e+03 },
            {  7.936485121929079e-02,  1.431457792993611e-01, -4.222128760053664e+00,  1.979806426305281e+02 },
            { -1.241347672917112e-01, -2.238946804425905e-01,  6.603842419571114e+00, -3.096620307810824e+02 },
            {  6.281971556883569e-01,  1.133042776785231e+00, -3.341944497176897e+01,  1.567077549710326e+03 },
            { -3.956397060782556e-01, -7.135923923281585e-01,  2.104762695310334e+01, -9.869482781880059e+02 },
            { -8.802283498866796e-01, -1.587616824956551e+00,  4.682724624786790e+01, -2.195785309174948e+03 },
            {  6.188210787377844e-01,  1.116131690564556e+00, -3.292064728562317e+01,  1.543688332550471e+03 },
            {  4.454488922153804e+00,  8.034303326295273e+00, -2.369742461634527e+02,  1.111200444340050e+04 },
            {  4.388004012867926e+00,  7.914388351275941e+00, -2.334373171162370e+02,  1.094615363081243e+04 },
            { -5.777354169527348e+00, -1.042027865207401e+01,  3.073493217895475e+02, -1.441197549815562e+04 },
            {  1.141632859846721e+00,  2.059096979152349e+00, -6.073369831769501e+01,  2.847875397839135e+03 },
            { -1.785630883350000e+00, -3.220638864828032e+00,  9.499373326613834e+01, -4.454369212004802e+03 },
            {  9.036374470286365e+00,  1.629838455837217e+01, -4.807258622862153e+02,  2.254180783044854e+04 },
            { -5.691125002817985e+00, -1.026475210502813e+01,  3.027620184792557e+02, -1.419687138624285e+04 },
            { -1.266174626375455e+01, -2.283725740514423e+01,  6.735919267962537e+02, -3.158552713967041e+04 },
            {  8.901503209535822e+00,  1.605512508735168e+01, -4.735508494162718e+02,  2.220536293745677e+04 },
            {  6.407610988021240e+01,  1.155703632320935e+02, -3.408783387120435e+03,  1.598419100704533e+05 },
            {  6.311975003125401e+01,  1.138454324375847e+02, -3.357906023133563e+03,  1.574562099201480e+05 },
            {                    0.0,  2.374906851927212e-02, -1.319647356550386e+00,  5.123707531716498e+01 },
            {                    0.0, -4.692929707401078e-03,  2.607686393183398e-01, -1.012469152973919e+01 },
            {                    0.0,  7.340223388499123e-03, -4.078688973953520e-01,  1.583605598241258e+01 },
            {                    0.0, -3.714597896604101e-02,  2.064063814091630e+00, -8.014004088069395e+01 },
            {                    0.0,  2.339460481002926e-02, -1.299951127348142e+00,  5.047234284974460e+01 },
            {                    0.0,  5.204885675481196e-02, -2.892161272439769e+00,  1.122920333298346e+02 },
            {                    0.0, -3.659156136953294e-02,  2.033256891493247e+00, -7.894392086754925e+01 },
            {                    0.0, -2.633987599410181e-01,  1.463608886355883e+01, -5.682657444267388e+02 },
            {                    0.0, -2.594674351657790e-01,  1.441763977604302e+01, -5.597841661517130e+02 },
            {                    0.0,  3.416212163926067e-01, -1.898261966730171e+01,  7.370256218699884e+02 },
            {                    0.0, -6.750598886800013e-02,  3.751056580963811e+00, -1.456397935431714e+02 },
            {                    0.0,  1.055862902807182e-01, -5.867037216379294e+00,  2.277955745162424e+02 },
            {                    0.0, -5.343306205115130e-01,  2.969076409501037e+01, -1.152783664976136e+03 },
            {                    0.0,  3.365223922673439e-01, -1.869929698570019e+01,  7.260252394540186e+02 },
            {                    0.0,  7.487027856269106e-01, -4.160262753432590e+01,  1.615277710206083e+03 },
            {                    0.0, -5.263555366232816e-01,  2.924761836224902e+01, -1.135577938633209e+03 },
            {                    0.0, -3.788889854536184e+00,  2.105345090373462e+02, -8.174284169830782e+03 },
            {                    0.0, -3.732339259692360e+00,  2.073922029323112e+02, -8.052279928490024e+03 } };

    tdMi1dDof = trans( tdMi1dDof );

    Matrix< DDRMat > tdMi2dDof = { 
            {                    0.0,  2.073210216553991e-02,                    0.0,  1.636016695665858e-02 },
            {                    0.0, -4.096762703370161e-03,                    0.0, -3.232847362693013e-03 },
            {                    0.0,  6.407757048861020e-03,                    0.0,  5.056504849340355e-03 },
            {                    0.0, -3.242713415635728e-02,                    0.0, -2.558897908605573e-02 },
            {                    0.0,  2.042266780486020e-02,                    0.0,  1.611598536029054e-02 },
            {                    0.0,  4.543682271010543e-02,                    0.0,  3.585521620441343e-02 },
            {                    0.0, -3.194314707939673e-02,                    0.0, -2.520705402506983e-02 },
            {                    0.0, -2.299378603814426e-01,                    0.0, -1.814491244283952e-01 },
            {                    0.0, -2.265059520175405e-01,                    0.0, -1.787409285414042e-01 },
            {                    0.0,  2.982233157658433e-01,                    0.0,  2.353347092996273e-01 },
            {                    0.0, -5.893035581001693e-02,                    0.0, -4.650326590950719e-02 },
            {                    0.0,  9.217312062592392e-02,                    0.0,  7.273587744820356e-02 },
            {                    0.0, -4.664518528645241e-01,                    0.0, -3.680876222378786e-01 },
            {                    0.0,  2.937722215006814e-01,                    0.0,  2.318222509518717e-01 },
            {                    0.0,  6.535912189838242e-01,                    0.0,  5.157634946327162e-01 },
            {                    0.0, -4.594898849113223e-01,                    0.0, -3.625937771298506e-01 },
            {                    0.0, -3.307567683948443e+00,                    0.0, -2.610075866777685e+00 },
            {                    0.0, -3.258201002098466e+00,                    0.0, -2.571119510557122e+00 },
            {  8.673603457595975e-03,  1.353763778067513e-02, -3.049753826370861e-01,  7.929637713129344e+00 },
            { -1.713945593417169e-03, -2.675102076420834e-03,  6.026459656900505e-02, -1.566934398402805e+00 },
            {  2.680786697396084e-03,  4.184134016965919e-03, -9.426001001818739e-02,  2.450846110322335e+00 },
            { -1.356640540803473e-02, -2.117425396464571e-02,  4.770127779708270e-01, -1.240276667951000e+01 },
            {  8.544146689572154e-03,  1.333558348544117e-02, -3.004235112544431e-01,  7.811284911440846e+00 },
            {  1.900921476335405e-02,  2.966931393848560e-02, -6.683891619471468e-01,  1.737872696410383e+01 },
            { -1.336392174522824e-02, -2.085822032338234e-02,  4.698931842697699e-01, -1.221765075892030e+01 },
            { -9.619814743879172e-02, -1.501447099311241e-01,  3.382454243793137e+00, -8.794689100016181e+01 },
            { -9.476235419343662e-02, -1.479037441112566e-01,  3.331969852094732e+00, -8.663425083598030e+01 },
            {  1.247664497361883e-01,  1.947337126912499e-01, -4.386953581010393e+00,  1.140647886427067e+02 },
            { -2.465444815146235e-02, -3.848031448389968e-02,  8.668830429541494e-01, -2.253974865394803e+01 },
            {  3.856208557023598e-02,  6.018715855174053e-02, -1.355893990261618e+00,  3.525447866386744e+01 },
            { -1.951475239463457e-01, -3.045834993375960e-01,  6.861645344657281e+00, -1.784090283898746e+02 },
            {  1.229042639192302e-01,  1.918272393674999e-01, -4.321476661890834e+00,  1.123623291107260e+02 },
            {  2.734402431344006e-01,  4.267816697305238e-01, -9.614521021855111e+00,  2.499863032528781e+02 },
            { -1.922348743352062e-01, -3.000374769594230e-01,  6.759232727572844e+00, -1.757462070706227e+02 },
            { -1.383773351619542e+00, -2.159773904393862e+00,  4.865530335302436e+01, -1.265082201310020e+03 },
            { -1.363120018013281e+00, -2.127538472984999e+00,  4.792910479551653e+01, -1.246200377409870e+03 },
            {                    0.0,  5.157493295888261e-01,  2.407607891911536e-02, -4.173351400008607e-01 },
            {                    0.0, -1.019145381822231e-01, -4.757548528926988e-03,  8.246742287442159e-02 },
            {                    0.0,  1.594047904901439e-01,  7.441293852937083e-03, -1.289875075728132e-01 },
            {                    0.0, -8.066848488440613e-01, -3.765745677092402e-02,  6.527549625654488e-01 },
            {                    0.0,  5.080515784009332e-01,  2.371673445763603e-02, -4.111062573142807e-01 },
            {                    0.0,  1.130324878021020e+00,  5.276553822991750e-02, -9.146386900617666e-01 },
            {                    0.0, -7.946447764732544e-01, -3.709540517732814e-02,  6.430123511838749e-01 },
            {                    0.0, -5.720128928166980e+00, -2.670256025574613e-01,  4.628626098191364e+00 },
            {                    0.0, -5.634753869537623e+00, -2.630401458028723e-01,  4.559542126576568e+00 },
            {                    0.0,  7.418855741008499e+00,  3.463251352211210e-01, -6.003205475396997e+00 },
            {                    0.0, -1.466001433851979e+00, -6.843550576225743e-02,  1.186262159808987e+00 },
            {                    0.0,  2.292976601665916e+00,  1.070401500384027e-01, -1.855435685855083e+00 },
            {                    0.0, -1.160385128721842e+01, -5.416880320125225e-01,  9.389629076902995e+00 },
            {                    0.0,  7.308126550844193e+00,  3.411561033521490e-01, -5.913605393674653e+00 },
            {                    0.0,  1.625928862999467e+01,  7.590119729995825e-01, -1.315672577242695e+01 },
            {                    0.0, -1.143065947696143e+01, -5.336031360123356e-01,  9.249485359337278e+00 },
            {                    0.0, -8.228185458209425e+01, -3.841060590634251e+00,  6.658100618167578e+01 },
            {                    0.0, -8.105376720027195e+01, -3.783731328087470e+00,  6.558725982075525e+01 },
            {                    0.0, -2.971274423876974e-02,                    0.0,  3.266297246229823e-02 },
            {                    0.0,  5.871380598080248e-03,                    0.0, -6.454359827879289e-03 },
            {                    0.0, -9.183441448279362e-03,                    0.0,  1.009528075642658e-02 },
            {                    0.0,  4.647377945038345e-02,                    0.0, -5.108823897949210e-02 },
            {                    0.0, -2.926927044416124e-02,                    0.0,  3.217546541062213e-02 },
            {                    0.0, -6.511894845143548e-02,                    0.0,  7.158471809102485e-02 },
            {                    0.0,  4.578014095112399e-02,                    0.0, -5.032572794994743e-02 },
            {                    0.0,  3.295413451936280e-01,                    0.0, -3.622620582182167e-01 },
            {                    0.0,  3.246228176534246e-01,                    0.0, -3.568551618269000e-01 },
            {                    0.0, -4.274063978961494e-01,                    0.0,  4.698442961884438e-01 },
            {                    0.0,  8.445755168007742e-02,                    0.0, -9.284348367795595e-02 },
            {                    0.0, -1.321002731406339e-01,                    0.0,  1.452167308809054e-01 },
            {                    0.0,  6.685074428632080e-01,                    0.0, -7.348846683973094e-01 },
            {                    0.0, -4.210271979275501e-01,                    0.0,  4.628316947527953e-01 },
            {                    0.0, -9.367110277244950e-01,                    0.0,  1.029718637155511e+00 },
            {                    0.0,  6.585297198353989e-01,                    0.0, -7.239162405107824e-01 },
            {                    0.0,  4.740325503939110e+00,                    0.0, -5.211000375908194e+00 },
            {                    0.0,  4.669574377014647e+00,                    0.0, -5.133224250894639e+00 } };
            
    tdMi2dDof = trans( tdMi2dDof );

    Matrix< DDRMat > tdMi3dDof = { 
            {                    0.0,                    0.0,  3.564767566998051e-02, -3.582526860106002e-01 }, 
            {                    0.0,                    0.0, -7.044151479696748e-03,  7.079244693622638e-02 }, 
            {                    0.0,                    0.0,  1.101777539132055e-02, -1.107266477720464e-01 }, 
            {                    0.0,                    0.0, -5.575662091971310e-02,  5.603439447858106e-01 }, 
            {                    0.0,                    0.0,  3.511562080923453e-02, -3.529056309955166e-01 }, 
            {                    0.0,                    0.0,  7.812604368390938e-02, -7.851525932926926e-01 }, 
            {                    0.0,                    0.0, -5.492443254777708e-02,  5.519806023263208e-01 }, 
            {                    0.0,                    0.0, -3.953651301579656e-01,  3.973347972117566e+00 }, 
            {                    0.0,                    0.0, -3.894641580660557e-01,  3.914044271041184e+00 }, 
            {                    0.0,                    0.0,  5.127781038681811e-01, -5.153327098767864e+00 }, 
            {                    0.0,                    0.0, -1.013274097464070e-01,  1.018322121313410e+00 }, 
            {                    0.0,                    0.0,  1.584864613982264e-01, -1.592760241028667e+00 }, 
            {                    0.0,                    0.0, -8.020375470758732e-01,  8.060332128842045e+00 }, 
            {                    0.0,                    0.0,  5.051246993328351e-01, -5.076411768935508e+00 }, 
            {                    0.0,                    0.0,  1.123813089914696e+00, -1.129411807274873e+01 }, 
            {                    0.0,                    0.0, -7.900668374180242e-01,  7.940028664232463e+00 }, 
            {                    0.0,                    0.0, -5.687175333810736e+00,  5.715508236815268e+01 }, 
            {                    0.0,                    0.0, -5.602292119873263e+00,  5.630202143728474e+01 }, 
            {                    0.0,  3.905616945191247e-01, -2.076023846781180e-03,  3.033214826027354e-01 }, 
            {                    0.0, -7.717686179120430e-02,  4.102322571483769e-04, -5.993777799934293e-02 }, 
            {                    0.0,  1.207125274170118e-01, -6.416453252833588e-04,  9.374883225538251e-02 }, 
            {                    0.0, -6.108785478376053e-01,  3.247114221888513e-03, -4.744259086863297e-01 }, 
            {                    0.0,  3.847324154964512e-01, -2.045038416232207e-03,  2.987942962952319e-01 }, 
            {                    0.0,  8.559615580479022e-01, -4.549848670191089e-03,  6.647644469018034e-01 }, 
            {                    0.0, -6.017609575713725e-01,  3.198649830517042e-03, -4.673449249745935e-01 }, 
            {                    0.0, -4.331684248303020e+00,  2.302499175520945e-02, -3.364110988866702e+00 }, 
            {                    0.0, -4.267032244597004e+00,  2.268133516184812e-02, -3.313900377092572e+00 }, 
            {                    0.0,  5.618079759621256e+00, -2.986280456523698e-02,  4.363162865131655e+00 }, 
            {                    0.0, -1.110159473458092e+00,  5.901033237442036e-03, -8.621818835290098e-01 }, 
            {                    0.0,  1.736403278998555e+00, -9.229821217537544e-03,  1.348540894750502e+00 }, 
            {                    0.0, -8.787252957356323e+00,  4.670848919178091e-02, -6.824434224949512e+00 }, 
            {                    0.0,  5.534227822910490e+00, -2.941709106426329e-02,  4.298041031323720e+00 }, 
            {                    0.0,  1.231267779653521e+01, -6.544782317890259e-02,  9.562380890049017e+00 }, 
            {                    0.0, -8.656099928142050e+00,  4.601134756205283e-02, -6.722576997711459e+00 }, 
            {                    0.0, -6.230961187943575e+01,  3.312056506326282e-01, -4.839144268600563e+01 }, 
            {                    0.0, -6.137961767227999e+01,  3.262622827127383e-01, -4.766918234740853e+01 }, 
            { -3.966869333018886e-02, -3.083263343656646e-02,  8.847025988308025e-01, -4.201937018368086e+01 }, 
            {  7.838723831713966e-03,  6.092676068303552e-03, -1.748214716252484e-01,  8.303228838691426e+00 }, 
            { -1.226056804447569e-02, -9.529570260679915e-03,  2.734387120292347e-01, -1.298710151692761e+01 }, 
            {  6.204590495234667e-02,  4.822540101616805e-02, -1.383765603299460e+00,  6.572260464627006e+01 }, 
            { -3.907662328048455e-02, -3.037244487781173e-02,  8.714980824303428e-01, -4.139221540481995e+01 }, 
            { -8.693857340628217e-02, -6.757331639391212e-02,  1.938929048934573e+00, -9.209035621094128e+01 }, 
            {  6.111984666947583e-02,  4.750561891144913e-02, -1.363112385339767e+00,  6.474167024856453e+01 }, 
            {  4.399618714802764e-01,  3.419619344782825e-01, -9.812156096123445e+00,  4.660330147644604e+02 }, 
            {  4.333952763835559e-01,  3.368580250084575e-01, -9.665706005136530e+00,  4.590772981261849e+02 }, 
            { -5.706188963650244e-01, -4.435155732798406e-01,  1.272610661395077e+01, -6.044324787960246e+02 }, 
            {  1.127570274254240e-01,  8.764080190559725e-02, -2.514739630301650e+00,  1.194387532950228e+02 }, 
            { -1.763635557166888e-01, -1.370792029805495e-01,  3.933310703805145e+00, -1.868144602819588e+02 }, 
            {  8.925064789299099e-01,  6.937038453864174e-01, -1.990493598592300e+01,  9.453943899117309e+02 }, 
            { -5.621021964192777e-01, -4.368959378577534e-01,  1.253616472419032e+01, -5.954110985154869e+02 }, 
            { -1.250577940536520e+00, -9.720161665893513e-01,  2.789074862698194e+01, -1.324684354726617e+03 }, 
            {  8.791854867070754e-01,  6.833500566493067e-01, -1.960784738911818e+01,  9.312840258831975e+02 }, 
            {  6.328682305139361e+00,  4.918990903649141e+00, -1.411440915365449e+02,  6.703705673919546e+03 }, 
            {  6.234224360286535e+00,  4.845573128967811e+00, -1.390374633046562e+02,  6.603650365353583e+03 }, 
            {                    0.0,                    0.0, -1.303391995868254e-01,  4.569628725013565e+00 }, 
            {                    0.0,                    0.0,  2.575565021775593e-02, -9.029805264996866e-01 }, 
            {                    0.0,                    0.0, -4.028447854572081e-02,  1.412354156832843e+00 }, 
            {                    0.0,                    0.0,  2.038638762768295e-01, -7.147368005790448e+00 }, 
            {                    0.0,                    0.0, -1.283938383989624e-01,  4.501425311207393e+00 }, 
            {                    0.0,                    0.0, -2.856535751423839e-01,  1.001487493026925e+01 }, 
            {                    0.0,                    0.0,  2.008211318547873e-01, -7.040690871375665e+00 }, 
            {                    0.0,                    0.0,  1.445580213599337e+00, -5.068133676833227e+01 }, 
            {                    0.0,                    0.0,  1.424004389515764e+00, -4.992489890611836e+01 }, 
            {                    0.0,                    0.0, -1.874879255595104e+00,  6.573235165981052e+01 }, 
            {                    0.0,                    0.0,  3.704851223631044e-01, -1.298902757349549e+01 }, 
            {                    0.0,                    0.0, -5.794767298499839e-01,  2.031617133290321e+01 }, 
            {                    0.0,                    0.0,  2.932503451059009e+00, -1.028121397756011e+02 }, 
            {                    0.0,                    0.0, -1.846895983123536e+00,  6.475127178429096e+01 }, 
            {                    0.0,                    0.0, -4.109016811663523e+00,  1.440601239969500e+02 }, 
            {                    0.0,                    0.0,  2.888734742834248e+00, -1.012776302267115e+02 }, 
            {                    0.0,                    0.0,  2.079411538023661e+01, -7.290315365906258e+02 }, 
            {                    0.0,                    0.0,  2.048375544918830e+01, -7.181504688803179e+02 } };
            
    tdMi3dDof = trans( tdMi3dDof );

    Matrix< DDRMat > tdMi4dDof = { 
            {                    0.0,                    0.0,                    0.0,  2.637012220545288e-04 }, 
            {                    0.0,                    0.0,                    0.0, -5.210862471736198e-05 }, 
            {                    0.0,                    0.0,                    0.0,  8.150323353228412e-05 }, 
            {                    0.0,                    0.0,                    0.0, -4.124557575724681e-04 }, 
            {                    0.0,                    0.0,                    0.0,  2.597653829193866e-04 }, 
            {                    0.0,                    0.0,                    0.0,  5.779320195925601e-04 }, 
            {                    0.0,                    0.0,                    0.0, -4.062997014892969e-04 }, 
            {                    0.0,                    0.0,                    0.0, -2.924686280968411e-03 }, 
            {                    0.0,                    0.0,                    0.0, -2.881034246924105e-03 }, 
            {                    0.0,                    0.0,                    0.0,  3.793240655707453e-03 }, 
            {                    0.0,                    0.0,                    0.0, -7.495625247805147e-04 }, 
            {                    0.0,                    0.0,                    0.0,  1.172392666964395e-03 }, 
            {                    0.0,                    0.0,                    0.0, -5.933017435850119e-03 }, 
            {                    0.0,                    0.0,                    0.0,  3.736625123532715e-03 }, 
            {                    0.0,                    0.0,                    0.0,  8.313329820292981e-03 }, 
            {                    0.0,                    0.0,                    0.0, -5.844464936807579e-03 }, 
            {                    0.0,                    0.0,                    0.0, -4.207048727239175e-02 }, 
            {                    0.0,                    0.0,                    0.0, -4.144256955190829e-02 }, 
            {                    0.0, -1.236455790417027e-02,                    0.0, -1.283299381119838e-02 }, 
            {                    0.0,  2.443295873279155e-03,                    0.0,  2.535861052512255e-03 }, 
            {                    0.0, -3.821565340257139e-03,                    0.0, -3.966346774442245e-03 }, 
            {                    0.0,  1.933943672190734e-02,                    0.0,  2.007211852520772e-02 }, 
            {                    0.0, -1.218001226380952e-02,                    0.0, -1.264145659013572e-02 }, 
            {                    0.0, -2.709837241273244e-02,                    0.0, -2.812500440059046e-02 }, 
            {                    0.0,  1.905078841262514e-02,                    0.0,  1.977253466662253e-02 }, 
            {                    0.0,  1.371341876644339e-01,                    0.0,  1.423295677242002e-01 }, 
            {                    0.0,  1.350874087440692e-01,                    0.0,  1.402052458178689e-01 }, 
            {                    0.0, -1.778594098522954e-01,                    0.0, -1.845976802072382e-01 }, 
            {                    0.0,  3.514587140793861e-02,                    0.0,  3.647738590921475e-02 }, 
            {                    0.0, -5.497174758677577e-02,                    0.0, -5.705437283236151e-02 }, 
            {                    0.0,  2.781903589997440e-01,                    0.0,  2.887297049395265e-01 }, 
            {                    0.0, -1.752047917947984e-01,                    0.0, -1.818424909504138e-01 }, 
            {                    0.0, -3.897996647062282e-01,                    0.0, -4.045673709931089e-01 }, 
            {                    0.0,  2.740382640893001e-01,                    0.0,  2.844203063583395e-01 }, 
            {                    0.0,  1.972622545634549e+00,                    0.0,  2.047356089571188e+00 }, 
            {                    0.0,  1.943180418087764e+00,                    0.0,  2.016798535995498e+00 }, 
            {                    0.0,                    0.0, -3.271920918323756e-02,  1.064179637015117e+00 }, 
            {                    0.0,                    0.0,  6.465472473334369e-03, -2.102869941407118e-01 }, 
            {                    0.0,                    0.0, -1.011266207367683e-02,  3.289104267329082e-01 }, 
            {                    0.0,                    0.0,  5.117619897891004e-02, -1.664486098921081e+00 }, 
            {                    0.0,                    0.0, -3.223086277751760e-02,  1.048296358850713e+00 }, 
            {                    0.0,                    0.0, -7.170796743152665e-02,  2.332273935015167e+00 }, 
            {                    0.0,                    0.0,  5.041237511355317e-02, -1.639643022817781e+00 }, 
            {                    0.0,                    0.0,  3.628857745777257e-01, -1.180271961053130e+01 }, 
            {                    0.0,                    0.0,  3.574695689870134e-01, -1.162655961634427e+01 }, 
            {                    0.0,                    0.0, -4.706532397896481e-01,  1.530781477860207e+01 }, 
            {                    0.0,                    0.0,  9.300333480873285e-02, -3.024897531101008e+00 }, 
            {                    0.0,                    0.0, -1.454667544444283e-01,  4.731249984542602e+00 }, 
            {                    0.0,                    0.0,  7.361499391581675e-01, -2.394299234601862e+01 }, 
            {                    0.0,                    0.0, -4.636285645689071e-01,  1.507933993116025e+01 }, 
            {                    0.0,                    0.0, -1.031491531515037e+00,  3.354886352675663e+01 }, 
            {                    0.0,                    0.0,  7.251626266334187e-01, -2.358563425130193e+01 }, 
            {                    0.0,                    0.0,  5.219972295848824e+00, -1.697775820899502e+02 }, 
            {                    0.0,                    0.0,  5.142062261582423e+00, -1.672435883274136e+02 }, 
            {                    0.0,                    0.0,                    0.0, -9.161622087241131e-02 }, 
            {                    0.0,                    0.0,                    0.0,  1.810380412448846e-02 }, 
            {                    0.0,                    0.0,                    0.0, -2.831620645112298e-02 }, 
            {                    0.0,                    0.0,                    0.0,  1.432971659799254e-01 }, 
            {                    0.0,                    0.0,                    0.0, -9.024881459073353e-02 }, 
            {                    0.0,                    0.0,                    0.0, -2.007876457443266e-01 }, 
            {                    0.0,                    0.0,                    0.0,  1.411584023085832e-01 }, 
            {                    0.0,                    0.0,                    0.0,  1.016107176948562e+00 }, 
            {                    0.0,                    0.0,                    0.0,  1.000941398188135e+00 }, 
            {                    0.0,                    0.0,                    0.0, -1.317864100241609e+00 }, 
            {                    0.0,                    0.0,                    0.0,  2.604162593291802e-01 }, 
            {                    0.0,                    0.0,                    0.0, -4.073177389507690e-01 }, 
            {                    0.0,                    0.0,                    0.0,  2.061274618326619e+00 }, 
            {                    0.0,                    0.0,                    0.0, -1.298194486805167e+00 }, 
            {                    0.0,                    0.0,                    0.0, -2.888253058014544e+00 }, 
            {                    0.0,                    0.0,                    0.0,  2.030509325515774e+00 }, 
            {                    0.0,                    0.0,                    0.0,  1.461631092995239e+01 }, 
            {                    0.0,                    0.0,                    0.0,  1.439815703547549e+01 } };
            
    tdMi4dDof = trans( tdMi4dDof );

    Cell< Matrix< DDRMat > > tdMdDof = { tdMi1dDof, tdMi2dDof, tdMi3dDof, tdMi4dDof };

    // return value
    return tdMdDof;
}

//------------------------------------------------------------------------------

const Cell< Matrix< DDRMat > > get_reference_dTaudDof()
{
    // define reference value for unit test
    Matrix< DDRMat > tdTaui1dDof = { 
            {                    0.0, -1.657094043287682e-02,  3.609225859463563e-01, -3.802541974218456e+00 },
            {                    0.0,  3.274497211287036e-03, -7.132003195347160e-02,  7.514005098755032e-01 },
            {                    0.0, -5.121649484320749e-03,  1.115518448503017e-01, -1.175267464164249e+00 },
            {                    0.0,  2.591865042065349e-02, -5.645199421212240e-01,  5.947565651982714e+00 },
            {                    0.0, -1.632361296372940e-02,  3.555356816785002e-01, -3.745787616394300e+00 },
            {                    0.0, -3.631715088881985e-02,  7.910039907566850e-01, -8.333714745891946e+00 },
            {                    0.0,  2.553180489198701e-02, -5.560942713432953e-01,  5.858796015385957e+00 },
            {                    0.0,  1.837867938919065e-01, -4.002959589586861e+00,  4.217364735042288e+01 },
            {                    0.0,  1.810437074159079e-01, -3.943213924070639e+00,  4.154418992728223e+01 },
            {                    0.0, -2.383666046883050e-01,  5.191732582459125e+00, -5.469810378298856e+01 },
            {                    0.0,  4.710238296235968e-02, -1.025911228869169e+00,  1.080860733436301e+01 },
            {                    0.0, -7.367295796676768e-02,  1.604630383615879e+00, -1.690577044605497e+01 },
            {                    0.0,  3.728298175894001e-01, -8.120402244359145e+00,  8.555344437852058e+01 },
            {                    0.0, -2.348088941705691e-01,  5.114244036452273e+00, -5.388171417428724e+01 },
            {                    0.0, -5.224082474007163e-01,  1.137828817473078e+01, -1.198772813447534e+02 },
            {                    0.0,  3.672651934462747e-01, -7.999202210861246e+00,  8.427652729824416e+01 },
            {                    0.0,  2.643702342906656e+00, -5.758103409636485e+01,  6.066516965022367e+02 },
            {                    0.0,  2.604244098982675e+00, -5.672161567701611e+01,  5.975971935693675e+02 },
            { -6.932715509820288e-03,  6.269542725350712e+00,  2.227443057207732e-01,  4.074071126814247e-01 },
            {  1.369937795353710e-03, -1.238891676266907e+00, -4.401534184901505e-02, -8.050559711668871e-02 },
            { -2.142723218373751e-03,  1.937753647494393e+00,  6.884450904589534e-02,  1.259190108748208e-01 },
            {  1.084347810510353e-02, -9.806207852471626e+00, -3.483949397171067e-01, -6.372265095786386e-01 },
            { -6.829242144002075e-03,  6.175967460793238e+00,  2.194197638443437e-01,  4.013264095070751e-01 },
            { -1.519385554846842e-02,  1.374043495496024e+01,  4.881701550527124e-01,  8.928802589305476e-01 },
            {  1.068163514831094e-02, -9.659846541240706e+00, -3.431950152437170e-01, -6.277156661520917e-01 },
            {  7.689011747255228e-02, -6.953492840843516e+01, -2.470436845266757e+00, -4.518515249739437e+00 },
            {  7.574250377893210e-02, -6.849709365607046e+01, -2.433564653546358e+00, -4.451074723623924e+00 },
            { -9.972444617972259e-02,  9.018496074158332e+01,  3.204091166906506e+00,  5.860394620878954e+00 },
            {  1.970602828701105e-02, -1.782098026630089e+01, -6.331437635204473e-01, -1.158042050832368e+00 },
            { -3.082224937199165e-02,  2.787384092934242e+01,  9.903017839678790e-01,  1.811296541045499e+00 },
            {  1.559792619734123e-01, -1.410585283393995e+02, -5.011527209776842e+00, -9.166258253169646e+00 },
            { -9.823602160987599e-02,  8.883891655141043e+01,  3.156268910684021e+00,  5.772926044447925e+00 },
            { -2.185577682741226e-01,  1.976508720444281e+02,  7.022139922681324e+00,  1.284373910923172e+01 },
            {  1.536512132872419e-01, -1.389531771701548e+02, -4.936728296198084e+00, -9.029448428495474e+00 },
            {  1.106034766720560e+00, -1.000233200952106e+03, -3.553628385114489e+01, -6.499710397702114e+01 },
            {  1.089526785127716e+00, -9.853043472065521e+02, -3.500589155485914e+01, -6.402699794751335e+01 },
            { -4.016342470794413e-01, -7.244043982725246e-01,  2.136653039178672e+01, -1.001902039978733e+03 },
            {  7.936485121929079e-02,  1.431457792993611e-01, -4.222128760053664e+00,  1.979806426305281e+02 },
            { -1.241347672917112e-01, -2.238946804425905e-01,  6.603842419571114e+00, -3.096620307810824e+02 },
            {  6.281971556883569e-01,  1.133042776785231e+00, -3.341944497176897e+01,  1.567077549710326e+03 },
            { -3.956397060782556e-01, -7.135923923281585e-01,  2.104762695310334e+01, -9.869482781880059e+02 },
            { -8.802283498866796e-01, -1.587616824956551e+00,  4.682724624786790e+01, -2.195785309174948e+03 },
            {  6.188210787377844e-01,  1.116131690564556e+00, -3.292064728562317e+01,  1.543688332550471e+03 },
            {  4.454488922153804e+00,  8.034303326295273e+00, -2.369742461634527e+02,  1.111200444340050e+04 },
            {  4.388004012867926e+00,  7.914388351275941e+00, -2.334373171162370e+02,  1.094615363081243e+04 },
            { -5.777354169527348e+00, -1.042027865207401e+01,  3.073493217895475e+02, -1.441197549815562e+04 },
            {  1.141632859846721e+00,  2.059096979152349e+00, -6.073369831769501e+01,  2.847875397839135e+03 },
            { -1.785630883350000e+00, -3.220638864828032e+00,  9.499373326613834e+01, -4.454369212004802e+03 },
            {  9.036374470286365e+00,  1.629838455837217e+01, -4.807258622862153e+02,  2.254180783044854e+04 },
            { -5.691125002817985e+00, -1.026475210502813e+01,  3.027620184792557e+02, -1.419687138624285e+04 },
            { -1.266174626375455e+01, -2.283725740514423e+01,  6.735919267962537e+02, -3.158552713967041e+04 },
            {  8.901503209535822e+00,  1.605512508735168e+01, -4.735508494162718e+02,  2.220536293745677e+04 },
            {  6.407610988021240e+01,  1.155703632320935e+02, -3.408783387120435e+03,  1.598419100704533e+05 },
            {  6.311975003125401e+01,  1.138454324375847e+02, -3.357906023133563e+03,  1.574562099201480e+05 },
            {                    0.0,  2.374906851927212e-02, -1.319647356550386e+00,  5.123707531716498e+01 },
            {                    0.0, -4.692929707401078e-03,  2.607686393183398e-01, -1.012469152973919e+01 },
            {                    0.0,  7.340223388499123e-03, -4.078688973953520e-01,  1.583605598241258e+01 },
            {                    0.0, -3.714597896604101e-02,  2.064063814091630e+00, -8.014004088069395e+01 },
            {                    0.0,  2.339460481002926e-02, -1.299951127348142e+00,  5.047234284974460e+01 },
            {                    0.0,  5.204885675481196e-02, -2.892161272439769e+00,  1.122920333298346e+02 },
            {                    0.0, -3.659156136953294e-02,  2.033256891493247e+00, -7.894392086754925e+01 },
            {                    0.0, -2.633987599410181e-01,  1.463608886355883e+01, -5.682657444267388e+02 },
            {                    0.0, -2.594674351657790e-01,  1.441763977604302e+01, -5.597841661517130e+02 },
            {                    0.0,  3.416212163926067e-01, -1.898261966730171e+01,  7.370256218699884e+02 },
            {                    0.0, -6.750598886800013e-02,  3.751056580963811e+00, -1.456397935431714e+02 },
            {                    0.0,  1.055862902807182e-01, -5.867037216379294e+00,  2.277955745162424e+02 },
            {                    0.0, -5.343306205115130e-01,  2.969076409501037e+01, -1.152783664976136e+03 },
            {                    0.0,  3.365223922673439e-01, -1.869929698570019e+01,  7.260252394540186e+02 },
            {                    0.0,  7.487027856269106e-01, -4.160262753432590e+01,  1.615277710206083e+03 },
            {                    0.0, -5.263555366232816e-01,  2.924761836224902e+01, -1.135577938633209e+03 },
            {                    0.0, -3.788889854536184e+00,  2.105345090373462e+02, -8.174284169830782e+03 },
            {                    0.0, -3.732339259692360e+00,  2.073922029323112e+02, -8.052279928490024e+03 } };

    tdTaui1dDof = trans( tdTaui1dDof );

    Matrix< DDRMat > tdTaui2dDof = { 
            {                    0.0,  2.073210216553991e-02,                    0.0,  1.636016695665858e-02 },
            {                    0.0, -4.096762703370161e-03,                    0.0, -3.232847362693013e-03 },
            {                    0.0,  6.407757048861020e-03,                    0.0,  5.056504849340355e-03 },
            {                    0.0, -3.242713415635728e-02,                    0.0, -2.558897908605573e-02 },
            {                    0.0,  2.042266780486020e-02,                    0.0,  1.611598536029054e-02 },
            {                    0.0,  4.543682271010543e-02,                    0.0,  3.585521620441343e-02 },
            {                    0.0, -3.194314707939673e-02,                    0.0, -2.520705402506983e-02 },
            {                    0.0, -2.299378603814426e-01,                    0.0, -1.814491244283952e-01 },
            {                    0.0, -2.265059520175405e-01,                    0.0, -1.787409285414042e-01 },
            {                    0.0,  2.982233157658433e-01,                    0.0,  2.353347092996273e-01 },
            {                    0.0, -5.893035581001693e-02,                    0.0, -4.650326590950719e-02 },
            {                    0.0,  9.217312062592392e-02,                    0.0,  7.273587744820356e-02 },
            {                    0.0, -4.664518528645241e-01,                    0.0, -3.680876222378786e-01 },
            {                    0.0,  2.937722215006814e-01,                    0.0,  2.318222509518717e-01 },
            {                    0.0,  6.535912189838242e-01,                    0.0,  5.157634946327162e-01 },
            {                    0.0, -4.594898849113223e-01,                    0.0, -3.625937771298506e-01 },
            {                    0.0, -3.307567683948443e+00,                    0.0, -2.610075866777685e+00 },
            {                    0.0, -3.258201002098466e+00,                    0.0, -2.571119510557122e+00 },
            {  8.673603457595975e-03,  1.353763778067513e-02, -3.049753826370861e-01,  7.929637713129344e+00 },
            { -1.713945593417169e-03, -2.675102076420834e-03,  6.026459656900505e-02, -1.566934398402805e+00 },
            {  2.680786697396084e-03,  4.184134016965919e-03, -9.426001001818739e-02,  2.450846110322335e+00 },
            { -1.356640540803473e-02, -2.117425396464571e-02,  4.770127779708270e-01, -1.240276667951000e+01 },
            {  8.544146689572154e-03,  1.333558348544117e-02, -3.004235112544431e-01,  7.811284911440846e+00 },
            {  1.900921476335405e-02,  2.966931393848560e-02, -6.683891619471468e-01,  1.737872696410383e+01 },
            { -1.336392174522824e-02, -2.085822032338234e-02,  4.698931842697699e-01, -1.221765075892030e+01 },
            { -9.619814743879172e-02, -1.501447099311241e-01,  3.382454243793137e+00, -8.794689100016181e+01 },
            { -9.476235419343662e-02, -1.479037441112566e-01,  3.331969852094732e+00, -8.663425083598030e+01 },
            {  1.247664497361883e-01,  1.947337126912499e-01, -4.386953581010393e+00,  1.140647886427067e+02 },
            { -2.465444815146235e-02, -3.848031448389968e-02,  8.668830429541494e-01, -2.253974865394803e+01 },
            {  3.856208557023598e-02,  6.018715855174053e-02, -1.355893990261618e+00,  3.525447866386744e+01 },
            { -1.951475239463457e-01, -3.045834993375960e-01,  6.861645344657281e+00, -1.784090283898746e+02 },
            {  1.229042639192302e-01,  1.918272393674999e-01, -4.321476661890834e+00,  1.123623291107260e+02 },
            {  2.734402431344006e-01,  4.267816697305238e-01, -9.614521021855111e+00,  2.499863032528781e+02 },
            { -1.922348743352062e-01, -3.000374769594230e-01,  6.759232727572844e+00, -1.757462070706227e+02 },
            { -1.383773351619542e+00, -2.159773904393862e+00,  4.865530335302436e+01, -1.265082201310020e+03 },
            { -1.363120018013281e+00, -2.127538472984999e+00,  4.792910479551653e+01, -1.246200377409870e+03 },
            {                    0.0,  5.157493295888261e-01,  2.407607891911536e-02, -4.173351400008607e-01 },
            {                    0.0, -1.019145381822231e-01, -4.757548528926988e-03,  8.246742287442159e-02 },
            {                    0.0,  1.594047904901439e-01,  7.441293852937083e-03, -1.289875075728132e-01 },
            {                    0.0, -8.066848488440613e-01, -3.765745677092402e-02,  6.527549625654488e-01 },
            {                    0.0,  5.080515784009332e-01,  2.371673445763603e-02, -4.111062573142807e-01 },
            {                    0.0,  1.130324878021020e+00,  5.276553822991750e-02, -9.146386900617666e-01 },
            {                    0.0, -7.946447764732544e-01, -3.709540517732814e-02,  6.430123511838749e-01 },
            {                    0.0, -5.720128928166980e+00, -2.670256025574613e-01,  4.628626098191364e+00 },
            {                    0.0, -5.634753869537623e+00, -2.630401458028723e-01,  4.559542126576568e+00 },
            {                    0.0,  7.418855741008499e+00,  3.463251352211210e-01, -6.003205475396997e+00 },
            {                    0.0, -1.466001433851979e+00, -6.843550576225743e-02,  1.186262159808987e+00 },
            {                    0.0,  2.292976601665916e+00,  1.070401500384027e-01, -1.855435685855083e+00 },
            {                    0.0, -1.160385128721842e+01, -5.416880320125225e-01,  9.389629076902995e+00 },
            {                    0.0,  7.308126550844193e+00,  3.411561033521490e-01, -5.913605393674653e+00 },
            {                    0.0,  1.625928862999467e+01,  7.590119729995825e-01, -1.315672577242695e+01 },
            {                    0.0, -1.143065947696143e+01, -5.336031360123356e-01,  9.249485359337278e+00 },
            {                    0.0, -8.228185458209425e+01, -3.841060590634251e+00,  6.658100618167578e+01 },
            {                    0.0, -8.105376720027195e+01, -3.783731328087470e+00,  6.558725982075525e+01 },
            {                    0.0, -2.971274423876974e-02,                    0.0,  3.266297246229823e-02 },
            {                    0.0,  5.871380598080248e-03,                    0.0, -6.454359827879289e-03 },
            {                    0.0, -9.183441448279362e-03,                    0.0,  1.009528075642658e-02 },
            {                    0.0,  4.647377945038345e-02,                    0.0, -5.108823897949210e-02 },
            {                    0.0, -2.926927044416124e-02,                    0.0,  3.217546541062213e-02 },
            {                    0.0, -6.511894845143548e-02,                    0.0,  7.158471809102485e-02 },
            {                    0.0,  4.578014095112399e-02,                    0.0, -5.032572794994743e-02 },
            {                    0.0,  3.295413451936280e-01,                    0.0, -3.622620582182167e-01 },
            {                    0.0,  3.246228176534246e-01,                    0.0, -3.568551618269000e-01 },
            {                    0.0, -4.274063978961494e-01,                    0.0,  4.698442961884438e-01 },
            {                    0.0,  8.445755168007742e-02,                    0.0, -9.284348367795595e-02 },
            {                    0.0, -1.321002731406339e-01,                    0.0,  1.452167308809054e-01 },
            {                    0.0,  6.685074428632080e-01,                    0.0, -7.348846683973094e-01 },
            {                    0.0, -4.210271979275501e-01,                    0.0,  4.628316947527953e-01 },
            {                    0.0, -9.367110277244950e-01,                    0.0,  1.029718637155511e+00 },
            {                    0.0,  6.585297198353989e-01,                    0.0, -7.239162405107824e-01 },
            {                    0.0,  4.740325503939110e+00,                    0.0, -5.211000375908194e+00 },
            {                    0.0,  4.669574377014647e+00,                    0.0, -5.133224250894639e+00 } };
            
    tdTaui2dDof = trans( tdTaui2dDof );

    Matrix< DDRMat > tdTaui3dDof = { 
            {                    0.0,                    0.0,  3.564767566998051e-02, -3.582526860106002e-01 }, 
            {                    0.0,                    0.0, -7.044151479696748e-03,  7.079244693622638e-02 }, 
            {                    0.0,                    0.0,  1.101777539132055e-02, -1.107266477720464e-01 }, 
            {                    0.0,                    0.0, -5.575662091971310e-02,  5.603439447858106e-01 }, 
            {                    0.0,                    0.0,  3.511562080923453e-02, -3.529056309955166e-01 }, 
            {                    0.0,                    0.0,  7.812604368390938e-02, -7.851525932926926e-01 }, 
            {                    0.0,                    0.0, -5.492443254777708e-02,  5.519806023263208e-01 }, 
            {                    0.0,                    0.0, -3.953651301579656e-01,  3.973347972117566e+00 }, 
            {                    0.0,                    0.0, -3.894641580660557e-01,  3.914044271041184e+00 }, 
            {                    0.0,                    0.0,  5.127781038681811e-01, -5.153327098767864e+00 }, 
            {                    0.0,                    0.0, -1.013274097464070e-01,  1.018322121313410e+00 }, 
            {                    0.0,                    0.0,  1.584864613982264e-01, -1.592760241028667e+00 }, 
            {                    0.0,                    0.0, -8.020375470758732e-01,  8.060332128842045e+00 }, 
            {                    0.0,                    0.0,  5.051246993328351e-01, -5.076411768935508e+00 }, 
            {                    0.0,                    0.0,  1.123813089914696e+00, -1.129411807274873e+01 }, 
            {                    0.0,                    0.0, -7.900668374180242e-01,  7.940028664232463e+00 }, 
            {                    0.0,                    0.0, -5.687175333810736e+00,  5.715508236815268e+01 }, 
            {                    0.0,                    0.0, -5.602292119873263e+00,  5.630202143728474e+01 }, 
            {                    0.0,  3.905616945191247e-01, -2.076023846781180e-03,  3.033214826027354e-01 }, 
            {                    0.0, -7.717686179120430e-02,  4.102322571483769e-04, -5.993777799934293e-02 }, 
            {                    0.0,  1.207125274170118e-01, -6.416453252833588e-04,  9.374883225538251e-02 }, 
            {                    0.0, -6.108785478376053e-01,  3.247114221888513e-03, -4.744259086863297e-01 }, 
            {                    0.0,  3.847324154964512e-01, -2.045038416232207e-03,  2.987942962952319e-01 }, 
            {                    0.0,  8.559615580479022e-01, -4.549848670191089e-03,  6.647644469018034e-01 }, 
            {                    0.0, -6.017609575713725e-01,  3.198649830517042e-03, -4.673449249745935e-01 }, 
            {                    0.0, -4.331684248303020e+00,  2.302499175520945e-02, -3.364110988866702e+00 }, 
            {                    0.0, -4.267032244597004e+00,  2.268133516184812e-02, -3.313900377092572e+00 }, 
            {                    0.0,  5.618079759621256e+00, -2.986280456523698e-02,  4.363162865131655e+00 }, 
            {                    0.0, -1.110159473458092e+00,  5.901033237442036e-03, -8.621818835290098e-01 }, 
            {                    0.0,  1.736403278998555e+00, -9.229821217537544e-03,  1.348540894750502e+00 }, 
            {                    0.0, -8.787252957356323e+00,  4.670848919178091e-02, -6.824434224949512e+00 }, 
            {                    0.0,  5.534227822910490e+00, -2.941709106426329e-02,  4.298041031323720e+00 }, 
            {                    0.0,  1.231267779653521e+01, -6.544782317890259e-02,  9.562380890049017e+00 }, 
            {                    0.0, -8.656099928142050e+00,  4.601134756205283e-02, -6.722576997711459e+00 }, 
            {                    0.0, -6.230961187943575e+01,  3.312056506326282e-01, -4.839144268600563e+01 }, 
            {                    0.0, -6.137961767227999e+01,  3.262622827127383e-01, -4.766918234740853e+01 }, 
            { -3.966869333018886e-02, -3.083263343656646e-02,  8.847025988308025e-01, -4.201937018368086e+01 }, 
            {  7.838723831713966e-03,  6.092676068303552e-03, -1.748214716252484e-01,  8.303228838691426e+00 }, 
            { -1.226056804447569e-02, -9.529570260679915e-03,  2.734387120292347e-01, -1.298710151692761e+01 }, 
            {  6.204590495234667e-02,  4.822540101616805e-02, -1.383765603299460e+00,  6.572260464627006e+01 }, 
            { -3.907662328048455e-02, -3.037244487781173e-02,  8.714980824303428e-01, -4.139221540481995e+01 }, 
            { -8.693857340628217e-02, -6.757331639391212e-02,  1.938929048934573e+00, -9.209035621094128e+01 }, 
            {  6.111984666947583e-02,  4.750561891144913e-02, -1.363112385339767e+00,  6.474167024856453e+01 }, 
            {  4.399618714802764e-01,  3.419619344782825e-01, -9.812156096123445e+00,  4.660330147644604e+02 }, 
            {  4.333952763835559e-01,  3.368580250084575e-01, -9.665706005136530e+00,  4.590772981261849e+02 }, 
            { -5.706188963650244e-01, -4.435155732798406e-01,  1.272610661395077e+01, -6.044324787960246e+02 }, 
            {  1.127570274254240e-01,  8.764080190559725e-02, -2.514739630301650e+00,  1.194387532950228e+02 }, 
            { -1.763635557166888e-01, -1.370792029805495e-01,  3.933310703805145e+00, -1.868144602819588e+02 }, 
            {  8.925064789299099e-01,  6.937038453864174e-01, -1.990493598592300e+01,  9.453943899117309e+02 }, 
            { -5.621021964192777e-01, -4.368959378577534e-01,  1.253616472419032e+01, -5.954110985154869e+02 }, 
            { -1.250577940536520e+00, -9.720161665893513e-01,  2.789074862698194e+01, -1.324684354726617e+03 }, 
            {  8.791854867070754e-01,  6.833500566493067e-01, -1.960784738911818e+01,  9.312840258831975e+02 }, 
            {  6.328682305139361e+00,  4.918990903649141e+00, -1.411440915365449e+02,  6.703705673919546e+03 }, 
            {  6.234224360286535e+00,  4.845573128967811e+00, -1.390374633046562e+02,  6.603650365353583e+03 }, 
            {                    0.0,                    0.0, -1.303391995868254e-01,  4.569628725013565e+00 }, 
            {                    0.0,                    0.0,  2.575565021775593e-02, -9.029805264996866e-01 }, 
            {                    0.0,                    0.0, -4.028447854572081e-02,  1.412354156832843e+00 }, 
            {                    0.0,                    0.0,  2.038638762768295e-01, -7.147368005790448e+00 }, 
            {                    0.0,                    0.0, -1.283938383989624e-01,  4.501425311207393e+00 }, 
            {                    0.0,                    0.0, -2.856535751423839e-01,  1.001487493026925e+01 }, 
            {                    0.0,                    0.0,  2.008211318547873e-01, -7.040690871375665e+00 }, 
            {                    0.0,                    0.0,  1.445580213599337e+00, -5.068133676833227e+01 }, 
            {                    0.0,                    0.0,  1.424004389515764e+00, -4.992489890611836e+01 }, 
            {                    0.0,                    0.0, -1.874879255595104e+00,  6.573235165981052e+01 }, 
            {                    0.0,                    0.0,  3.704851223631044e-01, -1.298902757349549e+01 }, 
            {                    0.0,                    0.0, -5.794767298499839e-01,  2.031617133290321e+01 }, 
            {                    0.0,                    0.0,  2.932503451059009e+00, -1.028121397756011e+02 }, 
            {                    0.0,                    0.0, -1.846895983123536e+00,  6.475127178429096e+01 }, 
            {                    0.0,                    0.0, -4.109016811663523e+00,  1.440601239969500e+02 }, 
            {                    0.0,                    0.0,  2.888734742834248e+00, -1.012776302267115e+02 }, 
            {                    0.0,                    0.0,  2.079411538023661e+01, -7.290315365906258e+02 }, 
            {                    0.0,                    0.0,  2.048375544918830e+01, -7.181504688803179e+02 } };
            
    tdTaui3dDof = trans( tdTaui3dDof );

    Matrix< DDRMat > tdTaui4dDof = { 
            {                    0.0,                    0.0,                    0.0,  2.637012220545288e-04 }, 
            {                    0.0,                    0.0,                    0.0, -5.210862471736198e-05 }, 
            {                    0.0,                    0.0,                    0.0,  8.150323353228412e-05 }, 
            {                    0.0,                    0.0,                    0.0, -4.124557575724681e-04 }, 
            {                    0.0,                    0.0,                    0.0,  2.597653829193866e-04 }, 
            {                    0.0,                    0.0,                    0.0,  5.779320195925601e-04 }, 
            {                    0.0,                    0.0,                    0.0, -4.062997014892969e-04 }, 
            {                    0.0,                    0.0,                    0.0, -2.924686280968411e-03 }, 
            {                    0.0,                    0.0,                    0.0, -2.881034246924105e-03 }, 
            {                    0.0,                    0.0,                    0.0,  3.793240655707453e-03 }, 
            {                    0.0,                    0.0,                    0.0, -7.495625247805147e-04 }, 
            {                    0.0,                    0.0,                    0.0,  1.172392666964395e-03 }, 
            {                    0.0,                    0.0,                    0.0, -5.933017435850119e-03 }, 
            {                    0.0,                    0.0,                    0.0,  3.736625123532715e-03 }, 
            {                    0.0,                    0.0,                    0.0,  8.313329820292981e-03 }, 
            {                    0.0,                    0.0,                    0.0, -5.844464936807579e-03 }, 
            {                    0.0,                    0.0,                    0.0, -4.207048727239175e-02 }, 
            {                    0.0,                    0.0,                    0.0, -4.144256955190829e-02 }, 
            {                    0.0, -1.236455790417027e-02,                    0.0, -1.283299381119838e-02 }, 
            {                    0.0,  2.443295873279155e-03,                    0.0,  2.535861052512255e-03 }, 
            {                    0.0, -3.821565340257139e-03,                    0.0, -3.966346774442245e-03 }, 
            {                    0.0,  1.933943672190734e-02,                    0.0,  2.007211852520772e-02 }, 
            {                    0.0, -1.218001226380952e-02,                    0.0, -1.264145659013572e-02 }, 
            {                    0.0, -2.709837241273244e-02,                    0.0, -2.812500440059046e-02 }, 
            {                    0.0,  1.905078841262514e-02,                    0.0,  1.977253466662253e-02 }, 
            {                    0.0,  1.371341876644339e-01,                    0.0,  1.423295677242002e-01 }, 
            {                    0.0,  1.350874087440692e-01,                    0.0,  1.402052458178689e-01 }, 
            {                    0.0, -1.778594098522954e-01,                    0.0, -1.845976802072382e-01 }, 
            {                    0.0,  3.514587140793861e-02,                    0.0,  3.647738590921475e-02 }, 
            {                    0.0, -5.497174758677577e-02,                    0.0, -5.705437283236151e-02 }, 
            {                    0.0,  2.781903589997440e-01,                    0.0,  2.887297049395265e-01 }, 
            {                    0.0, -1.752047917947984e-01,                    0.0, -1.818424909504138e-01 }, 
            {                    0.0, -3.897996647062282e-01,                    0.0, -4.045673709931089e-01 }, 
            {                    0.0,  2.740382640893001e-01,                    0.0,  2.844203063583395e-01 }, 
            {                    0.0,  1.972622545634549e+00,                    0.0,  2.047356089571188e+00 }, 
            {                    0.0,  1.943180418087764e+00,                    0.0,  2.016798535995498e+00 }, 
            {                    0.0,                    0.0, -3.271920918323756e-02,  1.064179637015117e+00 }, 
            {                    0.0,                    0.0,  6.465472473334369e-03, -2.102869941407118e-01 }, 
            {                    0.0,                    0.0, -1.011266207367683e-02,  3.289104267329082e-01 }, 
            {                    0.0,                    0.0,  5.117619897891004e-02, -1.664486098921081e+00 }, 
            {                    0.0,                    0.0, -3.223086277751760e-02,  1.048296358850713e+00 }, 
            {                    0.0,                    0.0, -7.170796743152665e-02,  2.332273935015167e+00 }, 
            {                    0.0,                    0.0,  5.041237511355317e-02, -1.639643022817781e+00 }, 
            {                    0.0,                    0.0,  3.628857745777257e-01, -1.180271961053130e+01 }, 
            {                    0.0,                    0.0,  3.574695689870134e-01, -1.162655961634427e+01 }, 
            {                    0.0,                    0.0, -4.706532397896481e-01,  1.530781477860207e+01 }, 
            {                    0.0,                    0.0,  9.300333480873285e-02, -3.024897531101008e+00 }, 
            {                    0.0,                    0.0, -1.454667544444283e-01,  4.731249984542602e+00 }, 
            {                    0.0,                    0.0,  7.361499391581675e-01, -2.394299234601862e+01 }, 
            {                    0.0,                    0.0, -4.636285645689071e-01,  1.507933993116025e+01 }, 
            {                    0.0,                    0.0, -1.031491531515037e+00,  3.354886352675663e+01 }, 
            {                    0.0,                    0.0,  7.251626266334187e-01, -2.358563425130193e+01 }, 
            {                    0.0,                    0.0,  5.219972295848824e+00, -1.697775820899502e+02 }, 
            {                    0.0,                    0.0,  5.142062261582423e+00, -1.672435883274136e+02 }, 
            {                    0.0,                    0.0,                    0.0, -9.161622087241131e-02 }, 
            {                    0.0,                    0.0,                    0.0,  1.810380412448846e-02 }, 
            {                    0.0,                    0.0,                    0.0, -2.831620645112298e-02 }, 
            {                    0.0,                    0.0,                    0.0,  1.432971659799254e-01 }, 
            {                    0.0,                    0.0,                    0.0, -9.024881459073353e-02 }, 
            {                    0.0,                    0.0,                    0.0, -2.007876457443266e-01 }, 
            {                    0.0,                    0.0,                    0.0,  1.411584023085832e-01 }, 
            {                    0.0,                    0.0,                    0.0,  1.016107176948562e+00 }, 
            {                    0.0,                    0.0,                    0.0,  1.000941398188135e+00 }, 
            {                    0.0,                    0.0,                    0.0, -1.317864100241609e+00 }, 
            {                    0.0,                    0.0,                    0.0,  2.604162593291802e-01 }, 
            {                    0.0,                    0.0,                    0.0, -4.073177389507690e-01 }, 
            {                    0.0,                    0.0,                    0.0,  2.061274618326619e+00 }, 
            {                    0.0,                    0.0,                    0.0, -1.298194486805167e+00 }, 
            {                    0.0,                    0.0,                    0.0, -2.888253058014544e+00 }, 
            {                    0.0,                    0.0,                    0.0,  2.030509325515774e+00 }, 
            {                    0.0,                    0.0,                    0.0,  1.461631092995239e+01 }, 
            {                    0.0,                    0.0,                    0.0,  1.439815703547549e+01 } };
            
    tdTaui4dDof = trans( tdTaui4dDof );

    Cell< Matrix< DDRMat > > tdTaudDof = { tdTaui1dDof, tdTaui2dDof, tdTaui3dDof, tdTaui4dDof };

    // return value
    return tdTaudDof;
}

//------------------------------------------------------------------------------

const Matrix< DDRMat > get_reference_ResGLS()
{
    // define reference value for unit test
    Matrix< DDRMat > tResGLS = { 
            {  1.204342117806030e-01 },
            { -2.245339996978983e-02 },
            {  5.819697366485768e-02 },
            { -3.051578650359929e-01 },
            {  1.102806894917336e-01 },
            { -4.106194757570710e-02 },
            { -2.875336341089373e-01 },
            {  1.323091792076156e-01 },
            {  2.230100155450662e-01 },
            {  1.723556015668584e+00 },
            { -3.212359454077791e-01 },
            {  8.344076926839906e-01 },
            { -4.375745909963205e+00 },
            {  1.577633499758178e+00 },
            { -6.100425430578827e-01 },
            { -4.122434583496076e+00 },
            {  2.001302435960612e+00 },
            {  3.304535114854130e+00 },
            { -2.544248954840134e-01 },
            {  5.404027965601770e-02 },
            {  2.966917838095628e-01 },
            { -1.737317004478151e+00 },
            { -2.441112600408333e-01 },
            { -1.346365327677155e-01 },
            { -1.468583694625826e+00 },
            {  3.060493619898545e+00 },
            { -2.376699975498604e-01 },
            { -4.151271784966769e+00 },
            {  8.744649742499648e-01 },
            {  4.115897287532769e+00 },
            { -2.422193130368175e+01 },
            { -3.995578769792647e+00 },
            { -3.013803195742990e+00 },
            { -2.036777921843465e+01 },
            {  4.947484518542881e+01 },
            {  1.950674526989532e+00 },
            {  1.974085573575669e+00 },
            { -4.428879908823030e-01 },
            { -1.379614087758983e+00 },
            {  7.449204617164835e+00 },
            {  2.179459874577588e+00 },
            {  1.840582186919715e+00 },
            {  6.909820075450749e+00 },
            { -6.974487377140771e+00 },
            { -8.709542272512275e+00 },
            {  3.049861701272090e+01 },
            { -6.786169364894176e+00 },
            { -1.919549614923000e+01 },
            {  1.038659568435367e+02 },
            {  3.342147189027121e+01 },
            {  3.108318564494514e+01 },
            {  9.615619209188124e+01 },
            { -1.236401317580322e+02 },
            { -1.482502468105930e+02 },
            {  4.398827451786095e+01 },
            { -7.805775161709211e+00 },
            {  4.156656135452521e+01 },
            { -2.180359521598878e+02 },
            {  3.854432934565553e+01 },
            { -4.132883216483618e+01 },
            { -2.064749707639432e+02 },
            {  1.677745658346460e+02 },
            {  2.080755772098435e+02 },
            {  6.521790665360555e+02 },
            { -1.161214785901727e+02 },
            {  6.039226572207936e+02 },
            { -3.166745466350914e+03 },
            {  5.735800888176969e+02 },
            { -5.519279528551615e+02 },
            { -2.999991730508833e+03 },
            {  2.197935505217919e+03 },
            {  2.780865532500462e+03 } };

    // return value
    return tResGLS;
}

//------------------------------------------------------------------------------