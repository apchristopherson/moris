//
// Created by messe on 1/26/18.
//
/*#include <catch.hpp>

#include "typedefs.hpp" // COR/src
#include "cl_BoostBitset.hpp" // CON/src
#include "cl_Hierarchical_Mesh_Main.hpp" // STK/src/Hierarchical
#include "cl_GeMeshWrapper.hpp" // GEN/src
#include "cl_GeSDFCore.hpp" // GEN/src

// solutions generated with Kurt's MATLAB code
TEST_CASE("ge::SDFCore",
          "[geomeng],[SDFCore]")
{
    // node coords of the object
    moris::Mat<moris::real> tNodeCoords = {{0.5, 1.5, 1.0, 1.0},
                                           {0.433013,  0.433013, 1.29904, 0.721688},
                                           {0.408248, 0.408248, 0.408248, 1.22474}};

    // faces of the object
    moris::Mat<moris::uint> tTriangles = {{0, 0, 1, 0},
                                          {1, 3, 2, 2},
                                          {3, 2, 3, 1}};
    // a hierarchical mesh
    moris::uint tModelDim = 3; // ModelDimension
    moris::uint tPolynomial = 1; // Polynomial degree of the shape functions
    moris::Mat<moris::uint> tNumElements ={{16,16,16}}; // Number of Elements in each direction
    moris::Mat<moris::real> tDimensions ={{1.2,1.2,1.2}}; // Number of Elements in each direction
    moris::Mat<moris::real> tOrigin = {{0.4,0.2660265,0.216494}};

    moris::Hierarchical_Mesh_Main tHMR(tModelDim,tPolynomial,tNumElements,tDimensions);
    tHMR.set_point_of_origin(tOrigin);
    tHMR.create_mesh();

    // create wrapper
    ge::MeshWrapper tMesh(tHMR);

    // create internal mesh dataobject
    ge::SDFMeshData tMeshData(tMesh);

    // create SDF core
    ge::SDFCore tCore(tMesh, tMeshData, tNodeCoords, tTriangles);

    // update mesh data
    tMeshData.update();

    // run core
    tCore.calculate_sdf();

    // get inside Flags
    auto tInsideFlags = tCore.get_inside_flags();

    SECTION("ge::SDFCore : Inside Flags"){
        moris::Mat<moris::uint> tSolution = { {1523},{1524},{1525},{1526},{1527},{1528},{1529},{1530},
                                              {1531},{1532},{1533},{1534},{1535},{1543},{1544},{1545},
                                              {1546},{1547},{1548},{1549},{1550},{1551},{1552},{1553},
                                              {1563},{1564},{1565},{1566},{1567},{1568},{1569},{1570},
                                              {1571},{1582},{1583},{1584},{1585},{1586},{1587},{1588},
                                              {1589},{1590},{1602},{1603},{1604},{1605},{1606},{1607},
                                              {1608},{1621},{1622},{1623},{1624},{1625},{1626},{1627},
                                              {1641},{1642},{1643},{1644},{1645},{1661},{1662},{1663},
                                              {1680},{1681},{1682},{1700},{1719},{1885},{1886},{1887},
                                              {1888},{1889},{1890},{1891},{1892},{1893},{1894},{1895},
                                              {1904},{1905},{1906},{1907},{1908},{1909},{1910},{1911},
                                              {1912},{1913},{1914},{1924},{1925},{1926},{1927},{1928},
                                              {1929},{1930},{1931},{1932},{1944},{1945},{1946},{1947},
                                              {1948},{1949},{1950},{1963},{1964},{1965},{1966},{1967},
                                              {1968},{1969},{1983},{1984},{1985},{1986},{1987},{2002},
                                              {2003},{2004},{2005},{2006},{2022},{2023},{2024},{2041},
                                              {2042},{2043},{2061},{2266},{2267},{2268},{2269},{2270},
                                              {2271},{2272},{2273},{2274},{2285},{2286},{2287},{2288},
                                              {2289},{2290},{2291},{2292},{2293},{2305},{2306},{2307},
                                              {2308},{2309},{2310},{2311},{2325},{2326},{2327},{2328},
                                              {2329},{2344},{2345},{2346},{2347},{2348},{2364},{2365},
                                              {2366},{2383},{2384},{2385},{2403},{2422},{2627},{2628},
                                              {2629},{2630},{2631},{2632},{2633},{2634},{2635},{2647},
                                              {2648},{2649},{2650},{2651},{2652},{2653},{2666},{2667},
                                              {2668},{2669},{2670},{2671},{2672},{2686},{2687},{2688},
                                              {2689},{2690},{2706},{2707},{2708},{2725},{2726},{2727},
                                              {2745},{2764},{2989},{2990},{2991},{2992},{2993},{2994},
                                              {2995},{3008},{3009},{3010},{3011},{3012},{3013},{3014},
                                              {3028},{3029},{3030},{3031},{3032},{3047},{3048},{3049},
                                              {3050},{3051},{3067},{3068},{3069},{3087},{3106},{3370},
                                              {3371},{3372},{3373},{3374},{3389},{3390},{3391},{3392},
                                              {3393},{3409},{3410},{3411},{3428},{3429},{3430},{3448},
                                              {3731},{3732},{3733},{3734},{3735},{3751},{3752},{3753},
                                              {3770},{3771},{3772},{3790},{3809},{4092},{4093},{4094},
                                              {4095},{4096},{4112},{4113},{4114},{4132},{4151},{4473},
                                              {4474},{4475},{4493},{4835},{4854},{5196}};


        // count flags
        moris::uint tNumberOfFlags = 0;
        for (moris::uint k=0; k < tMesh.get_number_of_nodes(); ++k){
            if(tInsideFlags.test(k)){
                ++tNumberOfFlags;
            }

        }
        REQUIRE(tSolution.length() == tNumberOfFlags);

        // compare flags
        moris::bool_t tCheck = true;
        tNumberOfFlags = 0;
        for (moris::uint k=0; k<tMesh.get_number_of_nodes(); ++k){
            if(tInsideFlags.test(k)) {
                tCheck = tCheck && tSolution(tNumberOfFlags) == k;
                ++tNumberOfFlags;
            }
        }
        REQUIRE(tCheck);
    }


    tCore.set_buffer_epsilon(0.01);

    SECTION("ge::SDFCore : Candidates (search depth 0)"){
        moris::real tBuffer;
        moris::BoostBitset tCandidateFlags;
        tCore.set_candidate_search_depth(0);
        moris::Mat<moris::uint> tSolution = {{1142},{1143},{1144},{1145},{1146},{1147},{1148},{1149},
                                             {1150},{1151},{1152},{1153},{1154},{1155},{1156},{1161},
                                             {1162},{1163},{1164},{1165},{1166},{1167},{1168},{1169},
                                             {1170},{1171},{1172},{1173},{1174},{1175},{1180},{1181},
                                             {1182},{1183},{1184},{1185},{1186},{1187},{1188},{1189},
                                             {1190},{1191},{1192},{1193},{1194},{1200},{1201},{1202},
                                             {1203},{1204},{1205},{1206},{1207},{1208},{1209},{1210},
                                             {1211},{1212},{1220},{1221},{1222},{1223},{1224},{1225},
                                             {1226},{1227},{1228},{1229},{1230},{1239},{1240},{1241},
                                             {1242},{1243},{1244},{1245},{1246},{1247},{1248},{1249},
                                             {1259},{1260},{1261},{1262},{1263},{1264},{1265},{1266},
                                             {1267},{1278},{1279},{1280},{1281},{1282},{1283},{1284},
                                             {1285},{1286},{1298},{1299},{1300},{1301},{1302},{1303},
                                             {1304},{1318},{1319},{1320},{1321},{1322},{1337},{1338},
                                             {1339},{1340},{1341},{1357},{1358},{1359},{1376},{1377},
                                             {1378},{1503},{1504},{1505},{1506},{1507},{1508},{1509},
                                             {1510},{1511},{1512},{1513},{1514},{1515},{1516},{1517},
                                             {1522},{1523},{1524},{1525},{1526},{1527},{1528},{1529},
                                             {1530},{1531},{1532},{1533},{1534},{1535},{1536},{1541},
                                             {1542},{1543},{1544},{1545},{1546},{1547},{1548},{1549},
                                             {1550},{1551},{1552},{1553},{1554},{1555},{1561},{1562},
                                             {1563},{1564},{1565},{1566},{1567},{1568},{1569},{1570},
                                             {1571},{1572},{1573},{1581},{1582},{1583},{1584},{1585},
                                             {1586},{1587},{1588},{1589},{1590},{1591},{1600},{1601},
                                             {1602},{1603},{1604},{1605},{1606},{1607},{1608},{1609},
                                             {1610},{1620},{1621},{1622},{1623},{1624},{1625},{1626},
                                             {1627},{1628},{1639},{1640},{1641},{1642},{1643},{1644},
                                             {1645},{1646},{1647},{1659},{1660},{1661},{1662},{1663},
                                             {1664},{1665},{1679},{1680},{1681},{1682},{1683},{1698},
                                             {1699},{1700},{1701},{1702},{1718},{1719},{1720},{1737},
                                             {1738},{1739},{1864},{1865},{1866},{1867},{1868},{1869},
                                             {1870},{1871},{1872},{1873},{1874},{1875},{1876},{1877},
                                             {1878},{1883},{1884},{1885},{1886},{1887},{1888},{1889},
                                             {1890},{1891},{1892},{1893},{1894},{1895},{1896},{1897},
                                             {1902},{1903},{1904},{1905},{1906},{1907},{1908},{1909},
                                             {1910},{1911},{1912},{1913},{1914},{1915},{1916},{1922},
                                             {1923},{1924},{1925},{1931},{1932},{1933},{1934},{1942},
                                             {1943},{1944},{1945},{1949},{1950},{1951},{1952},{1961},
                                             {1962},{1963},{1964},{1968},{1969},{1970},{1971},{1981},
                                             {1982},{1983},{1984},{1986},{1987},{1988},{1989},{2000},
                                             {2001},{2002},{2003},{2005},{2006},{2007},{2008},{2020},
                                             {2021},{2022},{2023},{2024},{2025},{2026},{2040},{2041},
                                             {2042},{2043},{2044},{2059},{2060},{2061},{2062},{2063},
                                             {2079},{2080},{2081},{2098},{2099},{2100},{2226},{2227},
                                             {2228},{2229},{2230},{2231},{2232},{2233},{2234},{2235},
                                             {2236},{2237},{2238},{2245},{2246},{2247},{2248},{2249},
                                             {2250},{2251},{2252},{2253},{2254},{2255},{2256},{2257},
                                             {2264},{2265},{2266},{2267},{2268},{2269},{2270},{2271},
                                             {2272},{2273},{2274},{2275},{2276},{2283},{2284},{2285},
                                             {2286},{2292},{2293},{2294},{2295},{2303},{2304},{2305},
                                             {2306},{2310},{2311},{2312},{2313},{2323},{2324},{2325},
                                             {2326},{2328},{2329},{2330},{2331},{2342},{2343},{2344},
                                             {2345},{2347},{2348},{2349},{2350},{2362},{2363},{2364},
                                             {2365},{2366},{2367},{2368},{2381},{2382},{2383},{2384},
                                             {2385},{2386},{2387},{2401},{2402},{2403},{2404},{2405},
                                             {2420},{2421},{2422},{2423},{2424},{2440},{2441},{2442},
                                             {2607},{2608},{2609},{2610},{2611},{2612},{2613},{2614},
                                             {2615},{2616},{2617},{2626},{2627},{2628},{2629},{2630},
                                             {2631},{2632},{2633},{2634},{2635},{2636},{2645},{2646},
                                             {2647},{2648},{2652},{2653},{2654},{2655},{2664},{2665},
                                             {2666},{2667},{2671},{2672},{2673},{2674},{2684},{2685},
                                             {2686},{2687},{2689},{2690},{2691},{2692},{2704},{2705},
                                             {2706},{2707},{2708},{2709},{2710},{2723},{2724},{2725},
                                             {2726},{2727},{2728},{2729},{2743},{2744},{2745},{2746},
                                             {2747},{2762},{2763},{2764},{2765},{2766},{2782},{2783},
                                             {2784},{2801},{2802},{2803},{2968},{2969},{2970},{2971},
                                             {2972},{2973},{2974},{2975},{2976},{2977},{2978},{2987},
                                             {2988},{2989},{2990},{2991},{2992},{2993},{2994},{2995},
                                             {2996},{2997},{3006},{3007},{3008},{3009},{3010},{3011},
                                             {3012},{3013},{3014},{3015},{3016},{3026},{3027},{3028},
                                             {3029},{3031},{3032},{3033},{3034},{3045},{3046},{3047},
                                             {3048},{3050},{3051},{3052},{3053},{3065},{3066},{3067},
                                             {3068},{3069},{3070},{3071},{3085},{3086},{3087},{3088},
                                             {3089},{3104},{3105},{3106},{3107},{3108},{3124},{3125},
                                             {3126},{3143},{3144},{3145},{3330},{3331},{3332},{3333},
                                             {3334},{3335},{3336},{3337},{3338},{3349},{3350},{3351},
                                             {3352},{3353},{3354},{3355},{3356},{3357},{3368},{3369},
                                             {3370},{3371},{3372},{3373},{3374},{3375},{3376},{3387},
                                             {3388},{3389},{3390},{3392},{3393},{3394},{3395},{3407},
                                             {3408},{3409},{3410},{3411},{3412},{3413},{3426},{3427},
                                             {3428},{3429},{3430},{3431},{3432},{3446},{3447},{3448},
                                             {3449},{3450},{3466},{3467},{3468},{3485},{3486},{3487},
                                             {3711},{3712},{3713},{3714},{3715},{3716},{3717},{3730},
                                             {3731},{3732},{3733},{3734},{3735},{3736},{3749},{3750},
                                             {3751},{3752},{3753},{3754},{3755},{3768},{3769},{3770},
                                             {3771},{3772},{3773},{3774},{3788},{3789},{3790},{3791},
                                             {3792},{3807},{3808},{3809},{3810},{3811},{3827},{3828},
                                             {3829},{4072},{4073},{4074},{4075},{4076},{4077},{4078},
                                             {4091},{4092},{4093},{4094},{4095},{4096},{4097},{4110},
                                             {4111},{4112},{4113},{4114},{4115},{4116},{4130},{4131},
                                             {4132},{4133},{4134},{4149},{4150},{4151},{4152},{4153},
                                             {4169},{4170},{4171},{4188},{4189},{4190},{4433},{4434},
                                             {4435},{4436},{4437},{4438},{4439},{4452},{4453},{4454},
                                             {4455},{4456},{4457},{4458},{4471},{4472},{4473},{4474},
                                             {4475},{4476},{4477},{4491},{4492},{4493},{4494},{4495},
                                             {4511},{4512},{4513},{4530},{4531},{4532},{4814},{4815},
                                             {4816},{4817},{4818},{4833},{4834},{4835},{4836},{4837},
                                             {4852},{4853},{4854},{4855},{4856},{4872},{4873},{4874},
                                             {5176},{5177},{5178},{5195},{5196},{5197},{5214},{5215},
                                             {5216},{5233},{5234},{5235},{5537},{5538},{5539},{5556},
                                             {5557},{5558},{5575},{5576},{5577}};




        tCore.calculate_candidate_points_and_buffer_diagonal(tInsideFlags, tCandidateFlags, tBuffer);

        // count flags
        moris::uint tNumberOfFlags = 0;
        for (moris::uint k=0; k < tMesh.get_number_of_nodes(); ++k){
            if(tCandidateFlags.test(k)){
                ++tNumberOfFlags;
            }

        }
        REQUIRE(tSolution.length() == tNumberOfFlags);

        // compare flags
        moris::bool_t tCheck = true;
        tNumberOfFlags = 0;
        for (moris::uint k=0; k<tMesh.get_number_of_nodes(); ++k){
            if(tCandidateFlags.test(k)) {
                tCheck = tCheck && tSolution(tNumberOfFlags) == k;
                ++tNumberOfFlags;
            }
        }
        REQUIRE(tCheck);
    }

    SECTION("ge::SDFCore : Candidates (search depth 2)"){
        tCore.set_candidate_search_depth(2);
        moris::Mat<moris::uint> tSolution = {{380},{381},{382},{383},{384},{385},{386},{387},
                                             {388},{389},{390},{391},{392},{393},{394},{395},
                                             {396},{397},{398},{399},{400},{401},{402},{403},
                                             {404},{405},{406},{407},{408},{409},{410},{411},
                                             {412},{413},{414},{415},{416},{417},{418},{419},
                                             {420},{421},{422},{423},{424},{425},{426},{427},
                                             {428},{429},{430},{431},{432},{433},{434},{435},
                                             {436},{437},{438},{439},{440},{441},{442},{443},
                                             {444},{445},{446},{447},{448},{449},{450},{451},
                                             {452},{453},{454},{455},{456},{457},{458},{459},
                                             {460},{461},{462},{463},{464},{465},{466},{467},
                                             {468},{469},{470},{471},{472},{473},{474},{475},
                                             {476},{477},{478},{479},{480},{481},{482},{483},
                                             {484},{485},{486},{487},{488},{489},{490},{491},
                                             {492},{493},{494},{495},{496},{497},{498},{499},
                                             {500},{501},{502},{503},{504},{505},{506},{507},
                                             {508},{509},{510},{511},{512},{514},{515},{516},
                                             {517},{518},{519},{520},{521},{522},{523},{524},
                                             {525},{526},{527},{528},{529},{530},{534},{535},
                                             {536},{537},{538},{539},{540},{541},{542},{543},
                                             {544},{545},{546},{547},{548},{553},{554},{555},
                                             {556},{557},{558},{559},{560},{561},{562},{563},
                                             {564},{565},{566},{567},{573},{574},{575},{576},
                                             {577},{578},{579},{580},{581},{582},{583},{584},
                                             {585},{592},{593},{594},{595},{596},{597},{598},
                                             {599},{600},{601},{602},{603},{604},{612},{613},
                                             {614},{615},{616},{617},{618},{619},{620},{621},
                                             {622},{632},{633},{634},{635},{636},{637},{638},
                                             {639},{640},{651},{652},{653},{654},{655},{656},
                                             {657},{658},{659},{671},{672},{673},{674},{675},
                                             {676},{677},{690},{691},{692},{693},{694},{695},
                                             {696},{741},{742},{743},{744},{745},{746},{747},
                                             {748},{749},{750},{751},{752},{753},{754},{755},
                                             {756},{757},{758},{759},{760},{761},{762},{763},
                                             {764},{765},{766},{767},{768},{769},{770},{771},
                                             {772},{773},{774},{775},{776},{777},{778},{779},
                                             {780},{781},{782},{783},{784},{785},{786},{787},
                                             {788},{789},{790},{791},{792},{793},{794},{795},
                                             {796},{797},{798},{799},{800},{801},{802},{803},
                                             {804},{805},{806},{807},{808},{809},{810},{811},
                                             {812},{813},{814},{815},{816},{817},{818},{819},
                                             {820},{821},{822},{823},{824},{825},{826},{827},
                                             {828},{829},{830},{831},{832},{833},{834},{835},
                                             {836},{837},{838},{839},{840},{841},{842},{843},
                                             {844},{845},{846},{847},{848},{849},{850},{851},
                                             {852},{853},{854},{855},{856},{857},{858},{859},
                                             {860},{861},{862},{863},{864},{865},{866},{867},
                                             {868},{869},{870},{871},{872},{873},{875},{876},
                                             {877},{878},{879},{880},{881},{882},{883},{884},
                                             {885},{886},{887},{888},{889},{890},{891},{895},
                                             {896},{897},{898},{899},{900},{901},{902},{903},
                                             {904},{905},{906},{907},{908},{909},{914},{915},
                                             {916},{917},{918},{919},{920},{921},{922},{923},
                                             {924},{925},{926},{927},{928},{934},{935},{936},
                                             {937},{938},{939},{940},{941},{942},{943},{944},
                                             {945},{946},{953},{954},{955},{956},{957},{958},
                                             {959},{960},{961},{962},{963},{964},{965},{973},
                                             {974},{975},{976},{977},{978},{979},{980},{981},
                                             {982},{983},{993},{994},{995},{996},{997},{998},
                                             {999},{1000},{1001},{1012},{1013},{1014},{1015},{1016},
                                             {1017},{1018},{1019},{1020},{1032},{1033},{1034},{1035},
                                             {1036},{1037},{1038},{1051},{1052},{1053},{1054},{1055},
                                             {1056},{1057},{1102},{1103},{1104},{1105},{1106},{1107},
                                             {1108},{1109},{1110},{1111},{1112},{1113},{1114},{1115},
                                             {1116},{1117},{1118},{1119},{1120},{1121},{1122},{1123},
                                             {1124},{1125},{1126},{1127},{1128},{1129},{1130},{1131},
                                             {1132},{1133},{1134},{1135},{1136},{1137},{1138},{1139},
                                             {1140},{1141},{1142},{1143},{1144},{1145},{1146},{1147},
                                             {1148},{1149},{1150},{1151},{1152},{1153},{1154},{1155},
                                             {1156},{1157},{1158},{1159},{1160},{1161},{1162},{1163},
                                             {1164},{1165},{1166},{1167},{1168},{1169},{1170},{1171},
                                             {1172},{1173},{1174},{1175},{1176},{1177},{1178},{1179},
                                             {1180},{1181},{1182},{1183},{1184},{1185},{1186},{1187},
                                             {1188},{1189},{1190},{1191},{1192},{1193},{1194},{1195},
                                             {1196},{1197},{1198},{1199},{1200},{1201},{1202},{1203},
                                             {1204},{1205},{1206},{1207},{1208},{1209},{1210},{1211},
                                             {1212},{1213},{1214},{1215},{1216},{1217},{1218},{1219},
                                             {1220},{1221},{1222},{1223},{1224},{1225},{1226},{1227},
                                             {1228},{1229},{1230},{1231},{1232},{1233},{1234},{1236},
                                             {1237},{1238},{1239},{1240},{1241},{1242},{1243},{1244},
                                             {1245},{1246},{1247},{1248},{1249},{1250},{1251},{1252},
                                             {1256},{1257},{1258},{1259},{1260},{1261},{1262},{1263},
                                             {1264},{1265},{1266},{1267},{1268},{1269},{1270},{1275},
                                             {1276},{1277},{1278},{1279},{1280},{1281},{1282},{1283},
                                             {1284},{1285},{1286},{1287},{1288},{1289},{1295},{1296},
                                             {1297},{1298},{1299},{1300},{1301},{1302},{1303},{1304},
                                             {1305},{1306},{1307},{1314},{1315},{1316},{1317},{1318},
                                             {1319},{1320},{1321},{1322},{1323},{1324},{1325},{1326},
                                             {1334},{1335},{1336},{1337},{1338},{1339},{1340},{1341},
                                             {1342},{1343},{1344},{1354},{1355},{1356},{1357},{1358},
                                             {1359},{1360},{1361},{1362},{1373},{1374},{1375},{1376},
                                             {1377},{1378},{1379},{1380},{1381},{1393},{1394},{1395},
                                             {1396},{1397},{1398},{1399},{1412},{1413},{1414},{1415},
                                             {1416},{1417},{1418},{1463},{1464},{1465},{1466},{1467},
                                             {1468},{1469},{1470},{1471},{1472},{1473},{1474},{1475},
                                             {1476},{1477},{1478},{1479},{1480},{1481},{1482},{1483},
                                             {1484},{1485},{1486},{1487},{1488},{1489},{1490},{1491},
                                             {1492},{1493},{1494},{1495},{1496},{1497},{1498},{1499},
                                             {1500},{1501},{1502},{1503},{1504},{1505},{1506},{1507},
                                             {1508},{1509},{1510},{1511},{1512},{1513},{1514},{1515},
                                             {1516},{1517},{1518},{1519},{1520},{1521},{1522},{1523},
                                             {1524},{1525},{1526},{1527},{1528},{1529},{1530},{1531},
                                             {1532},{1533},{1534},{1535},{1536},{1537},{1538},{1539},
                                             {1540},{1541},{1542},{1543},{1544},{1545},{1546},{1547},
                                             {1548},{1549},{1550},{1551},{1552},{1553},{1554},{1555},
                                             {1556},{1557},{1558},{1559},{1560},{1561},{1562},{1563},
                                             {1564},{1565},{1566},{1567},{1568},{1569},{1570},{1571},
                                             {1572},{1573},{1574},{1575},{1576},{1577},{1578},{1579},
                                             {1580},{1581},{1582},{1583},{1584},{1585},{1586},{1587},
                                             {1588},{1589},{1590},{1591},{1592},{1593},{1594},{1595},
                                             {1597},{1598},{1599},{1600},{1601},{1602},{1603},{1604},
                                             {1605},{1606},{1607},{1608},{1609},{1610},{1611},{1612},
                                             {1613},{1617},{1618},{1619},{1620},{1621},{1622},{1623},
                                             {1624},{1625},{1626},{1627},{1628},{1629},{1630},{1631},
                                             {1636},{1637},{1638},{1639},{1640},{1641},{1642},{1643},
                                             {1644},{1645},{1646},{1647},{1648},{1649},{1650},{1656},
                                             {1657},{1658},{1659},{1660},{1661},{1662},{1663},{1664},
                                             {1665},{1666},{1667},{1668},{1675},{1676},{1677},{1678},
                       return                      {1679},{1680},{1681},{1682},{1683},{1684},{1685},{1686},
                                             {1687},{1695},{1696},{1697},{1698},{1699},{1700},{1701},
                                             {1702},{1703},{1704},{1705},{1715},{1716},{1717},{1718},
                                             {1719},{1720},{1721},{1722},{1723},{1734},{1735},{1736},
                                             {1737},{1738},{1739},{1740},{1741},{1742},{1754},{1755},
                                             {1756},{1757},{1758},{1759},{1760},{1773},{1774},{1775},
                                             {1776},{1777},{1778},{1779},{1824},{1825},{1826},{1827},
                                             {1828},{1829},{1830},{1831},{1832},{1833},{1834},{1835},
                                             {1836},{1837},{1838},{1839},{1840},{1841},{1842},{1843},
                                             {1844},{1845},{1846},{1847},{1848},{1849},{1850},{1851},
                                             {1852},{1853},{1854},{1855},{1856},{1857},{1858},{1859},
                                             {1860},{1861},{1862},{1863},{1864},{1865},{1866},{1867},
                                             {1868},{1869},{1870},{1871},{1872},{1873},{1874},{1875},
                                             {1876},{1877},{1878},{1879},{1880},{1881},{1882},{1883},
                                             {1884},{1885},{1886},{1887},{1888},{1889},{1890},{1891},
                                             {1892},{1893},{1894},{1895},{1896},{1897},{1898},{1899},
                                             {1900},{1901},{1902},{1903},{1904},{1905},{1906},{1907},
                                             {1908},{1909},{1910},{1911},{1912},{1913},{1914},{1915},
                                             {1916},{1917},{1918},{1919},{1920},{1921},{1922},{1923},
                                             {1924},{1925},{1926},{1927},{1928},{1929},{1930},{1931},
                                             {1932},{1933},{1934},{1935},{1936},{1937},{1938},{1939},
                                             {1940},{1941},{1942},{1943},{1944},{1945},{1946},{1947},
                                             {1948},{1949},{1950},{1951},{1952},{1953},{1954},{1955},
                                             {1956},{1958},{1959},{1960},{1961},{1962},{1963},{1964},
                                             {1965},{1966},{1967},{1968},{1969},{1970},{1971},{1972},
                                             {1973},{1974},{1978},{1979},{1980},{1981},{1982},{1983},
                                             {1984},{1985},{1986},{1987},{1988},{1989},{1990},{1991},
                                             {1992},{1997},{1998},{1999},{2000},{2001},{2002},{2003},
                                             {2004},{2005},{2006},{2007},{2008},{2009},{2010},{2011},
                                             {2017},{2018},{2019},{2020},{2021},{2022},{2023},{2024},
                                             {2025},{2026},{2027},{2028},{2029},{2036},{2037},{2038},
                                             {2039},{2040},{2041},{2042},{2043},{2044},{2045},{2046},
                                             {2047},{2048},{2056},{2057},{2058},{2059},{2060},{2061},
                                             {2062},{2063},{2064},{2065},{2066},{2076},{2077},{2078},
                                             {2079},{2080},{2081},{2082},{2083},{2084},{2095},{2096},
                                             {2097},{2098},{2099},{2100},{2101},{2102},{2103},{2115},
                                             {2116},{2117},{2118},{2119},{2120},{2121},{2134},{2135},
                                             {2136},{2137},{2138},{2139},{2140},{2185},{2186},{2187},
                                             {2188},{2189},{2190},{2191},{2192},{2193},{2194},{2195},
                                             {2196},{2197},{2198},{2199},{2200},{2201},{2202},{2203},
                                             {2204},{2205},{2206},{2207},{2208},{2209},{2210},{2211},
                                             {2212},{2213},{2214},{2215},{2216},{2217},{2218},{2219},
                                             {2220},{2221},{2222},{2223},{2224},{2225},{2226},{2227},
                                             {2228},{2229},{2230},{2231},{2232},{2233},{2234},{2235},
                                             {2236},{2237},{2238},{2239},{2240},{2241},{2242},{2243},
                                             {2244},{2245},{2246},{2247},{2248},{2249},{2250},{2251},
                                             {2252},{2253},{2254},{2255},{2256},{2257},{2258},{2259},
                                             {2260},{2261},{2262},{2263},{2264},{2265},{2266},{2267},
                                             {2268},{2269},{2270},{2271},{2272},{2273},{2274},{2275},
                                             {2276},{2277},{2278},{2279},{2280},{2281},{2282},{2283},
                                             {2284},{2285},{2286},{2287},{2288},{2289},{2290},{2291},
                                             {2292},{2293},{2294},{2295},{2296},{2297},{2298},{2299},
                                             {2300},{2301},{2302},{2303},{2304},{2305},{2306},{2307},
                                             {2308},{2309},{2310},{2311},{2312},{2313},{2314},{2315},
                                             {2316},{2317},{2319},{2320},{2321},{2322},{2323},{2324},
                                             {2325},{2326},{2327},{2328},{2329},{2330},{2331},{2332},
                                             {2333},{2334},{2335},{2339},{2340},{2341},{2342},{2343},
                                             {2344},{2345},{2346},{2347},{2348},{2349},{2350},{2351},
                                             {2352},{2353},{2358},{2359},{2360},{2361},{2362},{2363},
                                             {2364},{2365},{2366},{2367},{2368},{2369},{2370},{2371},
                                             {2372},{2378},{2379},{2380},{2381},{2382},{2383},{2384},
                                             {2385},{2386},{2387},{2388},{2389},{2390},{2397},{2398},
                                             {2399},{2400},{2401},{2402},{2403},{2404},{2405},{2406},
                                             {2407},{2408},{2409},{2417},{2418},{2419},{2420},{2421},
                                             {2422},{2423},{2424},{2425},{2426},{2427},{2437},{2438},
                                             {2439},{2440},{2441},{2442},{2443},{2444},{2445},{2456},
                                             {2457},{2458},{2459},{2460},{2461},{2462},{2463},{2464},
                                             {2476},{2477},{2478},{2479},{2480},{2481},{2482},{2495},
                                             {2496},{2497},{2498},{2499},{2500},{2501},{2546},{2547},
                                             {2548},{2549},{2550},{2551},{2552},{2553},{2554},{2555},
                                             {2556},{2557},{2558},{2559},{2560},{2561},{2562},{2563},
                                             {2564},{2565},{2566},{2567},{2568},{2569},{2570},{2571},
                                             {2572},{2573},{2574},{2575},{2576},{2577},{2578},{2579},
                                             {2580},{2581},{2582},{2583},{2584},{2585},{2586},{2587},
                                             {2588},{2589},{2590},{2591},{2592},{2593},{2594},{2595},
                                             {2596},{2597},{2598},{2599},{2600},{2601},{2602},{2603},
                                             {2604},{2605},{2606},{2607},{2608},{2609},{2610},{2611},
                                             {2612},{2613},{2614},{2615},{2616},{2617},{2618},{2619},
                                             {2620},{2621},{2622},{2623},{2624},{2625},{2626},{2627},
                                             {2628},{2629},{2630},{2631},{2632},{2633},{2634},{2635},
                                             {2636},{2637},{2638},{2639},{2640},{2641},{2642},{2643},
                                             {2644},{2645},{2646},{2647},{2648},{2649},{2650},{2651},
                                             {2652},{2653},{2654},{2655},{2656},{2657},{2658},{2659},
                                             {2660},{2661},{2662},{2663},{2664},{2665},{2666},{2667},
                                             {2668},{2669},{2670},{2671},{2672},{2673},{2674},{2675},
                                             {2676},{2677},{2678},{2680},{2681},{2682},{2683},{2684},
                                             {2685},{2686},{2687},{2688},{2689},{2690},{2691},{2692},
                                             {2693},{2694},{2695},{2696},{2700},{2701},{2702},{2703},
                                             {2704},{2705},{2706},{2707},{2708},{2709},{2710},{2711},
                                             {2712},{2713},{2714},{2719},{2720},{2721},{2722},{2723},
                                             {2724},{2725},{2726},{2727},{2728},{2729},{2730},{2731},
                                             {2732},{2733},{2739},{2740},{2741},{2742},{2743},{2744},
                                             {2745},{2746},{2747},{2748},{2749},{2750},{2751},{2758},
                                             {2759},{2760},{2761},{2762},{2763},{2764},{2765},{2766},
                                             {2767},{2768},{2769},{2770},{2778},{2779},{2780},{2781},
                                             {2782},{2783},{2784},{2785},{2786},{2787},{2788},{2798},
                                             {2799},{2800},{2801},{2802},{2803},{2804},{2805},{2806},
                                             {2817},{2818},{2819},{2820},{2821},{2822},{2823},{2824},
                                             {2825},{2837},{2838},{2839},{2840},{2841},{2842},{2843},
                                             {2856},{2857},{2858},{2859},{2860},{2861},{2862},{2908},
                                             {2909},{2910},{2911},{2912},{2913},{2914},{2915},{2916},
                                             {2917},{2918},{2919},{2920},{2921},{2922},{2923},{2924},
                                             {2927},{2928},{2929},{2930},{2931},{2932},{2933},{2934},
                                             {2935},{2936},{2937},{2938},{2939},{2940},{2941},{2942},
                                             {2943},{2946},{2947},{2948},{2949},{2950},{2951},{2952},
                                             {2953},{2954},{2955},{2956},{2957},{2958},{2959},{2960},
                                             {2961},{2962},{2965},{2966},{2967},{2968},{2969},{2970},
                                             {2971},{2972},{2973},{2974},{2975},{2976},{2977},{2978},
                                             {2979},{2980},{2981},{2984},{2985},{2986},{2987},{2988},
                                             {2989},{2990},{2991},{2992},{2993},{2994},{2995},{2996},
                                             {2997},{2998},{2999},{3000},{3003},{3004},{3005},{3006},
                                             {3007},{3008},{3009},{3010},{3011},{3012},{3013},{3014},
                                             {3015},{3016},{3017},{3018},{3019},{3022},{3023},{3024},
                                             {3025},{3026},{3027},{3028},{3029},{3030},{3031},{3032},
                                             {3033},{3034},{3035},{3036},{3037},{3038},{3041},{3042},
                                             {3043},{3044},{3045},{3046},{3047},{3048},{3049},{3050},
                                             {3051},{3052},{3053},{3054},{3055},{3056},{3057},{3061},
                                             {3062},{3063},{3064},{3065},{3066},{3067},{3068},{3069},
                                             {3070},{3071},{3072},{3073},{3074},{3075},{3081},{3082},
                                             {3083},{3084},{3085},{3086},{3087},{3088},{3089},{3090},
                                             {3091},{3092},{3093},{3100},{3101},{3102},{3103},{3104},
                                             {3105},{3106},{3107},{3108},{3109},{3110},{3111},{3112},
                                             {3120},{3121},{3122},{3123},{3124},{3125},{3126},{3127},
                                             {3128},{3129},{3130},{3139},{3140},{3141},{3142},{3143},
                       return                      {3144},{3145},{3146},{3147},{3148},{3149},{3159},{3160},
                                             {3161},{3162},{3163},{3164},{3165},{3166},{3167},{3178},
                                             {3179},{3180},{3181},{3182},{3183},{3184},{3185},{3186},
                                             {3198},{3199},{3200},{3201},{3202},{3203},{3204},{3289},
                                             {3290},{3291},{3292},{3293},{3294},{3295},{3296},{3297},
                                             {3298},{3299},{3300},{3301},{3302},{3303},{3308},{3309},
                                             {3310},{3311},{3312},{3313},{3314},{3315},{3316},{3317},
                                             {3318},{3319},{3320},{3321},{3322},{3327},{3328},{3329},
                                             {3330},{3331},{3332},{3333},{3334},{3335},{3336},{3337},
                                             {3338},{3339},{3340},{3341},{3346},{3347},{3348},{3349},
                                             {3350},{3351},{3352},{3353},{3354},{3355},{3356},{3357},
                                             {3358},{3359},{3360},{3365},{3366},{3367},{3368},{3369},
                                             {3370},{3371},{3372},{3373},{3374},{3375},{3376},{3377},
                                             {3378},{3379},{3384},{3385},{3386},{3387},{3388},{3389},
                                             {3390},{3391},{3392},{3393},{3394},{3395},{3396},{3397},
                                             {3398},{3403},{3404},{3405},{3406},{3407},{3408},{3409},
                                             {3410},{3411},{3412},{3413},{3414},{3415},{3416},{3417},
                                             {3422},{3423},{3424},{3425},{3426},{3427},{3428},{3429},
                                             {3430},{3431},{3432},{3433},{3434},{3435},{3436},{3442},
                                             {3443},{3444},{3445},{3446},{3447},{3448},{3449},{3450},
                                             {3451},{3452},{3453},{3454},{3462},{3463},{3464},{3465},
                                             {3466},{3467},{3468},{3469},{3470},{3471},{3472},{3481},
                                             {3482},{3483},{3484},{3485},{3486},{3487},{3488},{3489},
                                             {3490},{3491},{3501},{3502},{3503},{3504},{3505},{3506},
                                             {3507},{3508},{3509},{3520},{3521},{3522},{3523},{3524},
                                             {3525},{3526},{3527},{3528},{3540},{3541},{3542},{3543},
                                             {3544},{3545},{3546},{3559},{3560},{3561},{3562},{3563},
                                             {3564},{3565},{3650},{3651},{3652},{3653},{3654},{3655},
                                             {3656},{3657},{3658},{3659},{3660},{3661},{3662},{3663},
                                             {3664},{3669},{3670},{3671},{3672},{3673},{3674},{3675},
                                             {3676},{3677},{3678},{3679},{3680},{3681},{3682},{3683},
                                             {3688},{3689},{3690},{3691},{3692},{3693},{3694},{3695},
                                             {3696},{3697},{3698},{3699},{3700},{3701},{3702},{3707},
                                             {3708},{3709},{3710},{3711},{3712},{3713},{3714},{3715},
                                             {3716},{3717},{3718},{3719},{3720},{3721},{3726},{3727},
                                             {3728},{3729},{3730},{3731},{3732},{3733},{3734},{3735},
                                             {3736},{3737},{3738},{3739},{3740},{3745},{3746},{3747},
                                             {3748},{3749},{3750},{3751},{3752},{3753},{3754},{3755},
                                             {3756},{3757},{3758},{3759},{3764},{3765},{3766},{3767},
                                             {3768},{3769},{3770},{3771},{3772},{3773},{3774},{3775},
                                             {3776},{3777},{3778},{3784},{3785},{3786},{3787},{3788},
                                             {3789},{3790},{3791},{3792},{3793},{3794},{3795},{3796},
                                             {3803},{3804},{3805},{3806},{3807},{3808},{3809},{3810},
                                             {3811},{3812},{3813},{3814},{3815},{3823},{3824},{3825},
                                             {3826},{3827},{3828},{3829},{3830},{3831},{3832},{3833},
                                             {3843},{3844},{3845},{3846},{3847},{3848},{3849},{3850},
                                             {3851},{3862},{3863},{3864},{3865},{3866},{3867},{3868},
                                             {3869},{3870},{3882},{3883},{3884},{3885},{3886},{3887},
                                             {3888},{3901},{3902},{3903},{3904},{3905},{3906},{3907},
                                             {4012},{4013},{4014},{4015},{4016},{4017},{4018},{4019},
                                             {4020},{4021},{4022},{4023},{4024},{4031},{4032},{4033},
                                             {4034},{4035},{4036},{4037},{4038},{4039},{4040},{4041},
                                             {4042},{4043},{4050},{4051},{4052},{4053},{4054},{4055},
                                             {4056},{4057},{4058},{4059},{4060},{4061},{4062},{4069},
                                             {4070},{4071},{4072},{4073},{4074},{4075},{4076},{4077},
                                             {4078},{4079},{4080},{4081},{4088},{4089},{4090},{4091},
                                             {4092},{4093},{4094},{4095},{4096},{4097},{4098},{4099},
                                             {4100},{4107},{4108},{4109},{4110},{4111},{4112},{4113},
                                             {4114},{4115},{4116},{4117},{4118},{4119},{4126},{4127},
                                             {4128},{4129},{4130},{4131},{4132},{4133},{4134},{4135},
                                             {4136},{4137},{4138},{4145},{4146},{4147},{4148},{4149},
                                             {4150},{4151},{4152},{4153},{4154},{4155},{4156},{4157},
                                             {4165},{4166},{4167},{4168},{4169},{4170},{4171},{4172},
                                             {4173},{4174},{4175},{4184},{4185},{4186},{4187},{4188},
                                             {4189},{4190},{4191},{4192},{4193},{4194},{4204},{4205},
                                             {4206},{4207},{4208},{4209},{4210},{4211},{4212},{4224},
                                             {4225},{4226},{4227},{4228},{4229},{4230},{4243},{4244},
                                             {4245},{4246},{4247},{4248},{4249},{4393},{4394},{4395},
                                             {4396},{4397},{4398},{4399},{4400},{4401},{4402},{4403},
                                             {4412},{4413},{4414},{4415},{4416},{4417},{4418},{4419},
                                             {4420},{4421},{4422},{4431},{4432},{4433},{4434},{4435},
                                             {4436},{4437},{4438},{4439},{4440},{4441},{4450},{4451},
                                             {4452},{4453},{4454},{4455},{4456},{4457},{4458},{4459},
                                             {4460},{4469},{4470},{4471},{4472},{4473},{4474},{4475},
                                             {4476},{4477},{4478},{4479},{4488},{4489},{4490},{4491},
                                             {4492},{4493},{4494},{4495},{4496},{4497},{4498},{4507},
                                             {4508},{4509},{4510},{4511},{4512},{4513},{4514},{4515},
                                             {4516},{4517},{4526},{4527},{4528},{4529},{4530},{4531},
                                             {4532},{4533},{4534},{4535},{4536},{4546},{4547},{4548},
                                             {4549},{4550},{4551},{4552},{4553},{4554},{4565},{4566},
                                             {4567},{4568},{4569},{4570},{4571},{4572},{4573},{4585},
                                             {4586},{4587},{4588},{4589},{4590},{4591},{4754},{4755},
                                             {4756},{4757},{4758},{4759},{4760},{4761},{4762},{4763},
                                             {4764},{4773},{4774},{4775},{4776},{4777},{4778},{4779},
                                             {4780},{4781},{4782},{4783},{4792},{4793},{4794},{4795},
                                             {4796},{4797},{4798},{4799},{4800},{4801},{4802},{4811},
                                             {4812},{4813},{4814},{4815},{4816},{4817},{4818},{4819},
                                             {4820},{4821},{4830},{4831},{4832},{4833},{4834},{4835},
                                             {4836},{4837},{4838},{4839},{4840},{4849},{4850},{4851},
                                             {4852},{4853},{4854},{4855},{4856},{4857},{4858},{4859},
                                             {4868},{4869},{4870},{4871},{4872},{4873},{4874},{4875},
                                             {4876},{4877},{4878},{4888},{4889},{4890},{4891},{4892},
                                             {4893},{4894},{4895},{4896},{4907},{4908},{4909},{4910},
                                             {4911},{4912},{4913},{4914},{4915},{4927},{4928},{4929},
                                             {4930},{4931},{4932},{4933},{4946},{4947},{4948},{4949},
                                             {4950},{4951},{4952},{5115},{5116},{5117},{5118},{5119},
                                             {5120},{5121},{5122},{5123},{5124},{5125},{5134},{5135},
                                             {5136},{5137},{5138},{5139},{5140},{5141},{5142},{5143},
                                             {5144},{5153},{5154},{5155},{5156},{5157},{5158},{5159},
                                             {5160},{5161},{5162},{5163},{5172},{5173},{5174},{5175},
                                             {5176},{5177},{5178},{5179},{5180},{5181},{5182},{5191},
                                             {5192},{5193},{5194},{5195},{5196},{5197},{5198},{5199},
                                             {5200},{5201},{5210},{5211},{5212},{5213},{5214},{5215},
                                             {5216},{5217},{5218},{5219},{5220},{5229},{5230},{5231},
                                             {5232},{5233},{5234},{5235},{5236},{5237},{5238},{5239},
                                             {5249},{5250},{5251},{5252},{5253},{5254},{5255},{5256},
                                             {5257},{5269},{5270},{5271},{5272},{5273},{5274},{5275},
                                             {5288},{5289},{5290},{5291},{5292},{5293},{5294},{5496},
                                             {5497},{5498},{5499},{5500},{5501},{5502},{5503},{5504},
                                             {5515},{5516},{5517},{5518},{5519},{5520},{5521},{5522},
                                             {5523},{5534},{5535},{5536},{5537},{5538},{5539},{5540},
                                             {5541},{5542},{5553},{5554},{5555},{5556},{5557},{5558},
                                             {5559},{5560},{5561},{5572},{5573},{5574},{5575},{5576},
                                             {5577},{5578},{5579},{5580},{5591},{5592},{5593},{5594},
                                             {5595},{5596},{5597},{5598},{5599},{5610},{5611},{5612},
                                             {5613},{5614},{5615},{5616},{5617},{5618},{5630},{5631},
                                             {5632},{5633},{5634},{5635},{5636},{5858},{5859},{5860},
                                             {5861},{5862},{5863},{5864},{5877},{5878},{5879},{5880},
                                             {5881},{5882},{5883},{5896},{5897},{5898},{5899},{5900},
                       return                      {5901},{5902},{5915},{5916},{5917},{5918},{5919},{5920},
                                             {5921},{5934},{5935},{5936},{5937},{5938},{5939},{5940},
                                             {5953},{5954},{5955},{5956},{5957},{5958},{5959},{5972},
                                             {5973},{5974},{5975},{5976},{5977},{5978},{5991},{5992},
                                             {5993},{5994},{5995},{5996},{5997},{6219},{6220},{6221},
                                             {6222},{6223},{6224},{6225},{6238},{6239},{6240},{6241},
                                             {6242},{6243},{6244},{6257},{6258},{6259},{6260},{6261},
                                             {6262},{6263},{6276},{6277},{6278},{6279},{6280},{6281},
                                             {6282},{6295},{6296},{6297},{6298},{6299},{6300},{6301},
                                             {6314},{6315},{6316},{6317},{6318},{6319},{6320},{6333},
                                             {6334},{6335},{6336},{6337},{6338},{6339}};

        moris::BoostBitset tCandidateFlags;
        moris::real tBuffer;

        tCore.calculate_candidate_points_and_buffer_diagonal(tInsideFlags, tCandidateFlags, tBuffer);

        // count flags
        moris::uint tNumberOfFlags = 0;
        for (moris::uint k=0; k < tMesh.get_number_of_nodes(); ++k){
            if(tCandidateFlags.test(k)){
                ++tNumberOfFlags;
            }

        }
        REQUIRE(tSolution.length() == tNumberOfFlags);

        // compare flags
        moris::bool_t tCheck = true;
        tNumberOfFlags = 0;
        for (moris::uint k=0; k< tMesh.get_number_of_nodes(); ++k){
            if(tCandidateFlags.test(k)) {
                tCheck = tCheck && tSolution(tNumberOfFlags) == k;
                ++tNumberOfFlags;
            }
        }
        REQUIRE(tCheck);
    }

    SECTION("ge::SDFCore : Triangle vicinity"){
        moris::Mat<moris::uint> tSolution = {{1142},{1143},{1144},{1145},{1146},{1147},{1148},{1149},
                                             {1150},{1151},{1152},{1153},{1154},{1155},{1156},{1161},
                                             {1162},{1163},{1164},{1165},{1166},{1167},{1168},{1169},
                                             {1170},{1171},{1172},{1173},{1174},{1175},{1180},{1181},
                                             {1182},{1183},{1184},{1185},{1186},{1187},{1188},{1189},
                                             {1190},{1191},{1192},{1193},{1194},{1200},{1201},{1202},
                                             {1203},{1204},{1205},{1206},{1207},{1208},{1209},{1210},
                                             {1211},{1212},{1220},{1221},{1222},{1223},{1224},{1225},
                                             {1226},{1227},{1228},{1229},{1230},{1239},{1240},{1241},
                                             {1242},{1243},{1244},{1245},{1246},{1247},{1248},{1249},
                                             {1503},{1504},{1505},{1506},{1507},{1508},{1509},{1510},
                                             {1511},{1512},{1513},{1514},{1515},{1516},{1517},{1522},
                                             {1523},{1524},{1525},{1526},{1527},{1528},{1529},{1530},
                                             {1531},{1532},{1533},{1534},{1535},{1536},{1541},{1542},
                                             {1543},{1544},{1545},{1546},{1547},{1548},{1549},{1550},
                                             {1551},{1552},{1553},{1554},{1555},{1561},{1562},{1563},
                                             {1564},{1565},{1566},{1567},{1568},{1569},{1570},{1571},
                                             {1572},{1573},{1581},{1582},{1583},{1584},{1585},{1586},
                                             {1587},{1588},{1589},{1590},{1591},{1600},{1601},{1602},
                                             {1603},{1604},{1605},{1606},{1607},{1608},{1609},{1610},
                                             {1864},{1865},{1866},{1867},{1868},{1869},{1870},{1871},
                                             {1872},{1873},{1874},{1875},{1876},{1877},{1878},{1883},
                                             {1884},{1885},{1886},{1887},{1888},{1889},{1890},{1891},
                                             {1892},{1893},{1894},{1895},{1896},{1897},{1902},{1903},
                                             {1904},{1905},{1906},{1907},{1908},{1909},{1910},{1911},
                                             {1912},{1913},{1914},{1915},{1916},{1922},{1923},{1924},
                                             {1925},{1931},{1932},{1933},{1934},{1942},{1943},{1944},
                                             {1945},{1949},{1950},{1951},{1952},{1961},{1962},{1963},
                                             {1964},{1968},{1969},{1970},{1971},{2226},{2227},{2228},
                                             {2229},{2230},{2231},{2232},{2233},{2234},{2235},{2236},
                                             {2237},{2238},{2245},{2246},{2247},{2248},{2249},{2250},
                                             {2251},{2252},{2253},{2254},{2255},{2256},{2257},{2264},
                                             {2265},{2266},{2267},{2268},{2269},{2270},{2271},{2272},
                                             {2273},{2274},{2275},{2276},{2283},{2284},{2285},{2286},
                                             {2292},{2293},{2294},{2295},{2303},{2304},{2305},{2306},
                                             {2310},{2311},{2312},{2313},{2323},{2324},{2325},{2326},
                                             {2328},{2329},{2330},{2331},{2607},{2608},{2609},{2610},
                                             {2611},{2612},{2613},{2614},{2615},{2616},{2617},{2626},
                                             {2627},{2628},{2629},{2630},{2631},{2632},{2633},{2634},
                                             {2635},{2636},{2645},{2646},{2647},{2648},{2652},{2653},
                                             {2654},{2655},{2664},{2665},{2666},{2667},{2671},{2672},
                                             {2673},{2674},{2684},{2685},{2686},{2687},{2689},{2690},
                                             {2691},{2692},{2968},{2969},{2970},{2971},{2972},{2973},
                                             {2974},{2975},{2976},{2977},{2978},{2987},{2988},{2989},
                                             {2990},{2991},{2992},{2993},{2994},{2995},{2996},{2997},
                                             {3006},{3007},{3008},{3009},{3010},{3011},{3012},{3013},
                                             {3014},{3015},{3016},{3026},{3027},{3028},{3029},{3031},
                                             {3032},{3033},{3034},{3045},{3046},{3047},{3048},{3050},
                                             {3051},{3052},{3053},{3330},{3331},{3332},{3333},{3334},
                                             {3335},{3336},{3337},{3338},{3349},{3350},{3351},{3352},
                                             {3353},{3354},{3355},{3356},{3357},{3368},{3369},{3370},
                                             {3371},{3372},{3373},{3374},{3375},{3376},{3387},{3388},
                                             {3389},{3390},{3392},{3393},{3394},{3395},{3407},{3408},
                                             {3409},{3410},{3411},{3412},{3413},{3711},{3712},{3713},
                                             {3714},{3715},{3716},{3717},{3730},{3731},{3732},{3733},
                                             {3734},{3735},{3736},{3749},{3750},{3751},{3752},{3753},
                                             {3754},{3755},{3768},{3769},{3770},{3771},{3772},{3773},
                                             {3774},{4072},{4073},{4074},{4075},{4076},{4077},{4078},
                                             {4091},{4092},{4093},{4094},{4095},{4096},{4097},{4110},
                                             {4111},{4112},{4113},{4114},{4115},{4116},{4130},{4131},
                                             {4132},{4133},{4134},{4433},{4434},{4435},{4436},{4437},
                                             {4438},{4439},{4452},{4453},{4454},{4455},{4456},{4457},
                                             {4458},{4471},{4472},{4473},{4474},{4475},{4476},{4477},
                                             {4491},{4492},{4493},{4494},{4495},{4814},{4815},{4816},
                                             {4817},{4818},{4833},{4834},{4835},{4836},{4837},{4852},
                                             {4853},{4854},{4855},{4856},{5176},{5177},{5178},{5195},
                                             {5196},{5197},{5214},{5215},{5216},{5537},{5538},{5539},
                                             {5556},{5557},{5558},{5575},{5576},{5577}};

        tCore.set_candidate_search_depth(0);
        moris::BoostBitset tCandidateFlags;
        moris::real tBuffer;

        tCore.calculate_candidate_points_and_buffer_diagonal(tInsideFlags, tCandidateFlags, tBuffer);

        moris::Mat<moris::uint>  tPoints = tCore.get_points_within_triangle_bounding_box(0, tCandidateFlags, tBuffer);

        REQUIRE(tSolution.length() == tPoints.length());

        // compare flags
        moris::bool_t tCheck = true;
        for (moris::uint k=0; k< tPoints.length(); ++k){
            tCheck = tCheck && (tPoints(k) == tSolution(k));
        }
        REQUIRE(tCheck);

    }

    SECTION("ge::SDFCorreturne : SDF"){
        tCore.set_candidate_search_depth(0);
        tCore.calculate_sdf();
        auto tSDF = tCore.get_sdf();
        auto tActiveNodes = tCore.get_active_nodes();
        moris::Mat<moris::real> tSolution = {{ 0.051545656},{ 0.045077208},{ 0.045077208},{ 0.045077208},{ 0.045077208},
                    { 0.045077208},{ 0.045077208},{ 0.045077208},{ 0.045077208},{ 0.045077208},
                    { 0.045077208},{ 0.045077208},{ 0.045077208},{ 0.045077208},{ 0.051545656},
                    { 0.065647078},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.065647078},
                    { 0.097545182},{ 0.047768965},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.047768965},{ 0.097545182},
                    { 0.073678366},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.073678366},{ 0.053377559},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.053377559},{ 0.082154655},
                    { 0.042155061},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.042155061},{ 0.082154655},
                    { 0.060152943},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.060152943},{ 0.090951615},
                    { 0.044660822},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},
                    { 0.041754000},{ 0.044660822},{ 0.090951615},{ 0.067747515},{ 0.041754000},
                    { 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.067747515},
                    { 0.049134056},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.049134056},
                    { 0.075913273},{ 0.041754000},{ 0.041754000},{ 0.041754000},{ 0.075913273},
                    { 0.055096112},{ 0.041754000},{ 0.055096112},{ 0.084485780},{ 0.045078339},
                    { 0.084485780},{ 0.043862965},{ 0.027097539},{ 0.027097539},{ 0.027097539},
                    { 0.027097539},{ 0.027097539},{ 0.027097539},{ 0.027097539},{ 0.027097539},
                    { 0.027097539},{ 0.027097539},{ 0.027097539},{ 0.027097539},{ 0.027097539},
                    { 0.043862965},{ 0.058842009},{-0.002395213},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},{-0.002395213},
                    { 0.058842009},{ 0.094197271},{ 0.032960049},{-0.028277174},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.028277174},{ 0.032960049},
                    { 0.094197271},{ 0.068315310},{ 0.007078088},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{ 0.007078088},{ 0.068315310},{ 0.042433350},
                    {-0.018803873},{-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.018803873},{ 0.042433350},
                    { 0.077788611},{ 0.016551389},{-0.033246000},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.033246000},{ 0.016551389},
                    { 0.077788611},{ 0.051906651},{-0.009330572},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{-0.033246000},{-0.009330572},{ 0.051906651},
                    { 0.087261912},{ 0.026024690},{-0.033246000},{-0.033246000},{-0.033246000},
                    {-0.033246000},{-0.033246000},{ 0.026024690},{ 0.087261912},{ 0.061381837},
                    { 0.000144615},{-0.033246000},{-0.033246000},{-0.033246000},{ 0.000144615},
                    { 0.061381837},{ 0.035499876},{-0.025737346},{-0.033246000},{-0.025737346},
                    { 0.035499876},{ 0.070855138},{ 0.009617916},{-0.033246000},{ 0.009617916},
                    { 0.070855138},{ 0.044973177},{-0.016264045},{ 0.044973177},{ 0.080328439},
                    { 0.033066934},{ 0.080328439},{ 0.087136684},{ 0.052327149},{ 0.052097653},
                    { 0.052097653},{ 0.052097653},{ 0.052097653},{ 0.052097653},{ 0.052097653},
                    { 0.052097653},{ 0.052097653},{ 0.052097653},{ 0.052097653},{ 0.052097653},
                    { 0.052327149},{ 0.087136684},{ 0.084424685},{ 0.022604947},{-0.018612985},
                    {-0.018612985},{-0.018612985},{-0.018612985},{-0.018612985},{-0.018612985},
                    {-0.018612985},{-0.018612985},{-0.018612985},{-0.018612985},{-0.018612985},
                    { 0.022604947},{ 0.084424685},{ 0.119197432},{ 0.057960209},{-0.003277013},
                    {-0.064514236},{-0.089323622},{-0.089323622},{-0.089323622},{-0.089323622},
                    {-0.089323622},{-0.089323622},{-0.089323622},{-0.064514236},{-0.003277013},
                    { 0.057960209},{ 0.119197432},{ 0.093315471},{ 0.032078248},{-0.029158974},
                    {-0.090396197},{-0.090396197},{-0.029158974},{ 0.032078248},{ 0.093315471},
                    { 0.067433510},{ 0.006196288},{-0.055040935},{-0.108246000},{-0.108246000},
                    {-0.055040935},{ 0.006196288},{ 0.067433510},{ 0.102788772},{ 0.041551549},
                    {-0.019685673},{-0.080922896},{-0.080922896},{-0.019685673},{ 0.041551549},
                    { 0.102788772},{ 0.076906811},{ 0.015669589},{-0.045567634},{-0.106804857},
                    {-0.106804857},{-0.045567634},{ 0.015669589},{ 0.076906811},{ 0.112262073},
                    { 0.051024850},{-0.010212372},{-0.071449595},{-0.071449595},{-0.010212372},
                    { 0.051024850},{ 0.112262073},{ 0.086381998},{ 0.025144775},{-0.036092448},
                    {-0.097329670},{-0.036092448},{ 0.025144775},{ 0.086381998},{ 0.060500037},
                    {-0.000737186},{-0.061974408},{-0.000737186},{ 0.060500037},{ 0.095855299},
                    { 0.034618076},{-0.026619147},{ 0.034618076},{ 0.095855299},{ 0.069973338},
                    { 0.015131385},{ 0.069973338},{ 0.107038033},{ 0.076368453},{ 0.107038033},
                    { 0.086972397},{ 0.077097767},{ 0.077097767},{ 0.077097767},{ 0.077097767},
                    { 0.077097767},{ 0.077097767},{ 0.077097767},{ 0.077097767},{ 0.077097767},
                    { 0.077097767},{ 0.077097767},{ 0.086972397},{ 0.053136241},{ 0.006387130},
                    { 0.006387130},{ 0.006387130},{ 0.006387130},{ 0.006387130},{ 0.006387130},
                    { 0.006387130},{ 0.006387130},{ 0.006387130},{ 0.006387130},{ 0.006387130},
                    { 0.053136241},{ 0.082960370},{ 0.021723147},{-0.039514075},{-0.064323508},
                    {-0.064323508},{-0.064323508},{-0.064323508},{-0.064323508},{-0.064323508},
                    {-0.064323508},{-0.039514075},{ 0.021723147},{ 0.082960370},{ 0.118315632},
                    { 0.057078409},{-0.004158814},{-0.065396036},{-0.065396036},{-0.004158814},
                    { 0.057078409},{ 0.118315632},{ 0.092433671},{ 0.031196448},{-0.030040775},
                    {-0.091277997},{-0.091277997},{-0.030040775},{ 0.031196448},{ 0.092433671},
                    { 0.066551710},{ 0.005314487},{-0.055922735},{-0.117159958},{-0.117159958},
                    {-0.055922735},{ 0.005314487},{ 0.066551710},{ 0.101906972},{ 0.040669749},
                    {-0.020567474},{-0.081804696},{-0.081804696},{-0.020567474},{ 0.040669749},
                    { 0.101906972},{ 0.076025011},{ 0.014787788},{-0.046449434},{-0.107686657},
                    {-0.046449434},{ 0.014787788},{ 0.076025011},{ 0.111382158},{ 0.050144936},
                    {-0.011092287},{-0.072329510},{-0.011092287},{ 0.050144936},{ 0.111382158},
                    { 0.085500197},{ 0.024262975},{-0.036974248},{ 0.024262975},{ 0.085500197},
                    { 0.120855459},{ 0.059618237},{-0.001618986},{ 0.059618237},{ 0.120855459},
                    { 0.095075782},{ 0.058432904},{ 0.095075782},{ 0.039003775},{ 0.031387244},
                    { 0.031387244},{ 0.031387244},{ 0.031387244},{ 0.031387244},{ 0.031387244},
                    { 0.031387244},{ 0.031387244},{ 0.031387244},{ 0.039003775},{ 0.046723308},
                    {-0.014513915},{-0.039323394},{-0.039323394},{-0.039323394},{-0.039323394},
                    {-0.039323394},{-0.039323394},{-0.039323394},{-0.014513915},{ 0.046723308},
                    { 0.082078570},{ 0.020841347},{-0.040395876},{-0.101633098},{-0.101633098},
                    {-0.040395876},{ 0.020841347},{ 0.082078570},{ 0.117433831},{ 0.056196609},
                    {-0.005040614},{-0.066277837},{-0.066277837},{-0.005040614},{ 0.056196609},
                    { 0.117433831},{ 0.091551870},{ 0.030314648},{-0.030922575},{-0.092159797},
                    {-0.092159797},{-0.030922575},{ 0.030314648},{ 0.091551870},{ 0.065669910},
                    { 0.004432687},{-0.056804536},{-0.118041758},{-0.056804536},{ 0.004432687},
                    { 0.065669910},{ 0.101025171},{ 0.039787949},{-0.021449274},{-0.082686496},
                    {-0.021449274},{ 0.039787949},{ 0.101025171},{ 0.075145096},{ 0.013907874},
                    {-0.047329349},{ 0.013907874},{ 0.075145096},{ 0.110500358},{ 0.049263135},
                    {-0.011974087},{ 0.049263135},{ 0.110500358},{ 0.084618397},{ 0.040497355},
                    { 0.084618397},{ 0.126391822},{ 0.101734423},{ 0.126391822},{ 0.081258600},
                    { 0.056387358},{ 0.056387358},{ 0.056387358},{ 0.056387358},{ 0.056387358},
                    { 0.056387358},{ 0.056387358},{ 0.056387358},{ 0.056387358},{ 0.081258600},
                    { 0.072440309},{ 0.010486246},{-0.014323279},{-0.014323279},{-0.014323279},
                    {-0.014323279},{-0.014323279},{-0.014323279},{-0.014323279},{ 0.010486246},
                    { 0.072440309},{ 0.107078730},{ 0.045841507},{-0.015395715},{-0.076632938},
                    {-0.085033917},{-0.085033917},{-0.085033917},{-0.076632938},{-0.015395715},
                    { 0.045841507},{ 0.107078730},{ 0.081196769},{ 0.019959547},{-0.041277676},
                    {-0.102514899},{-0.102514899},{-0.041277676},{ 0.019959547},{ 0.081196769},
                    { 0.116552031},{ 0.055314808},{-0.005922414},{-0.067159637},{-0.067159637},
                    {-0.005922414},{ 0.055314808},{ 0.116552031},{ 0.090670070},{ 0.029432848},
                    {-0.031804375},{-0.093041598},{-0.031804375},{ 0.029432848},{ 0.090670070},
                    { 0.064788109},{ 0.003550887},{-0.057686336},{ 0.003550887},{ 0.064788109},
                    { 0.100145257},{ 0.038908034},{-0.022329188},{ 0.038908034},{ 0.100145257},
                    { 0.074263296},{ 0.022561806},{ 0.074263296},{ 0.112459998},{ 0.083798873},
                    { 0.112459998},{ 0.086370837},{ 0.081387473},{ 0.081387473},{ 0.081387473},
                    { 0.081387473},{ 0.081387473},{ 0.081387473},{ 0.081387473},{ 0.086370837},
                    { 0.042767935},{ 0.010676835},{ 0.010676835},{ 0.010676835},{ 0.010676835},
                    { 0.010676835},{ 0.010676835},{ 0.010676835},{ 0.042767935},{ 0.070841668},
                    { 0.009604445},{-0.051632777},{-0.060033803},{-0.060033803},{-0.060033803},
                    {-0.051632777},{ 0.009604445},{ 0.070841668},{ 0.106196930},{ 0.044959707},
                    {-0.016277515},{-0.077514738},{-0.077514738},{-0.016277515},{ 0.044959707},
                    { 0.106196930},{ 0.080314969},{ 0.019077746},{-0.042159476},{-0.103396699},
                    {-0.042159476},{ 0.019077746},{ 0.080314969},{ 0.115670231},{ 0.054433008},
                    {-0.006804214},{-0.068041437},{-0.006804214},{ 0.054433008},{ 0.115670231},
                    { 0.089788270},{ 0.028551047},{-0.032686175},{ 0.028551047},{ 0.089788270},
                    { 0.063908195},{ 0.004626256},{ 0.063908195},{ 0.099814716},{ 0.065863324},
                    { 0.099814716},{ 0.037583187},{ 0.035676949},{ 0.035676949},{ 0.035676949},
                    { 0.035676949},{ 0.035676949},{ 0.037583187},{ 0.034604606},{-0.026632617},
                    {-0.035033688},{-0.035033688},{-0.035033688},{-0.026632617},{ 0.034604606},
                    { 0.069959868},{ 0.008722645},{-0.052514577},{-0.105744326},{-0.052514577},
                    { 0.008722645},{ 0.069959868},{ 0.105315130},{ 0.044077907},{-0.017159316},
                    {-0.078396538},{-0.017159316},{ 0.044077907},{ 0.105315130},{ 0.079433169},
                    { 0.018195946},{-0.043041276},{ 0.018195946},{ 0.079433169},{ 0.114788431},
                    { 0.053551208},{-0.007686015},{ 0.053551208},{ 0.114788431},{ 0.088908355},
                    { 0.047927775},{ 0.088908355},{ 0.076856914},{ 0.060677064},{ 0.060677064},
                    { 0.060677064},{ 0.060677064},{ 0.060677064},{ 0.076856914},{ 0.060510626},
                    {-0.001632456},{-0.010033574},{-0.010033574},{-0.010033574},{-0.001632456},
                    { 0.060510626},{ 0.094960028},{ 0.033722806},{-0.027514417},{-0.080744212},
                    {-0.027514417},{ 0.033722806},{ 0.094960028},{ 0.069078068},{ 0.007840845},
                    {-0.053396378},{ 0.007840845},{ 0.069078068},{ 0.104433329},{ 0.043196107},
                    {-0.018041116},{ 0.043196107},{ 0.104433329},{ 0.078551369},{ 0.029988960},
                    { 0.078551369},{ 0.118100737},{ 0.091229294},{ 0.118100737},{ 0.118957817},
                    { 0.087459803},{ 0.085675844},{ 0.085675844},{ 0.085675844},{ 0.087459803},
                    { 0.118957817},{ 0.096197713},{ 0.033592347},{ 0.014965207},{ 0.014965207},
                    { 0.014965207},{ 0.033592347},{ 0.096197713},{ 0.119958856},{ 0.058721633},
                    {-0.002515590},{-0.055745431},{-0.002515590},{ 0.058721633},{ 0.119958856},
                    { 0.094076895},{ 0.032839672},{-0.028397550},{ 0.032839672},{ 0.094076895},
                    { 0.068194934},{ 0.012051101},{ 0.068194934},{ 0.104862556},{ 0.073288169},
                    { 0.104862556},{ 0.076670290},{ 0.039968184},{ 0.039965321},{ 0.039968184},
                    { 0.076670290},{ 0.083721794},{ 0.022484571},{-0.030745317},{ 0.022484571},
                    { 0.083721794},{ 0.119077055},{ 0.057839833},{-0.003397390},{ 0.057839833},
                    { 0.119077055},{ 0.093214337},{ 0.055352620},{ 0.093214337},{ 0.074192780},
                    { 0.064965435},{ 0.074192780},{ 0.048674152},{-0.005745202},{ 0.048674152},
                    { 0.082839993},{ 0.037417071},{ 0.082839993},{ 0.123925942},{ 0.098654139},
                    { 0.123925942},{ 0.114724491},{ 0.090826322},{ 0.114724491},{ 0.085875835},
                    { 0.042132182},{ 0.085875835},{ 0.110183895},{ 0.080718590},{ 0.110183895}};

        moris::real tError = 0;
        for (moris::uint k=0; k< tActiveNodes.length(); ++k){
            tError += std::pow(tSolution(k)-tSDF(tActiveNodes(k)),2);
        }

        REQUIRE(std::sqrt(tError) < 1e-4);
    }
} */
